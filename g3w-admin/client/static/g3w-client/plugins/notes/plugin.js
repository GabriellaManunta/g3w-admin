!function e(t,i,n){function o(r,a){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){var i=t[r][1][e];return o(i?i:e)},d,d.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t,e,i){function n(t){s(this,t),this._formPanel=l}var o=g3wsdk.core.utils.inherit,s=g3wsdk.core.utils.base,r=g3wsdk.gui.FormPanel,a=g3wsdk.gui.Form,l=r.extend({});o(n,a),e.exports=n},{}],2:[function(t,e,i){function n(t){s(this,t),this._saveFromEditForm=!0,this._saveEdits=_.bind(a.saveEdits,a)}var o=g3wsdk.core.utils.inherit,s=g3wsdk.core.utils.base,r=g3wsdk.core.Editor,a=t("../pluginservice");t("./attributesform");o(n,r),e.exports=n},{"../pluginservice":7,"./attributesform":1}],3:[function(t,e,i){var n=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,s=g3wsdk.core.Plugin,r=g3wsdk.gui.GUI,a=g3wsdk.core.ProjectsRegistry,l=t("pluginconfig"),c=t("./pluginservice"),d=t("./panel"),u=function(){o(this),this.name="notes",this.config=null,this.service=null,this.init=function(){this.setPluginService(c),this.config=this.getPluginConfig(),this.setUpIconUrl(this.config.layers),this.registerPlugin(this.config.gid)&&(r.ready?this.setupGui():r.on("ready",_.bind(this.setupGui,this)),l.customUrlParameters=this.createPluginCustomUrlParameters(),this.service.init(this.config,l))},this.setupGui=function(){var t=r.getComponent("tools"),e=t.getService(),i=l.tools(this);e.addTools(1,"GEONOTES",i)},this.toolsActions={showHideLayer:function(){console.log("showHideLayer")},showEditingPanel:function(){var t=new d;this.service.toggleEditing(),r.showPanel(t)}},this.createPluginCustomUrlParameters=function(){var t="&",e=a.getCurrentProject();return t+="project_type="+e.getType()+"&project_id="+e.getId()},this.setUpIconUrl=function(t){_.forEach(t,function(t){l.layers[t.name].iconurl=t.iconurl})},this.setupToolsAction=function(t){_.forEach(t,function(t){})}};n(u,s),function(t){t.init()}(new u)},{"./panel":5,"./pluginservice":7,pluginconfig:6}],4:[function(t,e,i){e.exports='<div class="g3w-iternet-editing-panel">\n  <template v-for="toolbar in editorstoolbars">\n    <div class="panel panel-primary">\n      <div class="panel-heading">\n        <h3 class="panel-title">{{ toolbar.name }}</h3>\n      </div>\n      <div class="panel-body">\n        <template v-for="tool in toolbar.tools">\n          <div class="editbtn" :class="{\'enabled\' : (state.editing.on && editingtoolbtnEnabled(tool)), \'toggled\' : editingtoolbtnToggled(toolbar.layercode, tool.tooltype)}">\n            <img height="30px" width="30px" @click="toggleEditTool(toolbar.layercode, tool.tooltype)" :alt.once="tool.title" :title.once="tool.title" :src.once="resourcesurl+\'images/\'+tool.icon"></img>\n          </div>\n        </template>\n      </div>\n    </div>\n  </template>\n  <div>\n    <!--<button class="btn btn-primary" v-disabled="editingbtnEnabled" :class="{\'btn-success\' : state.editingOn}" @click="toggleEditing">{{ editingbtnlabel }}</button>-->\n    <!--<button class="btn btn-danger" v-disabled="!state.hasEdits" @click="saveEdits">{{ savebtnlabel }}</button>-->\n    <span>Caricamento Dati ... </span><img v-show="state.retrievingData" :src="resourcesurl +\'images/loader.svg\'">\n  </div>\n  <div class="message">\n    {{{ message }}}\n  </div>\n</div>\n'},{}],5:[function(t,e,i){function n(){this.id="iternet-editing-panel",this.name="Gestione dati ITERNET",this.internalPanel=new c}var o=g3wsdk.core.utils.resolve,s=g3wsdk.core.utils.inherit,r=g3wsdk.gui.GUI,a=g3wsdk.gui.Panel,l=t("./pluginservice"),c=Vue.extend({template:t("./panel.html"),data:function(){return{state:l.state,resourcesurl:r.getResourcesUrl(),editorstoolbars:[{name:"Geonotes",layercode:l.layerCodes.GEONOTES,tools:[{title:"Aggiungi Geonota",tooltype:"addfeature",icon:"iternetAddPoint.png"},{title:"Sposta Geonota",tooltype:"movefeature",icon:"iternetMovePoint.png"},{title:"Rimuovi Geonota",tooltype:"deletefeature",icon:"iternetDeletePoint.png"},{title:"Edita geonota",tooltype:"editattributes",icon:"editAttributes.png"}]}],savebtnlabel:"Salva"}},methods:{toggleEditing:function(){l.toggleEditing()},saveEdits:function(){l.saveEdits()},toggleEditTool:function(t,e){""!=e&&this.state.editing.on&&l.toggleEditTool(t,e)},editingtoolbtnToggled:function(t,e){return this.state.editing.layerCode==t&&this.state.editing.toolType==e},editingtoolbtnEnabled:function(t){return""!=t.tooltype}},computed:{editingbtnlabel:function(){return this.state.editing.on?"Termina editing":"Avvia editing"},editingbtnEnabled:function(){return this.state.editing.enabled||this.state.editing.on?"":"disabled"},message:function(){var t="";if(this.state.editing.enabled){if(this.state.editing.toolstep.message){var e=this.state.editing.toolstep.n,i=this.state.editing.toolstep.total,n=this.state.editing.toolstep.message;t='<div style="margin-top:20px">GUIDA STRUMENTO:</div><div><span>['+e+"/"+i+'] </span><span style="color: yellow">'+n+"</span></div>"}}else t='<span style="color: red">Aumentare il livello di zoom per abilitare l\'editing';return t}}});s(n,a);var d=a.prototype;d.onShow=function(t){var e=this.internalPanel;return e.$mount().$appendTo(t),o(!0)},d.onClose=function(){var t=this,e=$.Deferred();return l.stop().then(function(){t.internalPanel.$destroy(!0),t.internalPanel=null,e.resolve()}).fail(function(){e.reject()}),e.promise()},e.exports=n},{"./panel.html":4,"./pluginservice":7}],6:[function(t,e,i){function n(t){return n=[{name:"Visualizza Geonotes",type:"checkbox",action:_.bind(t.toolsActions.showHideLayer,t)},{name:"Strumenti Geonotes",action:_.bind(t.toolsActions.showEditingPanel,t)}]}var o=t("./editors/geonoteseditor"),s=this.layerCodes={GEONOTES:"note"},r={};r[s.GEONOTES]=o;var a={};a[s.GEONOTES]={layerCode:s.GEONOTES,vector:null,editor:null,iconurl:null,style:function(t){var e,i=this.iconurl;return e=i?new ol.style.Style({image:new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:.75,src:i})}):new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:color})})}),[e]}},e.exports={layersCode:s,layers:a,editorClass:r,tools:n}},{"./editors/geonoteseditor":2}],7:[function(e,i,n){function o(){var e=this;this._mapService=null,this._loadDataOnMapViewChangeListener=null,this._currentEditingLayer=null,this._loadedExtent=null,this.state={editing:{on:!1,enabled:!1,layerCode:null,toolType:null,startingEditingTool:!1,toolstep:{n:null,total:null,message:null}},retrievingData:!1,hasEdits:!1},this._loader=new l;var i={resolution:1};this.init=function(t,e){var n=this;this.config=t,this._layers=e.layers,this._editorClass=e.editorClass,this.layerCodes=e.layersCode,this._customUrlParameters=e.customUrlParameters||null,this._mapService=a.getComponent("map").getService();var o={layers:this._layers,baseurl:this.config.baseurl,mapService:this._mapService};this._loader.init(o),this._loader.on("loadingvectorlayersstart",function(){n.state.retrievingData=!0}),this._loader.on("loadingvectorlayersend",function(){n.state.retrievingData=!1}),this._mapService.on("pointerInteractionSet",function(t){var e=n._getCurrentEditingLayer();if(e){var i=e.editor.getActiveTool().instance;i&&!i.ownsInteraction(t)&&n._stopEditingTool()}}),this._mapService.onafter("setMapView",function(t,e,o){n.state.editing.enabled=e<i.resolution}),this.state.editing.enabled=this._mapService.getResolution()<i.resolution,_.forEach(this._layers,function(e,i){var o=t.layers[i].id,s=t.layers[i].name,r=n._mapService.getProject().getLayerById(o);r?(e.name=r.getOrigName(),e.id=o):(e.name=s,e.id=o)})},this.stop=function(){var t=$.Deferred();return this.state.editing.on?this._cancelOrSave().then(function(){e._stopEditing(),t.resolve()}).fail(function(){t.reject()}):t.resolve(),t.promise()},this.toggleEditing=function(){var t=$.Deferred();if(this.state.editing.enabled&&!this.state.editing.on)this._startEditing();else if(this.state.editing.on)return this.stop();return t.promise()},this.saveEdits=function(){this._cancelOrSave(2)},this.toggleEditTool=function(t,e){var i=this,n=this._layers[t];if(n){var o=this._getCurrentEditingLayer();o&&t==o.layerCode?e==o.editor.getActiveTool().getType()?this._stopEditingTool():(this._stopEditingTool(),this._startEditingTool(o,e)):o&&o.editor.isStarted()?this._cancelOrSave(2).then(function(){i._stopEditor()&&i._startEditingTool(n,e)}):this._startEditingTool(n,e)}},this.getLayerCodes=function(){return _.values(this.layerCodes)},this._setUpVectorLayer=function(t,e){this._layers[t].vector=e},this._setUpEditor=function(t){var e=this,i={mapService:e._mapService,formClass:c},n=this._layers[t].vector,o=new e._editorClass[t](i);o.setVectorLayer(n),o.on("dirty",function(t){e.state.hasEdits=t}),this._layers[t].editor=o},this._startEditing=function(){if(!this.state.editing.on&&!this.state.retrievingData){var e=this;this._loader.loadLayers("w",this._customUrlParameters).then(function(t){console.log(t),_.forEach(t,function(t){e._setUpEditor(t)}),e._addToMap(),e.state.editing.on=!0,e.emit("editingstarted"),e._loadDataOnMapViewChangeListener||(e._loadDataOnMapViewChangeListener=e._mapService.onafter("setMapView",function(){e.state.editing.on&&e.state.editing.enabled&&e._loader.loadAllVectorsData()}))}).fail(function(){a.notify.error(t("could_not_load_vector_layers"))})}},this._stopEditing=function(t){this._stopEditor(t)&&(_.forEach(this._layers,function(t,i){var n=t.vector;e._mapService.viewer.removeLayerByName(n.name),t.vector=null,t.editor=null,e._unlockLayer(e._layers[i])}),this._updateEditingState(),e.state.editing.on=!1,e._cleanUp(),e.emit("editingstopped"))},this._cleanUp=function(){this._loader.cleanUpLayers()},this._startEditor=function(t){return!!t.editor.start(this)&&(this._setCurrentEditingLayer(t),!0)},this._startEditingTool=function(t,e,i){this.state.startingEditingTool=!0;var n=!0;return t.editor.isStarted()||(n=this._startEditor(t)),n&&t.editor.setTool(e,i)?(this._updateEditingState(),this.state.startingEditingTool=!1,!0):(this.state.startingEditingTool=!1,!1)},this._stopEditor=function(t){var e=!0,i=this._getCurrentEditingLayer();return i&&(e=i.editor.stop(t),e&&this._setCurrentEditingLayer()),e},this._stopEditingTool=function(){var t=!0,e=this._getCurrentEditingLayer();return e&&(t=e.editor.stopTool(),t&&this._updateEditingState()),t},this._cancelOrSave=function(t){var e=$.Deferred();try{var i=1;t&&(i=t);var n=this,o={};_.forEach(this._layers,function(t,e){t.editor.isDirty()&&(o[e]=t.editor)}),_.keys(o).length?this._askCancelOrSave(i).then(function(t){"save"===t?n._saveEdits(o).then(function(t){e.resolve()}).fail(function(t){e.reject()}):"nosave"==t?e.resolve():"cancel"==t&&e.reject()}):e.resolve()}catch(s){e.reject()}return e.promise()},this._askCancelOrSave=function(t){var e=$.Deferred(),i={SAVE:{label:"Salva",className:"btn-success",callback:function(){e.resolve("save")}},NOSAVE:{label:"Termina senza salvare",className:"btn-danger",callback:function(){e.resolve("nosave")}},CANCEL:{label:"Annulla",className:"btn-primary",callback:function(){e.resolve("cancel")}}};switch(t){case 1:buttons={save:i.SAVE,nosave:i.NOSAVE,cancel:i.CANCEL};break;case 2:buttons={save:i.SAVE,cancel:i.CANCEL}}return a.dialog.dialog({message:"Vuoi salvare definitivamente le modifiche?",title:"Salvataggio modifica",buttons:buttons}),e.promise()},this._saveEdits=function(t){var i=$.Deferred();return this._sendEdits(t).then(function(n){a.notify.success("I dati sono stati salvati correttamente"),e._commitEdits(t,n),e._mapService.refreshMap(),i.resolve()}).fail(function(t){a.notify.error("Errore nel salvataggio sul server"),i.resolve()}),i.promise()},this._sendEdits=function(t){var e=$.Deferred(),i=_.map(t,function(t){return{layername:t.getVectorLayer().name,edits:t.getEditedFeatures()}});return this._postData(i).then(function(t){t.result?e.resolve(t.response):e.reject(t.response)}).fail(function(t){e.reject(t.response)}),e.promise()},this._commitEdits=function(t,e){_.forEach(t,function(t){e&&e["new"]&&_.forEach(e["new"],function(i){var n=i.clientid,o=i.id;t.getEditVectorLayer().setFeatureData(n,o,null,i),_.forEach(e.new_lockids,function(e){t.getVectorLayer().addLockId(e)})}),t.commit()})},this._undoEdits=function(t){var e=this._getCurrentEditingLayer().layerCode;t[e];this._stopEditing(!0)},this._updateEditingState=function(){var t=this._getCurrentEditingLayer();t?(this.state.editing.layerCode=t.layerCode,this.state.editing.toolType=t.editor.getActiveTool().getType()):(this.state.editing.layerCode=null,this.state.editing.toolType=null),this._updateToolStepsState()},this._updateToolStepsState=function(){var t,e=this,i=this._getCurrentEditingLayer();if(i&&(t=i.editor.getActiveTool()),t&&t.getTool()){var n=t.getTool();n.steps&&(this._setToolStepState(t),n.steps.on("step",function(i,n){e._setToolStepState(t)}),n.steps.on("complete",function(){e._setToolStepState()}))}else e._setToolStepState()},this._setToolStepState=function(t){var e,i,n;if(_.isUndefined(t))e=null,i=null,n=null;else{var o=t.getTool(),s=toolStepsMessages[t.getType()];e=o.steps.currentStepIndex(),i=o.steps.totalSteps(),n=s[e],_.isUndefined(n)&&(e=null,i=null,n=null)}this.state.editing.toolstep.n=e+1,this.state.editing.toolstep.total=i,this.state.editing.toolstep.message=n},this._getCurrentEditingLayer=function(){return this._currentEditingLayer},this._setCurrentEditingLayer=function(t){t?this._currentEditingLayer=t:this._currentEditingLayer=null},this._addToMap=function(){var t=this._mapService.viewer.map,i=this.getLayerCodes();_.forEach(i,function(i){e._layers[i].vector.addToMap(t)})},this._postData=function(t){if(t.length>1)return this._postBatchData(t);var e=t[0].layername,i=t[0].edits,n=JSON.stringify(i);return $.post({url:this.config.baseurl+e+"/",data:n,contentType:"application/json"})},this._postBatchData=function(t){var e={};_.forEach(t,function(t){e[t.layername]=t.edits});var i=JSON.stringify(e);return $.post({url:this.config.baseurl,data:i,contentType:"application/json"})},this._unlock=function(){var t=this.getLayerCodes();_.map(t,function(t){return e._unlockLayer(e._layers[t])})},this._unlockLayer=function(t){$.get(this.config.baseurl+t.name+"/?unlock")},this.getLoader=function(){return this._loader}}var s=g3wsdk.core.utils.inherit,r=g3wsdk.core.G3WObject,a=g3wsdk.gui.GUI,l=g3wsdk.core.VectorLayerLoader,c=e("./editors/attributesform");s(o,r),i.exports=new o},{"./editors/attributesform":1}]},{},[3]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1aWxkLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIkdlb25vdGVGb3JtIiwib3B0aW9ucyIsImJhc2UiLCJ0aGlzIiwiX2Zvcm1QYW5lbCIsIkdlb25vdGVGb3JtUGFuZWwiLCJpbmhlcml0IiwiZzN3c2RrIiwiY29yZSIsInV0aWxzIiwiRm9ybVBhbmVsIiwiZ3VpIiwiRm9ybSIsImV4dGVuZCIsIjIiLCJHZW9ub3Rlc0VkaXRvciIsIl9zYXZlRnJvbUVkaXRGb3JtIiwiX3NhdmVFZGl0cyIsIl8iLCJiaW5kIiwiUGx1Z2luU2VydmljZSIsInNhdmVFZGl0cyIsIkVkaXRvciIsIi4uL3BsdWdpbnNlcnZpY2UiLCIuL2F0dHJpYnV0ZXNmb3JtIiwiMyIsIlBsdWdpbiIsIkdVSSIsIlByb2plY3RzUmVnaXN0cnkiLCJwbHVnaW5Db25maWciLCJTZXJ2aWNlIiwiRWRpdGluZ1BhbmVsIiwiX1BsdWdpbiIsIm5hbWUiLCJjb25maWciLCJzZXJ2aWNlIiwiaW5pdCIsInNldFBsdWdpblNlcnZpY2UiLCJnZXRQbHVnaW5Db25maWciLCJzZXRVcEljb25VcmwiLCJsYXllcnMiLCJyZWdpc3RlclBsdWdpbiIsImdpZCIsInJlYWR5Iiwic2V0dXBHdWkiLCJvbiIsImN1c3RvbVVybFBhcmFtZXRlcnMiLCJjcmVhdGVQbHVnaW5DdXN0b21VcmxQYXJhbWV0ZXJzIiwidG9vbHNDb21wb25lbnQiLCJnZXRDb21wb25lbnQiLCJ0b29sc1NlcnZpY2UiLCJnZXRTZXJ2aWNlIiwidG9vbHMiLCJhZGRUb29scyIsInRvb2xzQWN0aW9ucyIsInNob3dIaWRlTGF5ZXIiLCJjb25zb2xlIiwibG9nIiwic2hvd0VkaXRpbmdQYW5lbCIsInBhbmVsIiwidG9nZ2xlRWRpdGluZyIsInNob3dQYW5lbCIsImN1cnJlbnRQcm9qZWN0IiwiZ2V0Q3VycmVudFByb2plY3QiLCJnZXRUeXBlIiwiZ2V0SWQiLCJsYXllcnNDb25maWciLCJmb3JFYWNoIiwibGF5ZXJDb25maWciLCJpY29udXJsIiwic2V0dXBUb29sc0FjdGlvbiIsInRvb2wiLCJwbHVnaW4iLCIuL3BhbmVsIiwiLi9wbHVnaW5zZXJ2aWNlIiwicGx1Z2luY29uZmlnIiwiNCIsIjUiLCJFZGl0b3JQYW5lbCIsImlkIiwiaW50ZXJuYWxQYW5lbCIsIlBhbmVsQ29tcG9uZW50IiwicmVzb2x2ZWRWYWx1ZSIsInJlc29sdmUiLCJQYW5lbCIsIlZ1ZSIsInRlbXBsYXRlIiwiZGF0YSIsInN0YXRlIiwicmVzb3VyY2VzdXJsIiwiZ2V0UmVzb3VyY2VzVXJsIiwiZWRpdG9yc3Rvb2xiYXJzIiwibGF5ZXJjb2RlIiwibGF5ZXJDb2RlcyIsIkdFT05PVEVTIiwidGl0bGUiLCJ0b29sdHlwZSIsImljb24iLCJzYXZlYnRubGFiZWwiLCJtZXRob2RzIiwidG9nZ2xlRWRpdFRvb2wiLCJsYXllckNvZGUiLCJ0b29sVHlwZSIsImVkaXRpbmciLCJlZGl0aW5ndG9vbGJ0blRvZ2dsZWQiLCJlZGl0aW5ndG9vbGJ0bkVuYWJsZWQiLCJjb21wdXRlZCIsImVkaXRpbmdidG5sYWJlbCIsImVkaXRpbmdidG5FbmFibGVkIiwiZW5hYmxlZCIsIm1lc3NhZ2UiLCJ0b29sc3RlcCIsInRvdGFsIiwic3RlcG1lc3NhZ2UiLCJwcm90byIsInByb3RvdHlwZSIsIm9uU2hvdyIsImNvbnRhaW5lciIsIiRtb3VudCIsIiRhcHBlbmRUbyIsIm9uQ2xvc2UiLCJzZWxmIiwiZGVmZXJyZWQiLCIkIiwiRGVmZXJyZWQiLCJzdG9wIiwidGhlbiIsIiRkZXN0cm95IiwiZmFpbCIsInJlamVjdCIsInByb21pc2UiLCIuL3BhbmVsLmh0bWwiLCI2IiwidHlwZSIsImFjdGlvbiIsImVkaXRvckNsYXNzIiwidmVjdG9yIiwiZWRpdG9yIiwic3R5bGUiLCJmZWF0dXJlIiwiZmVhdHVyZVN0eWxlIiwib2wiLCJTdHlsZSIsImltYWdlIiwiSWNvbiIsImFuY2hvciIsImFuY2hvclhVbml0cyIsImFuY2hvcllVbml0cyIsIm9wYWNpdHkiLCJzcmMiLCJDaXJjbGUiLCJyYWRpdXMiLCJmaWxsIiwiRmlsbCIsImNvbG9yIiwibGF5ZXJzQ29kZSIsIi4vZWRpdG9ycy9nZW9ub3Rlc2VkaXRvciIsIjciLCJHZW9ub3Rlc1NlcnZpY2UiLCJfbWFwU2VydmljZSIsIl9sb2FkRGF0YU9uTWFwVmlld0NoYW5nZUxpc3RlbmVyIiwiX2N1cnJlbnRFZGl0aW5nTGF5ZXIiLCJfbG9hZGVkRXh0ZW50Iiwic3RhcnRpbmdFZGl0aW5nVG9vbCIsInJldHJpZXZpbmdEYXRhIiwiaGFzRWRpdHMiLCJfbG9hZGVyIiwiVmVjdG9yTG9hZGVyTGF5ZXIiLCJlZGl0aW5nQ29uc3RyYWludHMiLCJyZXNvbHV0aW9uIiwiX2xheWVycyIsIl9lZGl0b3JDbGFzcyIsIl9jdXN0b21VcmxQYXJhbWV0ZXJzIiwib3B0aW9uc19sb2FkZXIiLCJiYXNldXJsIiwibWFwU2VydmljZSIsImludGVyYWN0aW9uIiwiY3VycmVudEVkaXRpbmdMYXllciIsIl9nZXRDdXJyZW50RWRpdGluZ0xheWVyIiwiYWN0aXZlVG9vbCIsImdldEFjdGl2ZVRvb2wiLCJpbnN0YW5jZSIsIm93bnNJbnRlcmFjdGlvbiIsIl9zdG9wRWRpdGluZ1Rvb2wiLCJvbmFmdGVyIiwiYmJveCIsImNlbnRlciIsImdldFJlc29sdXRpb24iLCJMYXllciIsImxheWVySWQiLCJsYXllck5hbWUiLCJsYXllciIsImdldFByb2plY3QiLCJnZXRMYXllckJ5SWQiLCJnZXRPcmlnTmFtZSIsIl9jYW5jZWxPclNhdmUiLCJfc3RvcEVkaXRpbmciLCJfc3RhcnRFZGl0aW5nIiwiX3N0YXJ0RWRpdGluZ1Rvb2wiLCJpc1N0YXJ0ZWQiLCJfc3RvcEVkaXRvciIsImdldExheWVyQ29kZXMiLCJ2YWx1ZXMiLCJfc2V0VXBWZWN0b3JMYXllciIsInZlY3RvckxheWVyIiwiX3NldFVwRWRpdG9yIiwib3B0aW9uc19lZGl0b3IiLCJmb3JtQ2xhc3MiLCJGb3JtQ2xhc3MiLCJzZXRWZWN0b3JMYXllciIsImRpcnR5IiwibG9hZExheWVycyIsInZlY3RvckxheWVyc0xvYWRlZCIsIl9hZGRUb01hcCIsImVtaXQiLCJsb2FkQWxsVmVjdG9yc0RhdGEiLCJub3RpZnkiLCJlcnJvciIsInJlc2V0Iiwidmlld2VyIiwicmVtb3ZlTGF5ZXJCeU5hbWUiLCJfdW5sb2NrTGF5ZXIiLCJfdXBkYXRlRWRpdGluZ1N0YXRlIiwiX2NsZWFuVXAiLCJjbGVhblVwTGF5ZXJzIiwiX3N0YXJ0RWRpdG9yIiwic3RhcnQiLCJfc2V0Q3VycmVudEVkaXRpbmdMYXllciIsImNhblN0YXJ0VG9vbCIsInNldFRvb2wiLCJyZXQiLCJzdG9wVG9vbCIsIl9hc2tUeXBlIiwiZGlydHlFZGl0b3JzIiwiaXNEaXJ0eSIsImtleXMiLCJfYXNrQ2FuY2VsT3JTYXZlIiwicmVzdWx0IiwiYnV0dG9uVHlwZXMiLCJTQVZFIiwibGFiZWwiLCJjbGFzc05hbWUiLCJjYWxsYmFjayIsIk5PU0FWRSIsIkNBTkNFTCIsImJ1dHRvbnMiLCJzYXZlIiwibm9zYXZlIiwiY2FuY2VsIiwiZGlhbG9nIiwiX3NlbmRFZGl0cyIsInJlc3BvbnNlIiwic3VjY2VzcyIsIl9jb21taXRFZGl0cyIsInJlZnJlc2hNYXAiLCJlcnJvcnMiLCJlZGl0c1RvUHVzaCIsIm1hcCIsImxheWVybmFtZSIsImdldFZlY3RvckxheWVyIiwiZWRpdHMiLCJnZXRFZGl0ZWRGZWF0dXJlcyIsIl9wb3N0RGF0YSIsInJldHVybmVkIiwiZWRpdG9ycyIsInVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcyIsIm9sZGZpZCIsImNsaWVudGlkIiwiZmlkIiwiZ2V0RWRpdFZlY3RvckxheWVyIiwic2V0RmVhdHVyZURhdGEiLCJuZXdfbG9ja2lkcyIsIm5ld2xvY2tJZCIsImFkZExvY2tJZCIsImNvbW1pdCIsIl91bmRvRWRpdHMiLCJjdXJyZW50RWRpdGluZ0xheWVyQ29kZSIsIl91cGRhdGVUb29sU3RlcHNTdGF0ZSIsImdldFRvb2wiLCJ0b29sSW5zdGFuY2UiLCJzdGVwcyIsIl9zZXRUb29sU3RlcFN0YXRlIiwiaW5kZXgiLCJzdGVwIiwiaXNVbmRlZmluZWQiLCJtZXNzYWdlcyIsInRvb2xTdGVwc01lc3NhZ2VzIiwiY3VycmVudFN0ZXBJbmRleCIsInRvdGFsU3RlcHMiLCJhZGRUb01hcCIsIl9wb3N0QmF0Y2hEYXRhIiwianNvbkRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwicG9zdCIsInVybCIsImNvbnRlbnRUeXBlIiwibXVsdGlFZGl0c1RvUHVzaCIsIl91bmxvY2siLCJnZXQiLCJnZXRMb2FkZXIiLCJHM1dPYmplY3QiLCJWZWN0b3JMYXllckxvYWRlciIsIi4vZWRpdG9ycy9hdHRyaWJ1dGVzZm9ybSJdLCJtYXBwaW5ncyI6IkNBQUEsUUFBVUEsR0FBRUMsRUFBRUMsRUFBRUMsR0FBRyxRQUFTQyxHQUFFQyxFQUFFQyxHQUFHLElBQUlKLEVBQUVHLEdBQUcsQ0FBQyxJQUFJSixFQUFFSSxHQUFHLENBQUMsR0FBSUUsR0FBa0Isa0JBQVRDLFVBQXFCQSxPQUFRLEtBQUlGLEdBQUdDLEVBQUUsTUFBT0EsR0FBRUYsR0FBRSxFQUFJLElBQUdJLEVBQUUsTUFBT0EsR0FBRUosR0FBRSxFQUFJLElBQUlLLEdBQUUsR0FBSUMsT0FBTSx1QkFBdUJOLEVBQUUsSUFBSyxNQUFNSyxHQUFFRSxLQUFLLG1CQUFtQkYsRUFBRSxHQUFJRyxHQUFFWCxFQUFFRyxJQUFJUyxXQUFZYixHQUFFSSxHQUFHLEdBQUdVLEtBQUtGLEVBQUVDLFFBQVEsU0FBU2QsR0FBRyxHQUFJRSxHQUFFRCxFQUFFSSxHQUFHLEdBQUdMLEVBQUcsT0FBT0ksR0FBRUYsRUFBRUEsRUFBRUYsSUFBSWEsRUFBRUEsRUFBRUMsUUFBUWQsRUFBRUMsRUFBRUMsRUFBRUMsR0FBRyxNQUFPRCxHQUFFRyxHQUFHUyxRQUFrRCxJQUFJLEdBQTFDTCxHQUFrQixrQkFBVEQsVUFBcUJBLFFBQWdCSCxFQUFFLEVBQUVBLEVBQUVG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anMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgRm9ybVBhbmVsID0gZzN3c2RrLmd1aS5Gb3JtUGFuZWw7XG52YXIgRm9ybSA9IGczd3Nkay5ndWkuRm9ybTtcblxudmFyIEdlb25vdGVGb3JtUGFuZWwgPSBGb3JtUGFuZWwuZXh0ZW5kKHtcbiAgLy90ZW1wbGF0ZTogcmVxdWlyZSgnLi9hdHRyaWJ1dGVzZm9ybS5odG1sJylcbn0pO1xuXG5mdW5jdGlvbiBHZW9ub3RlRm9ybShvcHRpb25zKXtcbiAgYmFzZSh0aGlzLG9wdGlvbnMpO1xuICB0aGlzLl9mb3JtUGFuZWwgPSBHZW9ub3RlRm9ybVBhbmVsO1xufVxuaW5oZXJpdChHZW9ub3RlRm9ybSxGb3JtKTtcblxubW9kdWxlLmV4cG9ydHMgPSBHZW9ub3RlRm9ybTtcblxufSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgRWRpdG9yID0gZzN3c2RrLmNvcmUuRWRpdG9yO1xudmFyIFBsdWdpblNlcnZpY2UgPSByZXF1aXJlKCcuLi9wbHVnaW5zZXJ2aWNlJyk7XG52YXIgRm9ybSA9IHJlcXVpcmUoJy4vYXR0cmlidXRlc2Zvcm0nKTtcbnZhciBmb3JtID0gbnVsbDsgLy8gYnJ1dHRvIG1hIGRldm8gdGVuZXJsbyBlc3Rlcm5vIHNlbm7DsiBzaSBjcmVhIHVuIGNsaWNvIGRpIHJpZmVyaW1lbnRpIGNoZSBtYW5kYSBpbiBwYWxsYSBWdWVcblxuXG5mdW5jdGlvbiBHZW9ub3Rlc0VkaXRvcihvcHRpb25zKSB7XG5cbiAgLy8gaW4gcXVlc3RvIG1vZG8gcGFzc2lhbW8gaWwgbWFwc2VydmljZSBjb21lIGFyZ29tZW50byBhbCBzdXBlcmNsYXNzIChlZGl0b3IpXG4gIC8vIGRpIGl0ZXJuZXRlZGl0b3IgaW4gbW9kbyBkYSBhc3NlZ25hcmFlIGFuY2hlIGEgaXRlcm5ldGVkaXRvciBpbCBtYXBzZXJ2ZWljZSBjaGUgeHNlcnZpcsOgIGFkIGVzZW1waW8gYWQgYWdnaXVuZ2VyZVxuICAvLyBsJ2ludGVyYWN0aW9uIGFsbGEgbWFwcGEgcXVhbmRvIHZpZW5lIGNsaWNjYXRvIHN1IHVuIHRvb2xcblxuICBiYXNlKHRoaXMsIG9wdGlvbnMpO1xuICB0aGlzLl9zYXZlRnJvbUVkaXRGb3JtID0gdHJ1ZTtcbiAgdGhpcy5fc2F2ZUVkaXRzID0gXy5iaW5kKFBsdWdpblNlcnZpY2Uuc2F2ZUVkaXRzLCBQbHVnaW5TZXJ2aWNlKTtcbiAgLy8gYXByZSBmb3JtIGF0dHJpYnV0aSBwZXIgaW5zZXJpbWVudG9cbn1cblxuaW5oZXJpdChHZW9ub3Rlc0VkaXRvciwgRWRpdG9yKTtcblxubW9kdWxlLmV4cG9ydHMgPSBHZW9ub3Rlc0VkaXRvcjtcbn0se1wiLi4vcGx1Z2luc2VydmljZVwiOjcsXCIuL2F0dHJpYnV0ZXNmb3JtXCI6MX1dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuLy8gU0RLIC8vL1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIFBsdWdpbiA9IGczd3Nkay5jb3JlLlBsdWdpbjtcbnZhciBHVUkgPSBnM3dzZGsuZ3VpLkdVSTtcbnZhciBQcm9qZWN0c1JlZ2lzdHJ5ID0gZzN3c2RrLmNvcmUuUHJvamVjdHNSZWdpc3RyeTtcbi8vLyBQTFVHSU4gLy9cbnZhciBwbHVnaW5Db25maWcgPSByZXF1aXJlKCdwbHVnaW5jb25maWcnKTtcbnZhciBTZXJ2aWNlID0gcmVxdWlyZSgnLi9wbHVnaW5zZXJ2aWNlJyk7XG52YXIgRWRpdGluZ1BhbmVsID0gcmVxdWlyZSgnLi9wYW5lbCcpO1xuXG52YXIgX1BsdWdpbiA9IGZ1bmN0aW9uKCkge1xuXG4gIGJhc2UodGhpcyk7XG4gIHRoaXMubmFtZSA9ICdub3Rlcyc7XG4gIHRoaXMuY29uZmlnID0gbnVsbDtcbiAgdGhpcy5zZXJ2aWNlID0gbnVsbDtcbiAgdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIC8vc2V0dG8gaWwgc2Vydml6aW9cbiAgICB0aGlzLnNldFBsdWdpblNlcnZpY2UoU2VydmljZSk7XG4gICAgLy9yZWN1cGVybyBjb25maWd1cmF6aW9uZSBkZWwgcGx1Z2luXG4gICAgdGhpcy5jb25maWcgPSB0aGlzLmdldFBsdWdpbkNvbmZpZygpO1xuICAgIHRoaXMuc2V0VXBJY29uVXJsKHRoaXMuY29uZmlnLmxheWVycyk7XG4gICAgLy9yZWdpdHJvIGlsIHBsdWdpblxuICAgIGlmICh0aGlzLnJlZ2lzdGVyUGx1Z2luKHRoaXMuY29uZmlnLmdpZCkpIHtcbiAgICAgIGlmICghR1VJLnJlYWR5KSB7XG4gICAgICAgIEdVSS5vbigncmVhZHknLCBfLmJpbmQodGhpcy5zZXR1cEd1aSwgdGhpcykpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0dXBHdWkoKTtcbiAgICAgIH1cbiAgICAgIC8vaW5pemlhbGl6em8gaWwgc2Vydml6aW8uIElsIHNlcnZpemlvIMOoIGwnaXN0YW56YSBkZWxsYSBjbGFzc2Ugc2Vydml6aW9cbiAgICAgIHBsdWdpbkNvbmZpZy5jdXN0b21VcmxQYXJhbWV0ZXJzID0gdGhpcy5jcmVhdGVQbHVnaW5DdXN0b21VcmxQYXJhbWV0ZXJzKCk7XG4gICAgICB0aGlzLnNlcnZpY2UuaW5pdCh0aGlzLmNvbmZpZywgcGx1Z2luQ29uZmlnKTtcbiAgICB9XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSB1bmEgdm9sdGEgY2hlIGxhIEdVSSBoYSBlbWVzc28gbCdldmVudG8gJ3JlYWR5J1xuICAvLyBzZXJ2ZSBhIG1vbnRhcmUgaSBjb21wb2VudGkgZGVsIHBsdWdpbiBzdWxsYSBzaWRlYmFyXG4gIHRoaXMuc2V0dXBHdWkgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdG9vbHNDb21wb25lbnQgPSBHVUkuZ2V0Q29tcG9uZW50KCd0b29scycpO1xuICAgIHZhciB0b29sc1NlcnZpY2UgPSB0b29sc0NvbXBvbmVudC5nZXRTZXJ2aWNlKCk7XG4gICAgdmFyIHRvb2xzID0gcGx1Z2luQ29uZmlnLnRvb2xzKHRoaXMpO1xuICAgIHRvb2xzU2VydmljZS5hZGRUb29scygxICwnR0VPTk9URVMnLCB0b29scylcbiAgfTtcbiAgLy8gYXppb25pIGNoZSBzb25vIGxlZ2F0aSBhaSB0b29sc1xuICB0aGlzLnRvb2xzQWN0aW9ucyA9IHtcbiAgICBzaG93SGlkZUxheWVyOiAgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zb2xlLmxvZygnc2hvd0hpZGVMYXllcicpO1xuICAgIH0sXG4gICAgc2hvd0VkaXRpbmdQYW5lbDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGFuZWwgPSBuZXcgRWRpdGluZ1BhbmVsKCk7XG4gICAgICB0aGlzLnNlcnZpY2UudG9nZ2xlRWRpdGluZygpO1xuICAgICAgR1VJLnNob3dQYW5lbChwYW5lbCk7XG4gICAgfVxuICB9O1xuXG4gIC8vc2V0dXBQbHVnaW5DdXN0b21QYXJhbWV0ZXJzXG4gIHRoaXMuY3JlYXRlUGx1Z2luQ3VzdG9tVXJsUGFyYW1ldGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjdXN0b21VcmxQYXJhbWV0ZXJzPScmJztcbiAgICB2YXIgY3VycmVudFByb2plY3QgPSBQcm9qZWN0c1JlZ2lzdHJ5LmdldEN1cnJlbnRQcm9qZWN0KCk7XG4gICAgY3VzdG9tVXJsUGFyYW1ldGVycys9J3Byb2plY3RfdHlwZT0nK2N1cnJlbnRQcm9qZWN0LmdldFR5cGUoKSsnJnByb2plY3RfaWQ9JytjdXJyZW50UHJvamVjdC5nZXRJZCgpO1xuICAgIHJldHVybiBjdXN0b21VcmxQYXJhbWV0ZXJzXG4gIH07XG4gIC8vIHNldHVwIGljb25VcmwgZm9yIExheWVyXG4gIHRoaXMuc2V0VXBJY29uVXJsID0gZnVuY3Rpb24obGF5ZXJzQ29uZmlnKSB7XG4gICAgXy5mb3JFYWNoKGxheWVyc0NvbmZpZywgZnVuY3Rpb24obGF5ZXJDb25maWcpIHtcbiAgICAgIHBsdWdpbkNvbmZpZy5sYXllcnNbbGF5ZXJDb25maWcubmFtZV0uaWNvbnVybCA9IGxheWVyQ29uZmlnLmljb251cmw7XG4gICAgfSlcbiAgfTtcblxuICB0aGlzLnNldHVwVG9vbHNBY3Rpb24gPSBmdW5jdGlvbih0b29scykge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBfLmZvckVhY2godG9vbHMsIGZ1bmN0aW9uKHRvb2wpe1xuICAgICAgLy9UT0RPXG4gICAgfSlcbiAgfVxufTtcblxuaW5oZXJpdChfUGx1Z2luLCBQbHVnaW4pO1xuXG4oZnVuY3Rpb24ocGx1Z2luKXtcbiAgcGx1Z2luLmluaXQoKTtcbn0pKG5ldyBfUGx1Z2luKTtcblxuXG5cblxufSx7XCIuL3BhbmVsXCI6NSxcIi4vcGx1Z2luc2VydmljZVwiOjcsXCJwbHVnaW5jb25maWdcIjo2fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5tb2R1bGUuZXhwb3J0cyA9IFwiPGRpdiBjbGFzcz1cXFwiZzN3LWl0ZXJuZXQtZWRpdGluZy1wYW5lbFxcXCI+XFxuICA8dGVtcGxhdGUgdi1mb3I9XFxcInRvb2xiYXIgaW4gZWRpdG9yc3Rvb2xiYXJzXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwicGFuZWwgcGFuZWwtcHJpbWFyeVxcXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwicGFuZWwtaGVhZGluZ1xcXCI+XFxuICAgICAgICA8aDMgY2xhc3M9XFxcInBhbmVsLXRpdGxlXFxcIj57eyB0b29sYmFyLm5hbWUgfX08L2gzPlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInBhbmVsLWJvZHlcXFwiPlxcbiAgICAgICAgPHRlbXBsYXRlIHYtZm9yPVxcXCJ0b29sIGluIHRvb2xiYXIudG9vbHNcXFwiPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJlZGl0YnRuXFxcIiA6Y2xhc3M9XFxcInsnZW5hYmxlZCcgOiAoc3RhdGUuZWRpdGluZy5vbiAmJiBlZGl0aW5ndG9vbGJ0bkVuYWJsZWQodG9vbCkpLCAndG9nZ2xlZCcgOiBlZGl0aW5ndG9vbGJ0blRvZ2dsZWQodG9vbGJhci5sYXllcmNvZGUsIHRvb2wudG9vbHR5cGUpfVxcXCI+XFxuICAgICAgICAgICAgPGltZyBoZWlnaHQ9XFxcIjMwcHhcXFwiIHdpZHRoPVxcXCIzMHB4XFxcIiBAY2xpY2s9XFxcInRvZ2dsZUVkaXRUb29sKHRvb2xiYXIubGF5ZXJjb2RlLCB0b29sLnRvb2x0eXBlKVxcXCIgOmFsdC5vbmNlPVxcXCJ0b29sLnRpdGxlXFxcIiA6dGl0bGUub25jZT1cXFwidG9vbC50aXRsZVxcXCIgOnNyYy5vbmNlPVxcXCJyZXNvdXJjZXN1cmwrJ2ltYWdlcy8nK3Rvb2wuaWNvblxcXCI+PC9pbWc+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC90ZW1wbGF0ZT5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICA8L3RlbXBsYXRlPlxcbiAgPGRpdj5cXG4gICAgPCEtLTxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tcHJpbWFyeVxcXCIgdi1kaXNhYmxlZD1cXFwiZWRpdGluZ2J0bkVuYWJsZWRcXFwiIDpjbGFzcz1cXFwieydidG4tc3VjY2VzcycgOiBzdGF0ZS5lZGl0aW5nT259XFxcIiBAY2xpY2s9XFxcInRvZ2dsZUVkaXRpbmdcXFwiPnt7IGVkaXRpbmdidG5sYWJlbCB9fTwvYnV0dG9uPi0tPlxcbiAgICA8IS0tPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kYW5nZXJcXFwiIHYtZGlzYWJsZWQ9XFxcIiFzdGF0ZS5oYXNFZGl0c1xcXCIgQGNsaWNrPVxcXCJzYXZlRWRpdHNcXFwiPnt7IHNhdmVidG5sYWJlbCB9fTwvYnV0dG9uPi0tPlxcbiAgICA8c3Bhbj5DYXJpY2FtZW50byBEYXRpIC4uLiA8L3NwYW4+PGltZyB2LXNob3c9XFxcInN0YXRlLnJldHJpZXZpbmdEYXRhXFxcIiA6c3JjPVxcXCJyZXNvdXJjZXN1cmwgKydpbWFnZXMvbG9hZGVyLnN2ZydcXFwiPlxcbiAgPC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJtZXNzYWdlXFxcIj5cXG4gICAge3t7IG1lc3NhZ2UgfX19XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG5cIjtcblxufSx7fV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgcmVzb2x2ZWRWYWx1ZSA9IGczd3Nkay5jb3JlLnV0aWxzLnJlc29sdmU7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgR1VJID0gZzN3c2RrLmd1aS5HVUk7XG4vLyBiYXNlIGNsYXNzIFBhbmVsXG52YXIgUGFuZWwgPSAgZzN3c2RrLmd1aS5QYW5lbDtcbnZhciBTZXJ2aWNlID0gcmVxdWlyZSgnLi9wbHVnaW5zZXJ2aWNlJyk7XG5cbnZhciBQYW5lbENvbXBvbmVudCA9IFZ1ZS5leHRlbmQoe1xuICB0ZW1wbGF0ZTogcmVxdWlyZSgnLi9wYW5lbC5odG1sJyksXG4gIGRhdGE6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0ZTogU2VydmljZS5zdGF0ZSxcbiAgICAgIHJlc291cmNlc3VybDogR1VJLmdldFJlc291cmNlc1VybCgpLFxuICAgICAgZWRpdG9yc3Rvb2xiYXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiBcIkdlb25vdGVzXCIsXG4gICAgICAgICAgbGF5ZXJjb2RlOiBTZXJ2aWNlLmxheWVyQ29kZXMuR0VPTk9URVMsXG4gICAgICAgICAgdG9vbHM6W1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJBZ2dpdW5naSBHZW9ub3RhXCIsXG4gICAgICAgICAgICAgIC8vIHRvb2x0eXBlIMOoIGwnYXR0cmlidXRvIGNoZSBzZXJ2ZXIgcGVyIHNjZWdsaWVyZSBpbCB0aXBvIGRpIHRvb2xcbiAgICAgICAgICAgICAgLy8gZGVsbCdlZGl0b3IgZ2VuZXJhbGUgY2hlIGRvdnLDoCBlc3NlcmUgaW1wb3N0YXRvXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnYWRkZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0QWRkUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiU3Bvc3RhIEdlb25vdGFcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdtb3ZlZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0TW92ZVBvaW50LnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIlJpbXVvdmkgR2Vvbm90YVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2RlbGV0ZWZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldERlbGV0ZVBvaW50LnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkVkaXRhIGdlb25vdGFcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdlZGl0YXR0cmlidXRlcycsXG4gICAgICAgICAgICAgIGljb246ICdlZGl0QXR0cmlidXRlcy5wbmcnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgc2F2ZWJ0bmxhYmVsOiBcIlNhbHZhXCJcbiAgICB9XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICAvL21ldG9kbyBjaGlhbWF0byBxdWFuZG8gc2kgY2xpY2NhIHN1IGF2dmlhL3Rlcm1pbmEgZWRpdGluZ1xuICAgIHRvZ2dsZUVkaXRpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgU2VydmljZS50b2dnbGVFZGl0aW5nKCk7XG4gICAgfSxcbiAgICBzYXZlRWRpdHM6IGZ1bmN0aW9uKCl7XG4gICAgICBTZXJ2aWNlLnNhdmVFZGl0cygpO1xuICAgIH0sXG4gICAgLy8gY2hhaW1hdG8gcXVhbmRvIHNpIGNsaWNjYSBzdWwgdW4gdG9vbCBkZWxsJ2VkaXRvclxuICAgIC8vIGNvbWUgYWQgZXNlbXBpbyAgYWRkIG1vdmUgZWRpdCBhdHRyaWJ1dGVzIGV0YyAuLlxuICAgIHRvZ2dsZUVkaXRUb29sOiBmdW5jdGlvbihsYXllckNvZGUsIHRvb2xUeXBlKSB7XG4gICAgICBpZiAodG9vbFR5cGUgPT0gJycpe1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvL3ZlcmlmaWNhIHNlIGwnZWRpdG9yIMOoIGluIGVkaXRpbmcgb24gdHJ1ZVxuICAgICAgaWYgKHRoaXMuc3RhdGUuZWRpdGluZy5vbikge1xuICAgICAgICBTZXJ2aWNlLnRvZ2dsZUVkaXRUb29sKGxheWVyQ29kZSwgdG9vbFR5cGUpO1xuICAgICAgfVxuICAgIH0sXG4gICAgLy8gbWV0b2RvIGNoZSB2aWVuZSBjaGlhbWF0byBwZXIgdmVyaWZpY2FyZSBlIHNldHRhcmVcbiAgICAvLyBsYSBjbGFzc2UgKHByZW11dG8gbyBubyBkZWwgYm90dG9uZSB0b29sIGluIHF1ZXN0aW9uZSlcbiAgICBlZGl0aW5ndG9vbGJ0blRvZ2dsZWQ6IGZ1bmN0aW9uKGxheWVyQ29kZSwgdG9vbFR5cGUpIHtcbiAgICAgIHJldHVybiAodGhpcy5zdGF0ZS5lZGl0aW5nLmxheWVyQ29kZSA9PSBsYXllckNvZGUgJiYgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xUeXBlID09IHRvb2xUeXBlKTtcbiAgICB9LFxuICAgIC8vIGZ1bnppb25lIGNoZSB2ZXJpZmljYSBzZSBhYmlsaXRhcmUgbyBtZW5vIGkgYm90dG9uaSBkZWkgdG9vbHNcbiAgICBlZGl0aW5ndG9vbGJ0bkVuYWJsZWQ6IGZ1bmN0aW9uKHRvb2wpe1xuICAgICAgcmV0dXJuIHRvb2wudG9vbHR5cGUgIT0gJyc7XG4gICAgfVxuICB9LFxuICBjb21wdXRlZDoge1xuICAgIGVkaXRpbmdidG5sYWJlbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdGF0ZS5lZGl0aW5nLm9uID8gXCJUZXJtaW5hIGVkaXRpbmdcIiA6IFwiQXZ2aWEgZWRpdGluZ1wiO1xuICAgIH0sXG4gICAgZWRpdGluZ2J0bkVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICh0aGlzLnN0YXRlLmVkaXRpbmcuZW5hYmxlZCB8fCB0aGlzLnN0YXRlLmVkaXRpbmcub24pID8gXCJcIiA6IFwiZGlzYWJsZWRcIjtcbiAgICB9LFxuICAgIG1lc3NhZ2U6IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XG4gICAgICBpZiAoIXRoaXMuc3RhdGUuZWRpdGluZy5lbmFibGVkKXtcbiAgICAgICAgbWVzc2FnZSA9ICc8c3BhbiBzdHlsZT1cImNvbG9yOiByZWRcIj5BdW1lbnRhcmUgaWwgbGl2ZWxsbyBkaSB6b29tIHBlciBhYmlsaXRhcmUgbFxcJ2VkaXRpbmcnO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm1lc3NhZ2Upe1xuICAgICAgICB2YXIgbiA9IHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5uO1xuICAgICAgICB2YXIgdG90YWwgPSB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAudG90YWw7XG4gICAgICAgIHZhciBzdGVwbWVzc2FnZSA9IHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5tZXNzYWdlO1xuICAgICAgICBtZXNzYWdlID0gJzxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOjIwcHhcIj5HVUlEQSBTVFJVTUVOVE86PC9kaXY+JyArXG4gICAgICAgICAgJzxkaXY+PHNwYW4+WycrbisnLycrdG90YWwrJ10gPC9zcGFuPjxzcGFuIHN0eWxlPVwiY29sb3I6IHllbGxvd1wiPicrc3RlcG1lc3NhZ2UrJzwvc3Bhbj48L2Rpdj4nO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuICB9XG59KTtcblxuZnVuY3Rpb24gRWRpdG9yUGFuZWwoKSB7XG4gIC8vIHByb3ByaWV0w6AgbmVjZXNzYXJpZS4gSW4gZnV0dXJvIGxlIG1ldHRlcm1vIGluIHVuYVxuICAvLyBjbGFzc2UgUGFuZWwgZGEgY3VpIGRlcml2ZXJhbm5vIHR1dHRpIGkgcGFubmVsbGkgY2hlIHZvZ2xpb25vIGVzc2VyZSBtb3N0cmF0aSBuZWxsYSBzaWRlYmFyXG4gIHRoaXMuaWQgPSBcIml0ZXJuZXQtZWRpdGluZy1wYW5lbFwiO1xuICB0aGlzLm5hbWUgPSBcIkdlc3Rpb25lIGRhdGkgSVRFUk5FVFwiO1xuICB0aGlzLmludGVybmFsUGFuZWwgPSBuZXcgUGFuZWxDb21wb25lbnQoKTtcbn1cblxuaW5oZXJpdChFZGl0b3JQYW5lbCwgUGFuZWwpO1xuXG52YXIgcHJvdG8gPSBQYW5lbC5wcm90b3R5cGU7XG5cbi8vIHZpZW5lIHJpY2hpYW1hdG8gZGFsbGEgdG9vbGJhclxuLy8gcXVhbmRvIGlsIHBsdWdpbiBjaGllZGUgZGkgbW9zdHJhcmUgdW4gcHJvcHJpbyBwYW5uZWxsbyBuZWxsYSBHVUkgKEdVSS5zaG93UGFuZWwpXG5wcm90by5vblNob3cgPSBmdW5jdGlvbihjb250YWluZXIpe1xuICB2YXIgcGFuZWwgPSB0aGlzLmludGVybmFsUGFuZWw7XG4gIHBhbmVsLiRtb3VudCgpLiRhcHBlbmRUbyhjb250YWluZXIpO1xuICByZXR1cm4gcmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbn07XG5cbi8vIHJpY2hpYW1hdG8gcXVhbmRvIGxhIEdVSSBjaGllZGUgZGkgY2hpdWRlcmUgaWwgcGFubmVsbG8uIFNlIHJpdG9ybmEgZmFsc2UgaWwgcGFubmVsbG8gbm9uIHZpZW5lIGNoaXVzb1xucHJvdG8ub25DbG9zZSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICBTZXJ2aWNlLnN0b3AoKVxuICAudGhlbihmdW5jdGlvbigpe1xuICAgIHNlbGYuaW50ZXJuYWxQYW5lbC4kZGVzdHJveSh0cnVlKTtcbiAgICBzZWxmLmludGVybmFsUGFuZWwgPSBudWxsO1xuICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgfSlcbiAgLmZhaWwoZnVuY3Rpb24oKXtcbiAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgfSk7XG4gIFxuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBFZGl0b3JQYW5lbDtcblxufSx7XCIuL3BhbmVsLmh0bWxcIjo0LFwiLi9wbHVnaW5zZXJ2aWNlXCI6N31dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuLy9RdWkgY2kgc29ubyBnbGkgZWRpdG9yIChjbGFzc2kpIHVzYXRpIGRhaSB2YXJpIGxheWVyXG52YXIgR2Vvbm90ZXNFZGl0b3IgPSByZXF1aXJlKCcuL2VkaXRvcnMvZ2Vvbm90ZXNlZGl0b3InKTtcblxuLy9kZWZpbmlzY28gaSBjb2RpY2kgbGF5ZXJcbnZhciBsYXllckNvZGVzID0gdGhpcy5sYXllckNvZGVzID0ge1xuICAgIEdFT05PVEVTOiAnbm90ZSdcbn07XG4vLyBjbGFzc2kgZWRpdG9yXG52YXIgZWRpdG9yQ2xhc3MgPSB7fTtcbmVkaXRvckNsYXNzW2xheWVyQ29kZXMuR0VPTk9URVNdID0gR2Vvbm90ZXNFZGl0b3I7XG5cbi8vZGZpbmlzY28gbGF5ZXIgZGVsIHBsdWdpbiBjb21lIG9nZ2V0dG9cbnZhciBsYXllcnMgPSB7fTtcbmxheWVyc1tsYXllckNvZGVzLkdFT05PVEVTXSA9IHtcbiAgICBsYXllckNvZGU6IGxheWVyQ29kZXMuR0VPTk9URVMsXG4gICAgdmVjdG9yOiBudWxsLFxuICAgIGVkaXRvcjogbnVsbCxcbiAgICBpY29udXJsOiBudWxsLFxuICAgIC8vZGVmaW5pc2NvIGxvIHN0aWxlXG4gICAgc3R5bGU6IGZ1bmN0aW9uKGZlYXR1cmUpIHtcbiAgICAgICAgdmFyIGZlYXR1cmVTdHlsZTtcbiAgICAgICAgdmFyIGljb251cmwgPSB0aGlzLmljb251cmw7XG4gICAgICAgIGlmIChpY29udXJsKSB7XG4gICAgICAgICAgZmVhdHVyZVN0eWxlID0gbmV3IG9sLnN0eWxlLlN0eWxlKHtcbiAgICAgICAgICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuSWNvbih7XG4gICAgICAgICAgICAgIGFuY2hvcjogWzAuNSwgNDZdLFxuICAgICAgICAgICAgICBhbmNob3JYVW5pdHM6ICdmcmFjdGlvbicsXG4gICAgICAgICAgICAgIGFuY2hvcllVbml0czogJ3BpeGVscycsIG9wYWNpdHk6IDAuNzUsXG4gICAgICAgICAgICAgIHNyYzogaWNvbnVybFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZlYXR1cmVTdHlsZSA9IG5ldyBvbC5zdHlsZS5TdHlsZSh7XG4gICAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XG4gICAgICAgICAgICAgIHJhZGl1czogNSxcbiAgICAgICAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xuICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvclxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBmZWF0dXJlU3R5bGVcbiAgICAgICAgXVxuICAgIH1cbn07XG5cbi8vIGRlZmluaXNjbyBpIHRvb2xzXG5mdW5jdGlvbiB0b29scyhwbHVnaW4pIHtcblxuICAgIHJldHVybiB0b29scyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJWaXN1YWxpenphIEdlb25vdGVzXCIsXG4gICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLFxuICAgICAgICAgICAgYWN0aW9uOiBfLmJpbmQocGx1Z2luLnRvb2xzQWN0aW9ucy5zaG93SGlkZUxheWVyLCBwbHVnaW4pXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiU3RydW1lbnRpIEdlb25vdGVzXCIsXG4gICAgICAgICAgICBhY3Rpb246IF8uYmluZChwbHVnaW4udG9vbHNBY3Rpb25zLnNob3dFZGl0aW5nUGFuZWwsIHBsdWdpbilcbiAgICAgICAgfVxuICAgIF07XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGxheWVyc0NvZGU6IGxheWVyQ29kZXMsXG4gICAgbGF5ZXJzOiBsYXllcnMsXG4gICAgZWRpdG9yQ2xhc3M6IGVkaXRvckNsYXNzLFxuICAgIHRvb2xzOiB0b29sc1xufTtcblxufSx7XCIuL2VkaXRvcnMvZ2Vvbm90ZXNlZGl0b3JcIjoyfV0sNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgRzNXT2JqZWN0ID0gZzN3c2RrLmNvcmUuRzNXT2JqZWN0O1xudmFyIEdVSSA9IGczd3Nkay5ndWkuR1VJO1xudmFyIFZlY3RvckxvYWRlckxheWVyID0gZzN3c2RrLmNvcmUuVmVjdG9yTGF5ZXJMb2FkZXI7XG52YXIgRm9ybUNsYXNzID0gcmVxdWlyZSgnLi9lZGl0b3JzL2F0dHJpYnV0ZXNmb3JtJyk7XG5cbmZ1bmN0aW9uIEdlb25vdGVzU2VydmljZSgpIHtcblxuICB2YXIgc2VsZiA9IHRoaXM7XG4gIC8vcXVpIHZhZG8gIGEgc2V0dGFyZSBpbCBtYXBzZXJ2aWNlXG4gIHRoaXMuX21hcFNlcnZpY2UgPSBudWxsO1xuICB0aGlzLl9sb2FkRGF0YU9uTWFwVmlld0NoYW5nZUxpc3RlbmVyID0gbnVsbDtcbiAgdGhpcy5fY3VycmVudEVkaXRpbmdMYXllciA9IG51bGw7XG4gIHRoaXMuX2xvYWRlZEV4dGVudCA9IG51bGw7XG5cbiAgdGhpcy5zdGF0ZSA9IHtcbiAgICBlZGl0aW5nOiB7XG4gICAgICBvbjogZmFsc2UsXG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIGxheWVyQ29kZTogbnVsbCxcbiAgICAgIHRvb2xUeXBlOiBudWxsLFxuICAgICAgc3RhcnRpbmdFZGl0aW5nVG9vbDogZmFsc2UsXG4gICAgICB0b29sc3RlcDoge1xuICAgICAgICBuOiBudWxsLFxuICAgICAgICB0b3RhbDogbnVsbCxcbiAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgfVxuICAgIH0sXG4gICAgcmV0cmlldmluZ0RhdGE6IGZhbHNlLFxuICAgIGhhc0VkaXRzOiBmYWxzZVxuICB9O1xuXG4gIC8vZGVmaW5pc2NvIGlsIGxvYWRlciBkZWwgcGx1Z2luXG4gIHRoaXMuX2xvYWRlciA9IG5ldyBWZWN0b3JMb2FkZXJMYXllcjtcbiAgLy8gdmluY29saSBhbGxhIHBvc3NpYmlsaXTDoCAgZGkgYXR0aXZhcmUgbCdlZGl0aW5nXG4gIHZhciBlZGl0aW5nQ29uc3RyYWludHMgPSB7XG4gICAgcmVzb2x1dGlvbjogMSAvLyB2aW5jb2xvIGRpIHJpc29sdXppb25lIG1hc3NpbWFcbiAgfTtcbiAgLy8gaW5pemlhbGl6emF6aW9uZSBkZWwgcGx1Z2luXG4gIC8vIGNoaWFtdG8gZGFsbCAkc2NyaXB0KHVybCkgZGVsIHBsdWdpbiByZWdpc3RyeVxuICB0aGlzLmluaXQgPSBmdW5jdGlvbihjb25maWcsIHBsdWdpbkNvbmZpZykge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2xheWVycyA9IHBsdWdpbkNvbmZpZy5sYXllcnM7XG4gICAgdGhpcy5fZWRpdG9yQ2xhc3MgPSBwbHVnaW5Db25maWcuZWRpdG9yQ2xhc3M7XG4gICAgdGhpcy5sYXllckNvZGVzID0gcGx1Z2luQ29uZmlnLmxheWVyc0NvZGU7XG4gICAgdGhpcy5fY3VzdG9tVXJsUGFyYW1ldGVycyA9IHBsdWdpbkNvbmZpZy5jdXN0b21VcmxQYXJhbWV0ZXJzIHx8IG51bGw7XG4gICAgLy8gc2V0dG8gaWwgbWFwc2VydmljZSBjaGUgbWkgcGVybWV0dGUgZGkgaW5lcmFnaXJlIGNvbiBsYSBtYXBwYVxuICAgIHRoaXMuX21hcFNlcnZpY2UgPSBHVUkuZ2V0Q29tcG9uZW50KCdtYXAnKS5nZXRTZXJ2aWNlKCk7XG4gICAgLy9pbml6aWFsaXp6byBpbCBsb2FkZXJcbiAgICAvLyBwYXNzYW5kb2dsaTpcbiAgICAvLyAxIC0gbGF5ZXJzIGRlbCBwbHVnaW4gKHN0eWxlIGV0Yy4uKVxuICAgIC8vIDIgLSBsYSBiYXNldXJsIGNoZSBtaSBzZXJ2ZXIgcGVyIGludGVyYWdpcmUgY29uIGlsIHNlcnZlciBwZXIgZmFyZSB0dXR0ZSBsZSBtb2RpZmljaGVcbiAgICB2YXIgb3B0aW9uc19sb2FkZXIgPSB7XG4gICAgICAnbGF5ZXJzJzogdGhpcy5fbGF5ZXJzLFxuICAgICAgJ2Jhc2V1cmwnOiB0aGlzLmNvbmZpZy5iYXNldXJsLFxuICAgICAgJ21hcFNlcnZpY2UnOiB0aGlzLl9tYXBTZXJ2aWNlXG4gICAgfTtcbiAgICAvL2luaXppYWxpenpvIGlsIGxvYWRlclxuICAgIHRoaXMuX2xvYWRlci5pbml0KG9wdGlvbnNfbG9hZGVyKTtcbiAgICAvL2Nhc28gZGkgbG9hZGluZyBkYXRhXG4gICAgdGhpcy5fbG9hZGVyLm9uKCdsb2FkaW5ndmVjdG9ybGF5ZXJzc3RhcnQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuc3RhdGUucmV0cmlldmluZ0RhdGEgPSB0cnVlO1xuICAgIH0pO1xuICAgIHRoaXMuX2xvYWRlci5vbignbG9hZGluZ3ZlY3RvcmxheWVyc2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5zdGF0ZS5yZXRyaWV2aW5nRGF0YSA9IGZhbHNlO1xuICAgIH0pO1xuXG4gICAgLy8gZGlzYWJpbGl0byBsJ2V2ZW50dWFsZSB0b29sIGF0dGl2byBzZSB2aWVuZSBhdHRpdmF0YVxuICAgIC8vIHVuJ2ludGVyYXppb25lIGRpIHRpcG8gcG9pbnRlckludGVyYWN0aW9uU2V0IHN1bGxhIG1hcHBhXG4gICAgdGhpcy5fbWFwU2VydmljZS5vbigncG9pbnRlckludGVyYWN0aW9uU2V0JywgZnVuY3Rpb24oaW50ZXJhY3Rpb24pIHtcbiAgICAgIHZhciBjdXJyZW50RWRpdGluZ0xheWVyID0gc2VsZi5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIpIHtcbiAgICAgICAgdmFyIGFjdGl2ZVRvb2wgPSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuaW5zdGFuY2U7XG4gICAgICAgIC8vIGRldm8gdmVyaWZpY2FyZSBjaGUgbm9uIHNpYSB1bidpbnRlcmF6aW9uZSBhdHRpdmF0YSBkYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyBkZWwgcGx1Z2luXG4gICAgICAgIGlmIChhY3RpdmVUb29sICYmICFhY3RpdmVUb29sLm93bnNJbnRlcmFjdGlvbihpbnRlcmFjdGlvbikpIHtcbiAgICAgICAgICBzZWxmLl9zdG9wRWRpdGluZ1Rvb2woKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIC8vICBhYmlsaXRvIG8gbWVubyBsJ2VkaXRpbmcgaW4gYmFzZSBhbGxhIHJpc29sdXppb25lIGRlbGxhIG1hcHBhXG4gICAgdGhpcy5fbWFwU2VydmljZS5vbmFmdGVyKCdzZXRNYXBWaWV3JyxmdW5jdGlvbihiYm94LCByZXNvbHV0aW9uLCBjZW50ZXIpe1xuICAgICAgc2VsZi5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgPSAocmVzb2x1dGlvbiA8IGVkaXRpbmdDb25zdHJhaW50cy5yZXNvbHV0aW9uKSA/IHRydWUgOiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBhdHRyaWJ1dG8gZGVsbG8gc3RhdG8gZGVsIHNyZXZpemlvIGNoZSBtaSBwZXJtZXR0ZSBkaSBhY2NlbmRlcmUgbyBzcGVuZ2VyZSBsJ2VkaXRpbmdcbiAgICAvLyBzZXJ2ZSBhbmNoZSBwZXIgcG90ZXIgaW4gZmFzZSBkaSB0b2dnbGVFZGl0aW5nKGJvdHRvbmUgZGkgYXZ2aW8gZWRpdGluZykgZGkgdmVkZXJlIHNlIHBvc3NvIGluemlhcmUgbyBtZW5vXG4gICAgLy8gY2FyaWNhcmUgaSB2ZXR0b3JpYWxpIGV0Yy4uXG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgPSAodGhpcy5fbWFwU2VydmljZS5nZXRSZXNvbHV0aW9uKCkgPCBlZGl0aW5nQ29uc3RyYWludHMucmVzb2x1dGlvbikgPyB0cnVlIDogZmFsc2U7XG4gICAgLy8gcGVyIG9nbmkgbGF5ZXIgZGVmaW5pdGkgbmVsIHBsdWdpbiBzZXR0byBuYW1lIGUgaWRcbiAgICAvLyByZWN1cGVyYXRpIGdyYXppZSBhbCBtYXBzZXJ2aWNlXG4gICAgXy5mb3JFYWNoKHRoaXMuX2xheWVycywgZnVuY3Rpb24oTGF5ZXIsIGxheWVyQ29kZSkge1xuICAgICAgLy9yZWN1cGVybyBsJ2lkIGRhbGxhIGNvbmZpZ3VyYXppb25lIGRlbCBwbHVnaW5cbiAgICAgIC8vIGkgbGF5ZXJzIG5lbGxhIGNvbmZpZ3VyYXppb25lIHBhc3NhdGEgaSBsYXllcnMgaGFubm8gZHVlIGF0dHJpYnV0aTogaWQgZSBuYW1lXG4gICAgICB2YXIgbGF5ZXJJZCA9IGNvbmZpZy5sYXllcnNbbGF5ZXJDb2RlXS5pZDtcbiAgICAgIHZhciBsYXllck5hbWUgPSBjb25maWcubGF5ZXJzW2xheWVyQ29kZV0ubmFtZTtcbiAgICAgIC8vIHJlY3VwZXJhIGlsIGxheWVyIGRhbCBtYXBzZXJ2aWNlXG4gICAgICB2YXIgbGF5ZXIgPSBzZWxmLl9tYXBTZXJ2aWNlLmdldFByb2plY3QoKS5nZXRMYXllckJ5SWQobGF5ZXJJZCk7XG4gICAgICAvLyBtZXNzbyBhbCBtb21lbnRvIGdlbmVyaWNvIHBlciByaXByZW5kZXJlIHN0ZXNzbyBjb25tcG9ydGFtZW50byBJdGVybmV0XG4gICAgICBpZiAobGF5ZXIpIHtcbiAgICAgICAgLy8gcmVjdXBlcm8gbCdvcmlnaW4gbmFtZSBkYWwgcHJvamVjdGxheWVyXG4gICAgICAgIExheWVyLm5hbWUgPSBsYXllci5nZXRPcmlnTmFtZSgpO1xuICAgICAgICBMYXllci5pZCA9IGxheWVySWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBMYXllci5uYW1lID0gbGF5ZXJOYW1lO1xuICAgICAgICBMYXllci5pZCA9IGxheWVySWQ7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIC8vIGZpbmUgZGVsIG1ldG9kbyBJTklUXG5cbiAgLy9zdG9wXG4gIHRoaXMuc3RvcCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcub24pIHtcbiAgICAgIHRoaXMuX2NhbmNlbE9yU2F2ZSgpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuX3N0b3BFZGl0aW5nKCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbigpe1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgfSlcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG5cbiAgLy8gYXZ2aW8gbyB0ZXJtaW5vIGxhIHNlc3Npb25lIGRpIGVkaXRpbmcgZ2VuZXJhbGVcbiAgLy8gdW50byBkaSBwYXJ0ZW56YSBkZWxsJ2F2dmlvIGRlbGwnZWRpdGluZ1xuICB0aGlzLnRvZ2dsZUVkaXRpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBjcmVvIG9nZ2V0dG8gZGVmZXJyZWQgcGVyIHJlc3RpdHVpcmUgdW5hIHByb21pc2VcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgLy8gcXVpIGRpY2UgY2hlIHNlIG5lbCBjYXNvIGxhIHJpc29sdXppb25lIGRlbGxhIG1hcHBhIHZhIGJlbmUgKHN0YXRlLmVkaXRpbmcuZW5hYmxlZClcbiAgICAvLyBlIG5vbiDDqCBhbmNvcmEgc3RhdG8gYXR0aXZhdG8gbCdlZGl0aW5nXG4gICAgLy8gcXVpbmRpIGNhc28gcHJpbWEgdm9sdGFcbiAgICBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgJiYgIXRoaXMuc3RhdGUuZWRpdGluZy5vbikge1xuICAgICAgLy8gZmFjY2lvIHBhcnRpcmUgZWRpdGluZ1xuICAgICAgdGhpcy5fc3RhcnRFZGl0aW5nKCk7XG4gICAgfVxuICAgIC8vIGFsdHJpbWVudGkgc2Ugw6ggZ2nDoCBpbiBlZGl0aW5nIGNoaWFtbyBsbyBzdG9wIGRlbCBwbHVnaW5cbiAgICAvLyBjaGUgbm9uIMOoIGFsdHJvIGNoZSBsb3MgdG9wbyBkZWxsJ2VkaXRpbmdcbiAgICBlbHNlIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcub24pIHtcbiAgICAgIHJldHVybiB0aGlzLnN0b3AoKTtcbiAgICB9XG4gICAgLy8gcmVzdGl0dWlzY28gdW5hIHByb21lc3NhXG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcblxuICB0aGlzLnNhdmVFZGl0cyA9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy5fY2FuY2VsT3JTYXZlKDIpO1xuICB9O1xuXG4gIC8vIGF2dmlhIHVubyBkZWkgdG9vbCBkaSBlZGl0aW5nIHRyYSBxdWVsbGkgc3VwcG9ydGF0aSBkYSBFZGl0b3IgKGFkZGZlYXR1cmUsIGVjYy4pXG4gIC8vIGZ1bnppb25lIGRlbGwnZWxlbWVudG8gcGFuZWwgdnVlXG4gIHRoaXMudG9nZ2xlRWRpdFRvb2wgPSBmdW5jdGlvbihsYXllckNvZGUsIHRvb2xUeXBlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIC8vcHJlbmRvIGlsIGxheWVyIGluIGJhc2UgYWwgY29kaWNlIHBhc3NhdG8gZGFsbCBjb21wb25lbnRlIHZ1ZVxuICAgIHZhciBsYXllciA9IHRoaXMuX2xheWVyc1tsYXllckNvZGVdO1xuICAgIGlmIChsYXllcikge1xuICAgICAgLy9yZWN1cHJlcm8gaWwgY3VycmVudCBsYXllciBpbiBlZGl0aW5nXG4gICAgICB2YXIgY3VycmVudEVkaXRpbmdMYXllciA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICAgIC8vIHNlIHNpIHN0YSB1c2FuZG8gdW4gdG9vbCBjaGUgcHJldmVkZSBsbyBzdGVzc28gbGF5ZXIgaW4gZWRpdGF6aW9uZVxuICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIgJiYgbGF5ZXJDb2RlID09IGN1cnJlbnRFZGl0aW5nTGF5ZXIubGF5ZXJDb2RlKSB7XG4gICAgICAgIC8vIGUgbG8gc3Rlc3NvIHRvb2wgYWxsb3JhIGRpc2F0dGl2byBpbCB0b29sIChpbiBxdWFudG8gw6hcbiAgICAgICAgLy8gcHJlbXV0byBzdWxsbyBzdGVzc28gYm90dG9uZSlcbiAgICAgICAgaWYgKHRvb2xUeXBlID09IGN1cnJlbnRFZGl0aW5nTGF5ZXIuZWRpdG9yLmdldEFjdGl2ZVRvb2woKS5nZXRUeXBlKCkpIHtcbiAgICAgICAgICAvLyBzdGVzc28gdGlwbyBkaSB0b29sIHF1aW5kaSBzaSDDqCB2ZXJpZmljYXRvIHVuIHRvZ2dsZSBuZWwgYm90dG9uZVxuICAgICAgICAgIC8vIGFsbG9yYSBzdGlwcG8gbCdlZGl0aW5nIFRvb2xcbiAgICAgICAgICB0aGlzLl9zdG9wRWRpdGluZ1Rvb2woKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBhbHRyaW1lbnRpIGF0dGl2byBpbCB0b29sIHJpY2hpZXN0b1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvL3N0b3BwbyBwcmV2ZW50aXZhbWVudGUgbCdlZGl0aW5nIHRvb2wgYXR0aXZvXG4gICAgICAgICAgdGhpcy5fc3RvcEVkaXRpbmdUb29sKCk7XG4gICAgICAgICAgLy9mYWNjaW8gcGFydGlyZSBsJ2VkaXRuZyB0b29sIHBhc3NhbmRvIGN1cnJlbnQgRWRpdGluZyBMYXllciBlIGlsIHRpcG8gZGkgdG9vbFxuICAgICAgICAgIHRoaXMuX3N0YXJ0RWRpdGluZ1Rvb2woY3VycmVudEVkaXRpbmdMYXllciwgdG9vbFR5cGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBhbHRyaW1lbnRpIGNhc28gaW4gY3VpIG5vbiDDqCBzdGF0byBzZXR0YXRvIGlsIGN1cnJlbnQgZWRpdGluZyBsYXllciBvXG4gICAgICAgIC8vIGlsIGxheWVyIGNoZSBzaSBzdGEgY2VyY2FuZG8gZGkgZWRpdGFyZSDDqCBkaXZlcnNvIGRhIHF1ZWxsbyBpbiBlZGl0aW5nIGluIHByZWNlZGVuemFcbiAgICAgICAgLy8gbmVsIGNhc28gc2lhIGdpw6AgIGF0dGl2byB1biBlZGl0b3IgdmVyaWZpY28gZGkgcG90ZXJsbyBzdG9wcGFyZVxuICAgICAgICBpZiAoY3VycmVudEVkaXRpbmdMYXllciAmJiBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5pc1N0YXJ0ZWQoKSkge1xuICAgICAgICAgIC8vIHNlIGxhIHRlcm1pbmF6aW9uZSBkZWxsJ2VkaXRpbmcgc2Fyw6AgIGFuZGF0YSBhIGJ1b24gZmluZSwgc2V0dG8gaWwgdG9vbFxuICAgICAgICAgIC8vIHByb3ZvIGEgc3RvcHBhcmVcbiAgICAgICAgICB0aGlzLl9jYW5jZWxPclNhdmUoMilcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fc3RvcEVkaXRvcigpKSB7XG4gICAgICAgICAgICAgICAgICBzZWxmLl9zdGFydEVkaXRpbmdUb29sKGxheWVyLCB0b29sVHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy9uZWwgY2FzbyBzaWEgbGEgcHJpbWEgdm9sdGEgY2hlIGludGVyYWdpc2NvIGNvbiB1biB0b29sXG4gICAgICAgICAgLy8gZSBxdWluZGkgbm9uIMOoIHN0YXRvIHNldHRhdG8gbmVzc3VuIGxheWVyIGluIGVkaXRpbmdcbiAgICAgICAgICB0aGlzLl9zdGFydEVkaXRpbmdUb29sKGxheWVyLCB0b29sVHlwZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy9mdW56aW9uZSBjaGUgcmVzdGl0dWlzY2UgbCdhcnJheSBkZWkgY29kaWNpIGRlaSBsYXllcnNcbiAgdGhpcy5nZXRMYXllckNvZGVzID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gXy52YWx1ZXModGhpcy5sYXllckNvZGVzKTtcbiAgfTtcblxuICAvKiBNRVRPREkgUFJJVkFUSSAqL1xuICAvLyBmdW56aW9uZSBwZXIgc2V0dGFyZSBpbCB2ZWN0b3JsYXllciBhbGxhIHByb3JpZXTDoCB2ZWN0b3IgZGVsIGxheWVyXG4gIHRoaXMuX3NldFVwVmVjdG9yTGF5ZXIgPSBmdW5jdGlvbihsYXllckNvZGUsIHZlY3RvckxheWVyKSB7XG4gICAgdGhpcy5fbGF5ZXJzW2xheWVyQ29kZV0udmVjdG9yID0gdmVjdG9yTGF5ZXI7XG4gIH07XG5cbiAgLy9mdW56aW9uZSBjaGUgcGVybWV0dGUgZGkgZmFyZSBpbCBzZXR1cCBkZWxsJ2VkaXRvciBlIGFzc2VnYW5ybG8gYWwgbGF5ZXJcbiAgdGhpcy5fc2V0VXBFZGl0b3IgPSBmdW5jdGlvbihsYXllckNvZGUpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvL29wdGlvbiBlZGl0b3JcbiAgICB2YXIgb3B0aW9uc19lZGl0b3IgPSB7XG4gICAgICAnbWFwU2VydmljZSc6IHNlbGYuX21hcFNlcnZpY2UsXG4gICAgICAnZm9ybUNsYXNzJzogRm9ybUNsYXNzXG4gICAgfTtcbiAgICAvLyBwcmVuZG8gaWwgdmVjdG9yIGxheWVyIGRlbCBsYXllclxuICAgIHZhciB2ZWN0b3JMYXllciA9IHRoaXMuX2xheWVyc1tsYXllckNvZGVdLnZlY3RvcjtcbiAgICAvL0dFU1RJT05FIEUgSU5JWklBTElaWkFaSU9ORSBERUxMJ0VESVRPUiBSRUxBVElWTyBBTCBMQVlFUiBWRVRUT1JJQUxFXG4gICAgLy9jcmVvIGwnaXN0YW56YSBkZWxsJ2VkaXRvciBjaGUgZ2VzdGlyw6AgaWwgbGF5ZXJcbiAgICB2YXIgZWRpdG9yID0gbmV3IHNlbGYuX2VkaXRvckNsYXNzW2xheWVyQ29kZV0ob3B0aW9uc19lZGl0b3IpO1xuICAgIC8vc2V0dG8gaWwgbGF5ZXIgdmV0dG9yaWFsZSBhc3NvY2lhdG8gYWxsJ2VkaXRvclxuICAgIC8vIGUgaSB0aXBpIGRpIHRvb2xzIGFzc29jaWF0aSBhZCBlc3NvXG4gICAgZWRpdG9yLnNldFZlY3RvckxheWVyKHZlY3RvckxheWVyKTtcbiAgICAvL2VtZXR0ZSBldmVudG8gY2hlIMOoIHN0YXRhIGdlbmVyYXRhIHVuYSBtb2RpZmljYSBsYSBsYXllclxuICAgIGVkaXRvci5vbihcImRpcnR5XCIsIGZ1bmN0aW9uIChkaXJ0eSkge1xuICAgICAgc2VsZi5zdGF0ZS5oYXNFZGl0cyA9IGRpcnR5O1xuICAgIH0pO1xuICAgIC8vYXNzZWdubyBsJ2lzdGFuemEgZWRpdG9yIGFsIGxheWVyIHRyYW1pdGUgbGEgcHJvcHJpZXTDoCBlZGl0b3JcbiAgICB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXS5lZGl0b3IgPSBlZGl0b3I7XG4gICAgLy8vLyBGSU5FIEdFU1RJT05FIEVESVRPUlxuICB9O1xuXG4gIC8vZmEgcGFydGlyZSBsJ2VkaXRpbmdcbiAgdGhpcy5fc3RhcnRFZGl0aW5nID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gbWkgYXNzaWN1cm8gY2hlIHNlIHBlciBxdWFsc2lzaSBtb3Rpdm9cbiAgICAvLyBmYWNjaW8gdW5vIHN0YXJlZGl0aW5nIGRpIHVuIGVkaXRpbmcgZ2nDoCBhdnZpYXRvXG4gICAgLy8gcml0b3JubyBwZXJjaMOoIGhvIGdpw6AgdHV0dG8gKGxvIGZhY2NpbyBwZXIgc2ljdXJlbm56YSBub24gc2kgc2EgbWFpKVxuICAgIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcub24gfHwgdGhpcy5zdGF0ZS5yZXRyaWV2aW5nRGF0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgLy8gY2hpZWRvIGFsIGxvYWRlciBkaSBjYXJpY2FyZSBpIGRhdGlcbiAgICB0aGlzLl9sb2FkZXIubG9hZExheWVycygndycsIHRoaXMuX2N1c3RvbVVybFBhcmFtZXRlcnMpIC8vIGNhcmljbyBpIGxheWVyIGluIG1vZGFsaXTDoCBlZGl0aW5nIChzY3JpdHR1cmEpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHZlY3RvckxheWVyc0xvYWRlZCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHZlY3RvckxheWVyc0xvYWRlZCk7XG4gICAgICAgICAgLy91bmEgdm9sdGEgY2hlIGlsIGxvYWRlciBoYSBmaW5pdG8gZGkgY2FyaWNhcmUgaSBsYXllciB2ZXR0b3JpYWxpXG4gICAgICAgICAgLy9xdWVzdG8gbWkgcmVzdGl0dWlzY2UgaSBjb2RpY2UgZGVpIGxheWVyIGNoZSBzb25vIHN0YXRpIGNhcmljYXRpKGFycmF5KVxuICAgICAgICAgIF8uZm9yRWFjaCh2ZWN0b3JMYXllcnNMb2FkZWQsIGZ1bmN0aW9uIChsYXllckNvZGUpIHtcbiAgICAgICAgICAgIC8vIHBlciBvZ25pIGxheWVyIGZhY2NpbyBpbCBzZXR1cCBkZWxsJ2VkaXRvclxuICAgICAgICAgICAgc2VsZi5fc2V0VXBFZGl0b3IobGF5ZXJDb2RlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBzZSB0dXR0byAgw6ggYW5kYXRvIGEgYnVvbiBmaW5lIGFnZ2l1bmdvIGkgVmVjdG9yTGF5ZXIgYWxsYSBtYXBwYVxuICAgICAgICAgIHNlbGYuX2FkZFRvTWFwKCk7XG4gICAgICAgICAgc2VsZi5zdGF0ZS5lZGl0aW5nLm9uID0gdHJ1ZTtcbiAgICAgICAgICBzZWxmLmVtaXQoXCJlZGl0aW5nc3RhcnRlZFwiKTtcbiAgICAgICAgICBpZiAoIXNlbGYuX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIC8vdmllbmUgcml0b3JuYXRhIGxhIGxpc3RlbmVyIGtleVxuICAgICAgICAgICAgc2VsZi5fbG9hZERhdGFPbk1hcFZpZXdDaGFuZ2VMaXN0ZW5lciA9IHNlbGYuX21hcFNlcnZpY2Uub25hZnRlcignc2V0TWFwVmlldycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAoc2VsZi5zdGF0ZS5lZGl0aW5nLm9uICYmIHNlbGYuc3RhdGUuZWRpdGluZy5lbmFibGVkKXtcbiAgICAgICAgICAgICAgICBzZWxmLl9sb2FkZXIubG9hZEFsbFZlY3RvcnNEYXRhKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oKXtcbiAgICAgICAgICBHVUkubm90aWZ5LmVycm9yKHQoJ2NvdWxkX25vdF9sb2FkX3ZlY3Rvcl9sYXllcnMnKSk7XG4gICAgICAgIH0pXG4gIH07XG5cbiAgdGhpcy5fc3RvcEVkaXRpbmcgPSBmdW5jdGlvbihyZXNldCl7XG4gICAgLy8gc2UgcG9zc28gc3RvcHBhcmUgdHV0dGkgZ2xpIGVkaXRvci4uLlxuICAgIGlmICh0aGlzLl9zdG9wRWRpdG9yKHJlc2V0KSl7XG4gICAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihsYXllciwgbGF5ZXJDb2RlKXtcbiAgICAgICAgdmFyIHZlY3RvciA9IGxheWVyLnZlY3RvcjtcbiAgICAgICAgc2VsZi5fbWFwU2VydmljZS52aWV3ZXIucmVtb3ZlTGF5ZXJCeU5hbWUodmVjdG9yLm5hbWUpO1xuICAgICAgICBsYXllci52ZWN0b3I9IG51bGw7XG4gICAgICAgIGxheWVyLmVkaXRvcj0gbnVsbDtcbiAgICAgICAgc2VsZi5fdW5sb2NrTGF5ZXIoc2VsZi5fbGF5ZXJzW2xheWVyQ29kZV0pO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl91cGRhdGVFZGl0aW5nU3RhdGUoKTtcbiAgICAgIHNlbGYuc3RhdGUuZWRpdGluZy5vbiA9IGZhbHNlO1xuICAgICAgc2VsZi5fY2xlYW5VcCgpO1xuICAgICAgc2VsZi5lbWl0KFwiZWRpdGluZ3N0b3BwZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuX2NsZWFuVXAgPSBmdW5jdGlvbigpIHtcbiAgICAvL3ZhZG8gYWQgYW5udWxhcmUgbCdlc3Rlbnppb25lIGRlbCBsb2FkZXIgcGVyIHBvdGVyIHJpY2FyaWNhcmUgaSBkYXRpIHZldHR0b3JpYWxpXG4gICAgLy9kYSByaXZlZGVyZTtcbiAgICB0aGlzLl9sb2FkZXIuY2xlYW5VcExheWVycygpO1xuXG4gIH07XG4gIC8vc2Ugbm9uIMOoIGFuY29yYSBwYXJ0aXRvIGZhY2NpbyBwYXJ0aXJlIGxvIHN0YXJ0IGVkaXRvclxuICB0aGlzLl9zdGFydEVkaXRvciA9IGZ1bmN0aW9uKGxheWVyKXtcbiAgICAvLyBhdnZpbyBsJ2VkaXRvclxuICAgIC8vIHBhc3NhbmRvbGkgaWwgc2VydmljZSBjaGUgbG8gYWNjZXR0YVxuICAgIGlmIChsYXllci5lZGl0b3Iuc3RhcnQodGhpcykpIHtcbiAgICAgIC8vIHJlZ2lzdHJvIGlsIGN1cnJlbnQgbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgdGhpcy5fc2V0Q3VycmVudEVkaXRpbmdMYXllcihsYXllcik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICAvL2Z1bnppb25lIGNoZSB2aWVuZSBjaGlhbWF0YSBhbCBjbGljayBzdSB1biB0b29sIGRlbGwnZWRpdGluZyBlIHNlXG4gIC8vbm9uIMOoIHN0YXRvIGFzc2VnbmF0byBhbmNvcmEgbmVzc3VuIGxheWVyIGNvbWUgY3VycmVudCBsYXllciBlZGl0aW5nXG4gIHRoaXMuX3N0YXJ0RWRpdGluZ1Rvb2wgPSBmdW5jdGlvbihsYXllciwgdG9vbFR5cGUsIG9wdGlvbnMpIHtcbiAgICAvL2Fzc2Vnbm8gdHJ1ZSBhbGxvIHN0YXJ0RWRpdGluZ1Rvb2wgYXR0cmlidXRvIGRlbGxsbyBzdGF0ZVxuICAgIHRoaXMuc3RhdGUuc3RhcnRpbmdFZGl0aW5nVG9vbCA9IHRydWU7XG4gICAgdmFyIGNhblN0YXJ0VG9vbCA9IHRydWU7XG4gICAgLy92ZXJpZmljbyBzZSBsJ2VkaXRvciDDqCBwYXJ0aXRvIG8gbWVub1xuICAgIGlmICghbGF5ZXIuZWRpdG9yLmlzU3RhcnRlZCgpKSB7XG4gICAgICAvL3NlIG5vbiDDqCBhbmNvcmEgcGFydGl0byBsbyBmYWNjaW8gcGFydGlyZSBlIG5lIHByZW5kbyBpbCByaXN1bHRhdG9cbiAgICAgIC8vIHRydWUgbyBmYWxzZVxuICAgICAgY2FuU3RhcnRUb29sID0gdGhpcy5fc3RhcnRFZGl0b3IobGF5ZXIpO1xuICAgIH1cbiAgICAvLyB2ZXJpZmljYSBzZSBpbCB0b29sIHB1w7IgZXNzZXJlIGF0dGl2YXRvXG4gICAgLy8gbCdlZGl0b3IgdmVyaWZpY2Egc2UgaWwgdG9vbCByaWNoaWVzdG8gw6ggY29tcGF0aWJpbGVcbiAgICAvLyBjb24gaSB0b29scyBwcmV2aXN0aSBkYWxsJ2VkaXRvci4gQ3JlYSBpc3RhbnphIGRpIHRvb2wgZSBhdnZpYSBpbCB0b29sXG4gICAgLy8gYXR0cmF2ZXJzbyBpbCBtZXRvZG8gcnVuXG4gICAgaWYgKGNhblN0YXJ0VG9vbCAmJiBsYXllci5lZGl0b3Iuc2V0VG9vbCh0b29sVHlwZSwgb3B0aW9ucykpIHtcbiAgICAgIHRoaXMuX3VwZGF0ZUVkaXRpbmdTdGF0ZSgpO1xuICAgICAgdGhpcy5zdGF0ZS5zdGFydGluZ0VkaXRpbmdUb29sID0gZmFsc2U7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZS5zdGFydGluZ0VkaXRpbmdUb29sID0gZmFsc2U7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHRoaXMuX3N0b3BFZGl0b3IgPSBmdW5jdGlvbihyZXNldCl7XG4gICAgdmFyIHJldCA9IHRydWU7XG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIGlmIChsYXllcikge1xuICAgICAgcmV0ID0gbGF5ZXIuZWRpdG9yLnN0b3AocmVzZXQpO1xuICAgICAgaWYgKHJldCl7XG4gICAgICAgIHRoaXMuX3NldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIHNpIG9jY3VwYSBkaSBpbnRlcnJvbWVwZXJlIGwnZWR0aW5nIHRvb2xcbiAgdGhpcy5fc3RvcEVkaXRpbmdUb29sID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJldCA9IHRydWU7XG4gICAgLy8gcmVjdXBlcmUgaWwgbGF5ZXIgaW4gY3VycmVudCBlZGl0aW5nXG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIC8vIHNlIGVzaXN0ZSBlZCBlcmEgc3RhdG8gc2V0dGF0b1xuICAgIGlmIChsYXllcikge1xuICAgICAgLy8gc2UgYW5kYXRvIGJlbmUgcml0b3JuYSB0cnVlXG4gICAgICByZXQgPSBsYXllci5lZGl0b3Iuc3RvcFRvb2woKTtcbiAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlRWRpdGluZ1N0YXRlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBhY2NldHRhIGNvbWUgcGFyYW1ldHJvIGlsIHRpcG8gZGlcbiAgLy8gb3BlcmF6aW9uZSBkYSBmYXJlIGEgc2Vjb25kYSBkaWNvc2Egw6ggYXZ2ZW51dG9cbiAgdGhpcy5fY2FuY2VsT3JTYXZlID0gZnVuY3Rpb24odHlwZSl7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIC8vIHBlciBzaWN1cmV6emEgdGVuZ28gdHV0dG8gZGVudHJvIHVuIGdyb3NzbyB0cnkvY2F0Y2gsXG4gICAgLy8gcGVyIG5vbiByaXNjaGlhcmUgZGkgcHJvdm9jYXJlIGluY29uc2lzdGVuemUgbmVpIGRhdGkgZHVyYW50ZSBpbCBzYWx2YXRhZ2dpb1xuICAgIHRyeSB7XG4gICAgICB2YXIgX2Fza1R5cGUgPSAxO1xuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgX2Fza1R5cGUgPSB0eXBlXG4gICAgICB9XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgY2hvaWNlID0gXCJjYW5jZWxcIjtcbiAgICAgIHZhciBkaXJ0eUVkaXRvcnMgPSB7fTtcbiAgICAgIC8vIHZlcmlmaWNvIHBlciBvZ25pIGxheWVyIHNlIGwnZWRpdG8gYXNzb2NpYXRvIMOoIERpcnR5XG4gICAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihsYXllciwgbGF5ZXJDb2RlKSB7XG4gICAgICAgIGlmIChsYXllci5lZGl0b3IuaXNEaXJ0eSgpKSB7XG4gICAgICAgICAgZGlydHlFZGl0b3JzW2xheWVyQ29kZV0gPSBsYXllci5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gdmVyaWZpY28gc2UgY2kgc29ubyBvIG1lbm8gZWRpdG9yIHNwb3JjaGlcbiAgICAgIGlmKF8ua2V5cyhkaXJ0eUVkaXRvcnMpLmxlbmd0aCkge1xuICAgICAgICB0aGlzLl9hc2tDYW5jZWxPclNhdmUoX2Fza1R5cGUpLlxuICAgICAgICB0aGVuKGZ1bmN0aW9uKGFjdGlvbikge1xuICAgICAgICAgIC8vIHJpdG9ybmEgaWwgdGlwbyBkaSBhemlvbmUgZGEgZmFyZVxuICAgICAgICAgIC8vIHNhdmUsIGNhbmNlbCwgbm9zYXZlXG4gICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3NhdmUnKSB7XG4gICAgICAgICAgICAvLyBwYXNzbyBnbGkgZWRpdG9yIHNwb2NoaSBhbGxhIGZ1bnppb25lIF9zYXZlRWRpdHNcbiAgICAgICAgICAgIHNlbGYuX3NhdmVFZGl0cyhkaXJ0eUVkaXRvcnMpLlxuICAgICAgICAgICAgdGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PSAnbm9zYXZlJykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09ICdjYW5jZWwnKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgfVxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBpbiBiYXNlIGFsIHRpcG8gZGkgYXNrVHlwZVxuICAvLyB2aXN1YWxpenphIGlsIG1vZGFsZSBhIGN1aSByaXNwb25kZXJlLCBzYWx2YSBldGMgLi5cbiAgdGhpcy5fYXNrQ2FuY2VsT3JTYXZlID0gZnVuY3Rpb24odHlwZSl7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIHZhciBidXR0b25UeXBlcyA9IHtcbiAgICAgIFNBVkU6IHtcbiAgICAgICAgbGFiZWw6IFwiU2FsdmFcIixcbiAgICAgICAgY2xhc3NOYW1lOiBcImJ0bi1zdWNjZXNzXCIsXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ3NhdmUnKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIE5PU0FWRToge1xuICAgICAgICBsYWJlbDogXCJUZXJtaW5hIHNlbnphIHNhbHZhcmVcIixcbiAgICAgICAgY2xhc3NOYW1lOiBcImJ0bi1kYW5nZXJcIixcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnbm9zYXZlJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBDQU5DRUw6IHtcbiAgICAgICAgbGFiZWw6IFwiQW5udWxsYVwiLFxuICAgICAgICBjbGFzc05hbWU6IFwiYnRuLXByaW1hcnlcIixcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnY2FuY2VsJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHN3aXRjaCAodHlwZSl7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGJ1dHRvbnMgPSB7XG4gICAgICAgICAgc2F2ZTogYnV0dG9uVHlwZXMuU0FWRSxcbiAgICAgICAgICBub3NhdmU6IGJ1dHRvblR5cGVzLk5PU0FWRSxcbiAgICAgICAgICBjYW5jZWw6IGJ1dHRvblR5cGVzLkNBTkNFTFxuICAgICAgICB9O1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgYnV0dG9ucyA9IHtcbiAgICAgICAgICBzYXZlOiBidXR0b25UeXBlcy5TQVZFLFxuICAgICAgICAgIGNhbmNlbDogYnV0dG9uVHlwZXMuQ0FOQ0VMXG4gICAgICAgIH07XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBHVUkuZGlhbG9nLmRpYWxvZyh7XG4gICAgICBtZXNzYWdlOiBcIlZ1b2kgc2FsdmFyZSBkZWZpbml0aXZhbWVudGUgbGUgbW9kaWZpY2hlP1wiLFxuICAgICAgdGl0bGU6IFwiU2FsdmF0YWdnaW8gbW9kaWZpY2FcIixcbiAgICAgIGJ1dHRvbnM6IGJ1dHRvbnNcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xuICB9O1xuICAvLyBmdW56aW9uZSBjaGUgc2FsdmEgaSBkYXRpIHJlbGF0aXZpIGFsIGxheWVyIHZldHRvcmlhbGVcbiAgLy8gZGVsIGRpcnR5RWRpdG9yXG4gIHRoaXMuX3NhdmVFZGl0cyA9IGZ1bmN0aW9uKGRpcnR5RWRpdG9ycyl7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIHRoaXMuX3NlbmRFZGl0cyhkaXJ0eUVkaXRvcnMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICBHVUkubm90aWZ5LnN1Y2Nlc3MoXCJJIGRhdGkgc29ubyBzdGF0aSBzYWx2YXRpIGNvcnJldHRhbWVudGVcIik7XG4gICAgICAgICAgc2VsZi5fY29tbWl0RWRpdHMoZGlydHlFZGl0b3JzLCByZXNwb25zZSk7XG4gICAgICAgICAgc2VsZi5fbWFwU2VydmljZS5yZWZyZXNoTWFwKCk7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcnMpe1xuICAgICAgICAgIEdVSS5ub3RpZnkuZXJyb3IoXCJFcnJvcmUgbmVsIHNhbHZhdGFnZ2lvIHN1bCBzZXJ2ZXJcIik7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xuICB9O1xuICAvLyBmdW56aW9uZSBjaGUgcHJlbmRlIGNvbWUgaW5ncmVzc28gZ2xpIGVkaXRvciBzcG9yY2hpXG4gIHRoaXMuX3NlbmRFZGl0cyA9IGZ1bmN0aW9uKGRpcnR5RWRpdG9ycykge1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICB2YXIgZWRpdHNUb1B1c2ggPSBfLm1hcChkaXJ0eUVkaXRvcnMsIGZ1bmN0aW9uKGVkaXRvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGF5ZXJuYW1lOiBlZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKS5uYW1lLFxuICAgICAgICBlZGl0czogZWRpdG9yLmdldEVkaXRlZEZlYXR1cmVzKClcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBlc2VndWUgaWwgcG9zdCBkZWkgZGF0aVxuICAgIHRoaXMuX3Bvc3REYXRhKGVkaXRzVG9QdXNoKVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXR1cm5lZCl7XG4gICAgICAgICAgaWYgKHJldHVybmVkLnJlc3VsdCl7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJldHVybmVkLnJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmV0dXJuZWQucmVzcG9uc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24ocmV0dXJuZWQpe1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXR1cm5lZC5yZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG5cbiAgdGhpcy5fY29tbWl0RWRpdHMgPSBmdW5jdGlvbihlZGl0b3JzLHJlc3BvbnNlKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgXy5mb3JFYWNoKGVkaXRvcnMsZnVuY3Rpb24oZWRpdG9yKXtcbiAgICAgIHZhciBuZXdBdHRyaWJ1dGVzRnJvbVNlcnZlciA9IG51bGw7XG4gICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UubmV3KXtcbiAgICAgICAgXy5mb3JFYWNoKHJlc3BvbnNlLm5ldyxmdW5jdGlvbih1cGRhdGVkRmVhdHVyZUF0dHJpYnV0ZXMpe1xuICAgICAgICAgIHZhciBvbGRmaWQgPSB1cGRhdGVkRmVhdHVyZUF0dHJpYnV0ZXMuY2xpZW50aWQ7XG4gICAgICAgICAgdmFyIGZpZCA9IHVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcy5pZDtcbiAgICAgICAgICBlZGl0b3IuZ2V0RWRpdFZlY3RvckxheWVyKCkuc2V0RmVhdHVyZURhdGEob2xkZmlkLGZpZCxudWxsLHVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcyk7XG4gICAgICAgICAgXy5mb3JFYWNoKHJlc3BvbnNlLm5ld19sb2NraWRzLCBmdW5jdGlvbihuZXdsb2NrSWQpe1xuICAgICAgICAgICAgZWRpdG9yLmdldFZlY3RvckxheWVyKCkuYWRkTG9ja0lkKG5ld2xvY2tJZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBlZGl0b3IuY29tbWl0KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fdW5kb0VkaXRzID0gZnVuY3Rpb24oZGlydHlFZGl0b3JzKXtcbiAgICB2YXIgY3VycmVudEVkaXRpbmdMYXllckNvZGUgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCkubGF5ZXJDb2RlO1xuICAgIHZhciBlZGl0b3IgPSBkaXJ0eUVkaXRvcnNbY3VycmVudEVkaXRpbmdMYXllckNvZGVdO1xuICAgIHRoaXMuX3N0b3BFZGl0aW5nKHRydWUpO1xuICB9O1xuICAvLyBlc2VndWUgbCd1cGRhdGUgZGVsbG8gc3RhdGUgbmVsIGNhc28gYWQgZXNlbXBpbyBkaSB1biB0b2dnbGUgZGVsIGJvdHRvbmUgdG9vbFxuICB0aGlzLl91cGRhdGVFZGl0aW5nU3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBwcmVuZGUgaWwgbGF5ZXIgaW4gRWRpdGluZ1xuICAgIHZhciBsYXllciA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIHRoaXMuc3RhdGUuZWRpdGluZy5sYXllckNvZGUgPSBsYXllci5sYXllckNvZGU7XG4gICAgICB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbFR5cGUgPSBsYXllci5lZGl0b3IuZ2V0QWN0aXZlVG9vbCgpLmdldFR5cGUoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLnN0YXRlLmVkaXRpbmcubGF5ZXJDb2RlID0gbnVsbDtcbiAgICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sVHlwZSA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuX3VwZGF0ZVRvb2xTdGVwc1N0YXRlKCk7XG4gIH07XG5cbiAgdGhpcy5fdXBkYXRlVG9vbFN0ZXBzU3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIHZhciBhY3RpdmVUb29sO1xuICAgIGlmIChsYXllcikge1xuICAgICAgYWN0aXZlVG9vbCA9IGxheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCk7XG4gICAgfVxuICAgIGlmIChhY3RpdmVUb29sICYmIGFjdGl2ZVRvb2wuZ2V0VG9vbCgpKSB7XG4gICAgICB2YXIgdG9vbEluc3RhbmNlID0gYWN0aXZlVG9vbC5nZXRUb29sKCk7XG4gICAgICBpZiAodG9vbEluc3RhbmNlLnN0ZXBzKXtcbiAgICAgICAgdGhpcy5fc2V0VG9vbFN0ZXBTdGF0ZShhY3RpdmVUb29sKTtcbiAgICAgICAgdG9vbEluc3RhbmNlLnN0ZXBzLm9uKCdzdGVwJywgZnVuY3Rpb24oaW5kZXgsc3RlcCkge1xuICAgICAgICAgIHNlbGYuX3NldFRvb2xTdGVwU3RhdGUoYWN0aXZlVG9vbCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0b29sSW5zdGFuY2Uuc3RlcHMub24oJ2NvbXBsZXRlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICBzZWxmLl9zZXRUb29sU3RlcFN0YXRlKCk7XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgc2VsZi5fc2V0VG9vbFN0ZXBTdGF0ZSgpO1xuICAgIH1cbiAgfTtcblxuICB0aGlzLl9zZXRUb29sU3RlcFN0YXRlID0gZnVuY3Rpb24oYWN0aXZlVG9vbCl7XG4gICAgdmFyIGluZGV4LCB0b3RhbCwgbWVzc2FnZTtcbiAgICBpZiAoXy5pc1VuZGVmaW5lZChhY3RpdmVUb29sKSl7XG4gICAgICBpbmRleCA9IG51bGw7XG4gICAgICB0b3RhbCA9IG51bGw7XG4gICAgICBtZXNzYWdlID0gbnVsbDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB2YXIgdG9vbCA9IGFjdGl2ZVRvb2wuZ2V0VG9vbCgpO1xuICAgICAgdmFyIG1lc3NhZ2VzID0gdG9vbFN0ZXBzTWVzc2FnZXNbYWN0aXZlVG9vbC5nZXRUeXBlKCldO1xuICAgICAgaW5kZXggPSB0b29sLnN0ZXBzLmN1cnJlbnRTdGVwSW5kZXgoKTtcbiAgICAgIHRvdGFsID0gdG9vbC5zdGVwcy50b3RhbFN0ZXBzKCk7XG4gICAgICBtZXNzYWdlID0gbWVzc2FnZXNbaW5kZXhdO1xuICAgICAgaWYgKF8uaXNVbmRlZmluZWQobWVzc2FnZSkpIHtcbiAgICAgICAgaW5kZXggPSBudWxsO1xuICAgICAgICB0b3RhbCA9IG51bGw7XG4gICAgICAgIG1lc3NhZ2UgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAubiA9IGluZGV4ICsgMTtcbiAgICB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAudG90YWwgPSB0b3RhbDtcbiAgICB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAubWVzc2FnZSA9IG1lc3NhZ2U7XG4gIH07XG5cbiAgdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9jdXJyZW50RWRpdGluZ0xheWVyO1xuICB9O1xuXG4gIHRoaXMuX3NldEN1cnJlbnRFZGl0aW5nTGF5ZXIgPSBmdW5jdGlvbihsYXllcil7XG4gICAgaWYgKCFsYXllcil7XG4gICAgICB0aGlzLl9jdXJyZW50RWRpdGluZ0xheWVyID0gbnVsbDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9jdXJyZW50RWRpdGluZ0xheWVyID0gbGF5ZXI7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuX2FkZFRvTWFwID0gZnVuY3Rpb24oKSB7XG4gICAgLy9yZWN1cGVybyBsJ2VsZW1lbnRvIG1hcCBvbDNcbiAgICB2YXIgbWFwID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwO1xuICAgIHZhciBsYXllckNvZGVzID0gdGhpcy5nZXRMYXllckNvZGVzKCk7XG4gICAgLy9vZ25pIGxheWVyIGxvIGFnZ2l1bmdvIGFsbGEgbWFwcGFcbiAgICAvL2NvbiBpbCBtZXRvZG8gYWRkVG9NYXAgZGkgdmVjdG9yTGF5ZXJcbiAgICBfLmZvckVhY2gobGF5ZXJDb2RlcywgZnVuY3Rpb24obGF5ZXJDb2RlKSB7XG4gICAgICBzZWxmLl9sYXllcnNbbGF5ZXJDb2RlXS52ZWN0b3IuYWRkVG9NYXAobWFwKTtcbiAgICB9KVxuICB9O1xuXG4gIHRoaXMuX3Bvc3REYXRhID0gZnVuY3Rpb24oZWRpdHNUb1B1c2gpIHtcblxuICAgIC8vIG1hbmRvIHVuIG9nZ2V0dG8gY29tZSBuZWwgY2FzbyBkZWwgYmF0Y2gsXG4gICAgLy8gbWEgaW4gcXVlc3RvIGNhc28gZGV2byBwcmVuZGVyZSBzb2xvIGlsIHByaW1vLCBlIHVuaWNvLCBlbGVtZW50b1xuICAgIGlmIChlZGl0c1RvUHVzaC5sZW5ndGggPiAxKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9zdEJhdGNoRGF0YShlZGl0c1RvUHVzaCk7XG4gICAgfVxuICAgIHZhciBsYXllck5hbWUgPSBlZGl0c1RvUHVzaFswXS5sYXllcm5hbWU7XG4gICAgdmFyIGVkaXRzID0gZWRpdHNUb1B1c2hbMF0uZWRpdHM7XG4gICAgdmFyIGpzb25EYXRhID0gSlNPTi5zdHJpbmdpZnkoZWRpdHMpO1xuICAgIHJldHVybiAkLnBvc3Qoe1xuICAgICAgdXJsOiB0aGlzLmNvbmZpZy5iYXNldXJsK2xheWVyTmFtZStcIi9cIixcbiAgICAgIGRhdGE6IGpzb25EYXRhLFxuICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fcG9zdEJhdGNoRGF0YSA9IGZ1bmN0aW9uKG11bHRpRWRpdHNUb1B1c2gpe1xuICAgIHZhciBlZGl0cyA9IHt9O1xuICAgIF8uZm9yRWFjaChtdWx0aUVkaXRzVG9QdXNoLGZ1bmN0aW9uKGVkaXRzVG9QdXNoKXtcbiAgICAgIGVkaXRzW2VkaXRzVG9QdXNoLmxheWVybmFtZV0gPSBlZGl0c1RvUHVzaC5lZGl0cztcbiAgICB9KTtcbiAgICB2YXIganNvbkRhdGEgPSBKU09OLnN0cmluZ2lmeShlZGl0cyk7XG4gICAgcmV0dXJuICQucG9zdCh7XG4gICAgICB1cmw6IHRoaXMuY29uZmlnLmJhc2V1cmwsXG4gICAgICBkYXRhOiBqc29uRGF0YSxcbiAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH0pO1xuICB9O1xuXG4gIHRoaXMuX3VubG9jayA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGxheWVyQ29kZXMgPSB0aGlzLmdldExheWVyQ29kZXMoKTtcbiAgICAvLyBlc2VndW8gbGUgcmljaGllc3RlIGRlbGxlIGNvbmZpZ3VyYXppb25pIGUgbWkgdGVuZ28gbGUgcHJvbWVzc2VcbiAgICB2YXIgdW5sb2NrUmVxdWVzdHMgPSBfLm1hcChsYXllckNvZGVzLGZ1bmN0aW9uKGxheWVyQ29kZSl7XG4gICAgICByZXR1cm4gc2VsZi5fdW5sb2NrTGF5ZXIoc2VsZi5fbGF5ZXJzW2xheWVyQ29kZV0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHRoaXMuX3VubG9ja0xheWVyID0gZnVuY3Rpb24obGF5ZXJDb25maWcpe1xuICAgICQuZ2V0KHRoaXMuY29uZmlnLmJhc2V1cmwrbGF5ZXJDb25maWcubmFtZStcIi8/dW5sb2NrXCIpO1xuICB9O1xuICAvL2dldCBsb2FkZXIgc2VydmljZVxuICB0aGlzLmdldExvYWRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9sb2FkZXI7XG4gIH1cbn1cblxuaW5oZXJpdChHZW9ub3Rlc1NlcnZpY2UsIEczV09iamVjdCk7XG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBHZW9ub3Rlc1NlcnZpY2U7XG59LHtcIi4vZWRpdG9ycy9hdHRyaWJ1dGVzZm9ybVwiOjF9XX0se30sWzNdKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
