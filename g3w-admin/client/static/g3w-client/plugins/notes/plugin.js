!function e(t,i,n){function o(r,a){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){var i=t[r][1][e];return o(i?i:e)},d,d.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t,e,i){function n(t){s(this,t),this._formPanel=l}var o=g3wsdk.core.utils.inherit,s=g3wsdk.core.utils.base,r=g3wsdk.gui.FormPanel,a=g3wsdk.gui.Form,l=r.extend({});o(n,a),e.exports=n},{}],2:[function(t,e,i){function n(t){t.formTools=[],s(this,t);var e=function(){a.saveEdits()};this.onafter("addFeature",e),this.onafter("deleteFeature",e),this.onafter("moveFeature",e)}var o=g3wsdk.core.utils.inherit,s=g3wsdk.core.utils.base,r=g3wsdk.core.Editor,a=t("../pluginservice");t("./attributesform");o(n,r),e.exports=n},{"../pluginservice":7,"./attributesform":1}],3:[function(t,e,i){var n=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,s=g3wsdk.core.Plugin,r=g3wsdk.gui.GUI,a=g3wsdk.core.ProjectsRegistry,l=t("pluginconfig"),c=t("./pluginservice"),d=t("./panel"),u=function(){o(this),this.name="notes",this.config=null,this.service=null,this.init=function(){this.setPluginService(c),this.config=this.getPluginConfig(),this.setUpIconUrl(this.config.layers),this.registerPlugin(this.config.gid)&&(r.ready?this.setupGui():r.on("ready",_.bind(this.setupGui,this)),l.customUrlParameters=this.createPluginCustomUrlParameters(),this.service.init(this.config,l))},this.setupGui=function(){var t=r.getComponent("tools"),e=t.getService(),i=l.tools(this);e.addTools(1,"GEONOTES",i)},this.toolsActions={showHideLayer:function(){console.log("showHideLayer")},showEditingPanel:function(){var t=new d;this.service.toggleEditing(),r.showPanel(t)}},this.createPluginCustomUrlParameters=function(){var t="&",e=a.getCurrentProject();return t+="project_type="+e.getType()+"&project_id="+e.getId()},this.setUpIconUrl=function(t){_.forEach(t,function(t){l.layers[t.name].iconurl=t.iconurl})},this.setupToolsAction=function(t){_.forEach(t,function(t){})}};n(u,s),function(t){t.init()}(new u)},{"./panel":5,"./pluginservice":7,pluginconfig:6}],4:[function(t,e,i){e.exports='<div class="g3w-iternet-editing-panel">\n  <template v-for="toolbar in editorstoolbars">\n    <div class="panel panel-primary">\n      <div class="panel-heading">\n        <h3 class="panel-title">{{ toolbar.name }}</h3>\n      </div>\n      <div class="panel-body">\n        <template v-for="tool in toolbar.tools">\n          <div class="editbtn" :class="{\'enabled\' : (state.editing.on && editingtoolbtnEnabled(tool)), \'toggled\' : editingtoolbtnToggled(toolbar.layercode, tool.tooltype)}">\n            <img height="30px" width="30px" @click="toggleEditTool(toolbar.layercode, tool.tooltype)" :alt.once="tool.title" :title.once="tool.title" :src.once="resourcesurl+\'images/\'+tool.icon"></img>\n          </div>\n        </template>\n      </div>\n    </div>\n  </template>\n  <div v-show="state.retrievingData">\n    <!--<button class="btn btn-primary" v-disabled="editingbtnEnabled" :class="{\'btn-success\' : state.editingOn}" @click="toggleEditing">{{ editingbtnlabel }}</button>-->\n    <!--<button class="btn btn-danger" v-disabled="!state.hasEdits" @click="saveEdits">{{ savebtnlabel }}</button>-->\n    <span>Caricamento Dati ... </span><img :src="resourcesurl +\'images/loader.svg\'">\n  </div>\n  <div class="message">\n    {{{ message }}}\n  </div>\n</div>\n'},{}],5:[function(t,e,i){function n(){this.id="iternet-editing-panel",this.name="Gestione dati ITERNET",this.internalPanel=new c}var o=g3wsdk.core.utils.resolve,s=g3wsdk.core.utils.inherit,r=g3wsdk.gui.GUI,a=g3wsdk.gui.Panel,l=t("./pluginservice"),c=Vue.extend({template:t("./panel.html"),data:function(){return{state:l.state,resourcesurl:r.getResourcesUrl(),editorstoolbars:[{name:"Geonotes",layercode:l.layerCodes.GEONOTES,tools:[{title:"Aggiungi Geonota",tooltype:"addfeature",icon:"iternetAddPoint.png"},{title:"Sposta Geonota",tooltype:"movefeature",icon:"iternetMovePoint.png"},{title:"Rimuovi Geonota",tooltype:"deletefeature",icon:"iternetDeletePoint.png"},{title:"Edita geonota",tooltype:"editattributes",icon:"editAttributes.png"}]}],savebtnlabel:"Salva"}},methods:{toggleEditing:function(){l.toggleEditing()},saveEdits:function(){l.saveEdits()},toggleEditTool:function(t,e){""!=e&&this.state.editing.on&&l.toggleEditTool(t,e)},editingtoolbtnToggled:function(t,e){return this.state.editing.layerCode==t&&this.state.editing.toolType==e},editingtoolbtnEnabled:function(t){return""!=t.tooltype}},computed:{editingbtnlabel:function(){return this.state.editing.on?"Termina editing":"Avvia editing"},editingbtnEnabled:function(){return this.state.editing.enabled||this.state.editing.on?"":"disabled"},message:function(){var t="";if(this.state.editing.enabled){if(this.state.editing.toolstep.message){var e=this.state.editing.toolstep.n,i=this.state.editing.toolstep.total,n=this.state.editing.toolstep.message;t='<div style="margin-top:20px">GUIDA STRUMENTO:</div><div><span>['+e+"/"+i+'] </span><span style="color: yellow">'+n+"</span></div>"}}else t='<span style="color: red">Aumentare il livello di zoom per abilitare l\'editing';return t}}});s(n,a);var d=a.prototype;d.onShow=function(t){var e=this.internalPanel;return e.$mount().$appendTo(t),o(!0)},d.onClose=function(){var t=this,e=$.Deferred();return l.stop().then(function(){t.internalPanel.$destroy(!0),t.internalPanel=null,e.resolve()}).fail(function(){e.reject()}),e.promise()},e.exports=n},{"./panel.html":4,"./pluginservice":7}],6:[function(t,e,i){function n(t){return n=[{name:"Visualizza Geonotes",type:"checkbox",action:_.bind(t.toolsActions.showHideLayer,t)},{name:"Strumenti Geonotes",action:_.bind(t.toolsActions.showEditingPanel,t)}]}var o=t("./editors/geonoteseditor"),s=this.layerCodes={GEONOTES:"note"},r={};r[s.GEONOTES]=o;var a={};a[s.GEONOTES]={layerCode:s.GEONOTES,vector:null,editor:null,iconurl:"/static/icon.png",crs:null,style:new ol.style.Style({image:new ol.style.Icon({anchor:[0,0],anchorXUnits:"pixels",anchorYUnits:"pixels",src:"/static/notes/img/placeholder-20.png"})})},e.exports={layersCode:s,layers:a,editorClass:r,tools:n}},{"./editors/geonoteseditor":2}],7:[function(e,i,n){function o(){var e=this;this._mapService=null,this._loadDataOnMapViewChangeListener=null,this._currentEditingLayer=null,this.state={editing:{on:!1,enabled:!1,layerCode:null,toolType:null,startingEditingTool:!1,toolstep:{n:null,total:null,message:null}},retrievingData:!1,hasEdits:!1},this._loader=new l;var i={resolution:1};this.init=function(t,e){var n=this;this.config=t,this._crs=null,this._layers=e.layers,this._editorClass=e.editorClass,this.layerCodes=e.layersCode,this._customUrlParameters=e.customUrlParameters||null,this._mapService=a.getComponent("map").getService(),_.forEach(this.config.layers,function(t,e){n._layers[e].infourl=t.infourl,n._layers[e].crs="EPSG:"+t.crs});var o={layers:this._layers,baseurl:this.config.baseurl,mapService:this._mapService};this._loader.init(o),this._loader.on("loadingvectorlayersstart",function(){n.state.retrievingData=!0}),this._loader.on("loadingvectorlayersend",function(){n.state.retrievingData=!1}),this._mapService.on("pointerInteractionSet",function(t){var e=n._getCurrentEditingLayer();if(e){var i=e.editor.getActiveTool().instance;i&&!i.ownsInteraction(t)&&n._stopEditingTool()}}),this._mapService.onafter("setMapView",function(t,e,o){n.state.editing.enabled=e<i.resolution}),this.state.editing.enabled=this._mapService.getResolution()<i.resolution,_.forEach(this._layers,function(e,i){var o=t.layers[i].id,s=t.layers[i].name,r=n._mapService.getProject().getLayerById(o);r?(e.name=r.getOrigName(),e.id=o):(e.name=s,e.id=o)})},this.stop=function(){var t=$.Deferred();return this.state.editing.on?this._cancelOrSave().then(function(){e._stopEditing(),t.resolve()}).fail(function(){t.reject()}):t.resolve(),t.promise()},this.toggleEditing=function(){var t=$.Deferred();if(this.state.editing.enabled&&!this.state.editing.on)this._startEditing();else if(this.state.editing.on)return this.stop();return t.promise()},this.saveEdits=function(){this._saveWithoutAsk()},this.toggleEditTool=function(t,e){var i=this,n=this._layers[t];if(n){var o=this._getCurrentEditingLayer();o&&t==o.layerCode?e==o.editor.getActiveTool().getType()?this._stopEditingTool():(this._stopEditingTool(),this._startEditingTool(o,e)):o&&o.editor.isStarted()?this._cancelOrSave(2).then(function(){i._stopEditor()&&i._startEditingTool(n,e)}):this._startEditingTool(n,e)}},this.getLayerCodes=function(){return _.values(this.layerCodes)},this._setUpVectorLayer=function(t,e){this._layers[t].vector=e},this._setUpEditor=function(t){var e=this,i={mapService:e._mapService,formClass:c},n=this._layers[t].vector,o=new e._editorClass[t](i);o.setVectorLayer(n),o.on("dirty",function(t){e.state.hasEdits=t}),this._layers[t].editor=o},this._startEditing=function(){if(!this.state.editing.on&&!this.state.retrievingData){var e=this;this._loader.loadLayers("w",this._customUrlParameters).then(function(t){_.forEach(t,function(t){e._setUpEditor(t)}),e._addToMap(),e.state.editing.on=!0,e.emit("editingstarted"),e._loadDataOnMapViewChangeListener||(e._loadDataOnMapViewChangeListener=e._mapService.onafter("setMapView",function(){e.state.editing.on&&e.state.editing.enabled&&e._loader.loadAllVectorsData()}))}).fail(function(){a.notify.error(t("could_not_load_vector_layers"))})}},this._stopEditing=function(t){this._stopEditor(t)&&(_.forEach(this._layers,function(t,i){var n=t.vector;e._mapService.viewer.removeLayerByName(n.name),t.vector=null,t.editor=null,e._unlockLayer(e._layers[i])}),this._updateEditingState(),e.state.editing.on=!1,e._cleanUp(),e.emit("editingstopped"))},this._cleanUp=function(){this._loader.cleanUpLayers()},this._startEditor=function(t){return!!t.editor.start(this)&&(this._setCurrentEditingLayer(t),!0)},this._startEditingTool=function(t,e,i){this.state.startingEditingTool=!0;var n=!0;return t.editor.isStarted()||(n=this._startEditor(t)),n&&t.editor.setTool(e,i)?(this._updateEditingState(),this.state.startingEditingTool=!1,!0):(this.state.startingEditingTool=!1,!1)},this._stopEditor=function(t){var e=!0,i=this._getCurrentEditingLayer();return i&&(e=i.editor.stop(t),e&&this._setCurrentEditingLayer()),e},this._stopEditingTool=function(){var t=!0,e=this._getCurrentEditingLayer();return e&&(t=e.editor.stopTool(),t&&this._updateEditingState()),t},this._saveWithoutAsk=function(){var t=$.Deferred(),e={};_.forEach(this._layers,function(t,i){t.editor.isDirty()&&(e[i]=t.editor)}),this._saveEdits(e).then(function(e){t.resolve()}).fail(function(e){t.reject()})},this._cancelOrSave=function(t){var e=$.Deferred();try{var i=1;t&&(i=t);var n=this,o={};_.forEach(this._layers,function(t,e){t.editor.isDirty()&&(o[e]=t.editor)}),_.keys(o).length?this._askCancelOrSave(i).then(function(t){"save"===t?n._saveEdits(o).then(function(t){e.resolve()}).fail(function(t){e.reject()}):"nosave"==t?e.resolve():"cancel"==t&&e.reject()}):e.resolve()}catch(s){e.reject()}return e.promise()},this._askCancelOrSave=function(t){var e=$.Deferred(),i={SAVE:{label:"Salva",className:"btn-success",callback:function(){e.resolve("save")}},NOSAVE:{label:"Termina senza salvare",className:"btn-danger",callback:function(){e.resolve("nosave")}},CANCEL:{label:"Annulla",className:"btn-primary",callback:function(){e.resolve("cancel")}}};switch(t){case 1:buttons={save:i.SAVE,nosave:i.NOSAVE,cancel:i.CANCEL};break;case 2:buttons={save:i.SAVE,cancel:i.CANCEL}}return a.dialog.dialog({message:"Vuoi salvare definitivamente le modifiche?",title:"Salvataggio modifica",buttons:buttons}),e.promise()},this._saveEdits=function(t){var e=this,i=$.Deferred();return this._sendEdits(t).then(function(n){a.notify.success("I dati sono stati salvati correttamente"),e._commitEdits(t,n),e._mapService.refreshMap(),i.resolve()}).fail(function(t){a.notify.error("Errore nel salvataggio sul server"),i.resolve()}),i.promise()},this._sendEdits=function(t){var e=$.Deferred(),i=_.map(t,function(t){return{layername:t.getVectorLayer().name,edits:t.getEditedFeatures()}});return this._postData(i).then(function(t){t.result?e.resolve(t.response):e.reject(t.response)}).fail(function(t){e.reject(t.response)}),e.promise()},this._commitEdits=function(t,e){_.forEach(t,function(t){e&&e["new"]&&_.forEach(e["new"],function(i){var n=i.clientid,o=i.id;t.getEditVectorLayer().setFeatureData(n,o,null,i),_.forEach(e.new_lockids,function(e){t.getVectorLayer().addLockId(e)})}),t.commit()})},this._undoEdits=function(t){var e=this._getCurrentEditingLayer().layerCode;t[e];this._stopEditing(!0)},this._updateEditingState=function(){var t=this._getCurrentEditingLayer();t?(this.state.editing.layerCode=t.layerCode,this.state.editing.toolType=t.editor.getActiveTool().getType()):(this.state.editing.layerCode=null,this.state.editing.toolType=null),this._updateToolStepsState()},this._updateToolStepsState=function(){var t,e=this,i=this._getCurrentEditingLayer();if(i&&(t=i.editor.getActiveTool()),t&&t.getTool()){var n=t.getTool();n.steps&&(this._setToolStepState(t),n.steps.on("step",function(i,n){e._setToolStepState(t)}),n.steps.on("complete",function(){e._setToolStepState()}))}else e._setToolStepState()},this._setToolStepState=function(t){var e,i,n;if(_.isUndefined(t))e=null,i=null,n=null;else{var o=t.getTool(),s=toolStepsMessages[t.getType()];e=o.steps.currentStepIndex(),i=o.steps.totalSteps(),n=s[e],_.isUndefined(n)&&(e=null,i=null,n=null)}this.state.editing.toolstep.n=e+1,this.state.editing.toolstep.total=i,this.state.editing.toolstep.message=n},this._getCurrentEditingLayer=function(){return this._currentEditingLayer},this._setCurrentEditingLayer=function(t){t?this._currentEditingLayer=t:this._currentEditingLayer=null},this._addToMap=function(){var t=this._mapService.viewer.map,i=this.getLayerCodes();_.forEach(i,function(i){e._layers[i].vector.addToMap(t)})},this._postData=function(t){var e=this;if(t.length>1)return this._postBatchData(t);var i=t[0].layername,n=t[0].edits,o=JSON.stringify(n);return $.post({url:this.config.baseurl+i+"/?"+e._customUrlParameters,data:o,contentType:"application/json"})},this._postBatchData=function(t){var e={};_.forEach(t,function(t){e[t.layername]=t.edits});var i=JSON.stringify(e);return $.post({url:this.config.baseurl,data:i,contentType:"application/json"})},this._unlock=function(){var t=this.getLayerCodes();_.map(t,function(t){return e._unlockLayer(e._layers[t])})},this._unlockLayer=function(t){$.get(this.config.baseurl+t.name+"/?unlock")},this.getLoader=function(){return this._loader}}var s=g3wsdk.core.utils.inherit,r=g3wsdk.core.G3WObject,a=g3wsdk.gui.GUI,l=g3wsdk.core.VectorLayerLoader,c=e("./editors/attributesform");s(o,r),i.exports=new o},{"./editors/attributesform":1}]},{},[3]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1aWxkLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIkdlb25vdGVGb3JtIiwib3B0aW9ucyIsImJhc2UiLCJ0aGlzIiwiX2Zvcm1QYW5lbCIsIkdlb25vdGVGb3JtUGFuZWwiLCJpbmhlcml0IiwiZzN3c2RrIiwiY29yZSIsInV0aWxzIiwiRm9ybVBhbmVsIiwiZ3VpIiwiRm9ybSIsImV4dGVuZCIsIjIiLCJHZW9ub3Rlc0VkaXRvciIsImZvcm1Ub29scyIsIlNhdmVFZGl0c1RvRGF0YWJhc2UiLCJQbHVnaW5TZXJ2aWNlIiwic2F2ZUVkaXRzIiwib25hZnRlciIsIkVkaXRvciIsIi4uL3BsdWdpbnNlcnZpY2UiLCIuL2F0dHJpYnV0ZXNmb3JtIiwiMyIsIlBsdWdpbiIsIkdVSSIsIlByb2plY3RzUmVnaXN0cnkiLCJwbHVnaW5Db25maWciLCJTZXJ2aWNlIiwiRWRpdGluZ1BhbmVsIiwiX1BsdWdpbiIsIm5hbWUiLCJjb25maWciLCJzZXJ2aWNlIiwiaW5pdCIsInNldFBsdWdpblNlcnZpY2UiLCJnZXRQbHVnaW5Db25maWciLCJzZXRVcEljb25VcmwiLCJsYXllcnMiLCJyZWdpc3RlclBsdWdpbiIsImdpZCIsInJlYWR5Iiwic2V0dXBHdWkiLCJvbiIsIl8iLCJiaW5kIiwiY3VzdG9tVXJsUGFyYW1ldGVycyIsImNyZWF0ZVBsdWdpbkN1c3RvbVVybFBhcmFtZXRlcnMiLCJ0b29sc0NvbXBvbmVudCIsImdldENvbXBvbmVudCIsInRvb2xzU2VydmljZSIsImdldFNlcnZpY2UiLCJ0b29scyIsImFkZFRvb2xzIiwidG9vbHNBY3Rpb25zIiwic2hvd0hpZGVMYXllciIsImNvbnNvbGUiLCJsb2ciLCJzaG93RWRpdGluZ1BhbmVsIiwicGFuZWwiLCJ0b2dnbGVFZGl0aW5nIiwic2hvd1BhbmVsIiwiY3VycmVudFByb2plY3QiLCJnZXRDdXJyZW50UHJvamVjdCIsImdldFR5cGUiLCJnZXRJZCIsImxheWVyc0NvbmZpZyIsImZvckVhY2giLCJsYXllckNvbmZpZyIsImljb251cmwiLCJzZXR1cFRvb2xzQWN0aW9uIiwidG9vbCIsInBsdWdpbiIsIi4vcGFuZWwiLCIuL3BsdWdpbnNlcnZpY2UiLCJwbHVnaW5jb25maWciLCI0IiwiNSIsIkVkaXRvclBhbmVsIiwiaWQiLCJpbnRlcm5hbFBhbmVsIiwiUGFuZWxDb21wb25lbnQiLCJyZXNvbHZlZFZhbHVlIiwicmVzb2x2ZSIsIlBhbmVsIiwiVnVlIiwidGVtcGxhdGUiLCJkYXRhIiwic3RhdGUiLCJyZXNvdXJjZXN1cmwiLCJnZXRSZXNvdXJjZXNVcmwiLCJlZGl0b3JzdG9vbGJhcnMiLCJsYXllcmNvZGUiLCJsYXllckNvZGVzIiwiR0VPTk9URVMiLCJ0aXRsZSIsInRvb2x0eXBlIiwiaWNvbiIsInNhdmVidG5sYWJlbCIsIm1ldGhvZHMiLCJ0b2dnbGVFZGl0VG9vbCIsImxheWVyQ29kZSIsInRvb2xUeXBlIiwiZWRpdGluZyIsImVkaXRpbmd0b29sYnRuVG9nZ2xlZCIsImVkaXRpbmd0b29sYnRuRW5hYmxlZCIsImNvbXB1dGVkIiwiZWRpdGluZ2J0bmxhYmVsIiwiZWRpdGluZ2J0bkVuYWJsZWQiLCJlbmFibGVkIiwibWVzc2FnZSIsInRvb2xzdGVwIiwidG90YWwiLCJzdGVwbWVzc2FnZSIsInByb3RvIiwicHJvdG90eXBlIiwib25TaG93IiwiY29udGFpbmVyIiwiJG1vdW50IiwiJGFwcGVuZFRvIiwib25DbG9zZSIsInNlbGYiLCJkZWZlcnJlZCIsIiQiLCJEZWZlcnJlZCIsInN0b3AiLCJ0aGVuIiwiJGRlc3Ryb3kiLCJmYWlsIiwicmVqZWN0IiwicHJvbWlzZSIsIi4vcGFuZWwuaHRtbCIsIjYiLCJ0eXBlIiwiYWN0aW9uIiwiZWRpdG9yQ2xhc3MiLCJ2ZWN0b3IiLCJlZGl0b3IiLCJjcnMiLCJzdHlsZSIsIm9sIiwiU3R5bGUiLCJpbWFnZSIsIkljb24iLCJhbmNob3IiLCJhbmNob3JYVW5pdHMiLCJhbmNob3JZVW5pdHMiLCJzcmMiLCJsYXllcnNDb2RlIiwiLi9lZGl0b3JzL2dlb25vdGVzZWRpdG9yIiwiNyIsIkdlb25vdGVzU2VydmljZSIsIl9tYXBTZXJ2aWNlIiwiX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIiLCJfY3VycmVudEVkaXRpbmdMYXllciIsInN0YXJ0aW5nRWRpdGluZ1Rvb2wiLCJyZXRyaWV2aW5nRGF0YSIsImhhc0VkaXRzIiwiX2xvYWRlciIsIlZlY3RvckxvYWRlckxheWVyIiwiZWRpdGluZ0NvbnN0cmFpbnRzIiwicmVzb2x1dGlvbiIsIl9jcnMiLCJfbGF5ZXJzIiwiX2VkaXRvckNsYXNzIiwiX2N1c3RvbVVybFBhcmFtZXRlcnMiLCJsYXllck5hbWUiLCJpbmZvdXJsIiwib3B0aW9uc19sb2FkZXIiLCJiYXNldXJsIiwibWFwU2VydmljZSIsImludGVyYWN0aW9uIiwiY3VycmVudEVkaXRpbmdMYXllciIsIl9nZXRDdXJyZW50RWRpdGluZ0xheWVyIiwiYWN0aXZlVG9vbCIsImdldEFjdGl2ZVRvb2wiLCJpbnN0YW5jZSIsIm93bnNJbnRlcmFjdGlvbiIsIl9zdG9wRWRpdGluZ1Rvb2wiLCJiYm94IiwiY2VudGVyIiwiZ2V0UmVzb2x1dGlvbiIsIkxheWVyIiwibGF5ZXJJZCIsImxheWVyIiwiZ2V0UHJvamVjdCIsImdldExheWVyQnlJZCIsImdldE9yaWdOYW1lIiwiX2NhbmNlbE9yU2F2ZSIsIl9zdG9wRWRpdGluZyIsIl9zdGFydEVkaXRpbmciLCJfc2F2ZVdpdGhvdXRBc2siLCJfc3RhcnRFZGl0aW5nVG9vbCIsImlzU3RhcnRlZCIsIl9zdG9wRWRpdG9yIiwiZ2V0TGF5ZXJDb2RlcyIsInZhbHVlcyIsIl9zZXRVcFZlY3RvckxheWVyIiwidmVjdG9yTGF5ZXIiLCJfc2V0VXBFZGl0b3IiLCJvcHRpb25zX2VkaXRvciIsImZvcm1DbGFzcyIsIkZvcm1DbGFzcyIsInNldFZlY3RvckxheWVyIiwiZGlydHkiLCJsb2FkTGF5ZXJzIiwidmVjdG9yTGF5ZXJzTG9hZGVkIiwiX2FkZFRvTWFwIiwiZW1pdCIsImxvYWRBbGxWZWN0b3JzRGF0YSIsIm5vdGlmeSIsImVycm9yIiwicmVzZXQiLCJ2aWV3ZXIiLCJyZW1vdmVMYXllckJ5TmFtZSIsIl91bmxvY2tMYXllciIsIl91cGRhdGVFZGl0aW5nU3RhdGUiLCJfY2xlYW5VcCIsImNsZWFuVXBMYXllcnMiLCJfc3RhcnRFZGl0b3IiLCJzdGFydCIsIl9zZXRDdXJyZW50RWRpdGluZ0xheWVyIiwiY2FuU3RhcnRUb29sIiwic2V0VG9vbCIsInJldCIsInN0b3BUb29sIiwiZGlydHlFZGl0b3JzIiwiaXNEaXJ0eSIsIl9zYXZlRWRpdHMiLCJyZXN1bHQiLCJfYXNrVHlwZSIsImtleXMiLCJfYXNrQ2FuY2VsT3JTYXZlIiwiYnV0dG9uVHlwZXMiLCJTQVZFIiwibGFiZWwiLCJjbGFzc05hbWUiLCJjYWxsYmFjayIsIk5PU0FWRSIsIkNBTkNFTCIsImJ1dHRvbnMiLCJzYXZlIiwibm9zYXZlIiwiY2FuY2VsIiwiZGlhbG9nIiwiX3NlbmRFZGl0cyIsInJlc3BvbnNlIiwic3VjY2VzcyIsIl9jb21taXRFZGl0cyIsInJlZnJlc2hNYXAiLCJlcnJvcnMiLCJlZGl0c1RvUHVzaCIsIm1hcCIsImxheWVybmFtZSIsImdldFZlY3RvckxheWVyIiwiZWRpdHMiLCJnZXRFZGl0ZWRGZWF0dXJlcyIsIl9wb3N0RGF0YSIsInJldHVybmVkIiwiZWRpdG9ycyIsInVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcyIsIm9sZGZpZCIsImNsaWVudGlkIiwiZmlkIiwiZ2V0RWRpdFZlY3RvckxheWVyIiwic2V0RmVhdHVyZURhdGEiLCJuZXdfbG9ja2lkcyIsIm5ld2xvY2tJZCIsImFkZExvY2tJZCIsImNvbW1pdCIsIl91bmRvRWRpdHMiLCJjdXJyZW50RWRpdGluZ0xheWVyQ29kZSIsIl91cGRhdGVUb29sU3RlcHNTdGF0ZSIsImdldFRvb2wiLCJ0b29sSW5zdGFuY2UiLCJzdGVwcyIsIl9zZXRUb29sU3RlcFN0YXRlIiwiaW5kZXgiLCJzdGVwIiwiaXNVbmRlZmluZWQiLCJtZXNzYWdlcyIsInRvb2xTdGVwc01lc3NhZ2VzIiwiY3VycmVudFN0ZXBJbmRleCIsInRvdGFsU3RlcHMiLCJhZGRUb01hcCIsIl9wb3N0QmF0Y2hEYXRhIiwianNvbkRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwicG9zdCIsInVybCIsImNvbnRlbnRUeXBlIiwibXVsdGlFZGl0c1RvUHVzaCIsIl91bmxvY2siLCJnZXQiLCJnZXRMb2FkZXIiLCJHM1dPYmplY3QiLCJWZWN0b3JMYXllckxvYWRlciIsIi4vZWRpdG9ycy9hdHRyaWJ1dGVzZm9ybSJdLCJtYXBwaW5ncyI6IkNBQUEsUUFBVUEsR0FBRUMsRUFBRUMsRUFBRUMsR0FBRyxRQUFTQyxHQUFFQyxFQUFFQyxHQUFHLElBQUlKLEVBQUVHLEdBQUcsQ0FBQyxJQUFJSixFQUFFSSxHQUFHLENBQUMsR0FBSUUsR0FBa0Isa0JBQVRDLFVBQXFCQSxPQUFRLEtBQUlGLEdBQUdDLEVBQUUsTUFBT0EsR0FBRUYsR0FBRSxFQUFJLElBQUdJLEVBQUUsTUFBT0EsR0FBRUosR0FBRSxFQUFJLElBQUlLLEdBQUUsR0FBSUMsT0FBTSx1QkFBdUJOLEVBQUUsSUFBSyxNQUFNSyxHQUFFRSxLQUFLLG1CQUFtQkYsRUFBRSxHQUFJRyxHQUFFWCxFQUFFRyxJQUFJUyxXQUFZYixHQUFFSSxHQUFHLEdBQUdVLEtBQUtGLEVBQUVDLFFBQVEsU0FBU2QsR0FBRyxHQUFJRSxHQUFFRCxFQUFFSSxHQUFHLEdBQUdMLEVBQUcsT0FBT0ksR0FBRUYsRUFBRUEsRUFBRUYsSUFBSWEsRUFBRUEsRUFBRUMsUUFBUWQsRUFBRUMsRUFBRUMsRUFBRUMsR0FBRyxNQUFPRCxHQUFFRyxHQUFHUyxRQUFrRCxJQUFJLEdBQTFDTCxHQUFrQixrQkFBVEQsVUFBcUJBLFFBQWdCSCxFQUFFLEVBQUVBLEVBQUVGLEVBQUVhLE9BQU9YLElBQUlELEVBQUVELEVBQUVFLEdBQUks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QUFLNEosU0F0cUJoQixHQUFJekosR0FBVUMsT0FBT0MsS0FBS0MsTUFBTUgsUUFDNUJtUyxFQUFZbFMsT0FBT0MsS0FBS2lTLFVBQ3hCL1EsRUFBTW5CLE9BQU9JLElBQUllLElBQ2pCc0ksRUFBb0J6SixPQUFPQyxLQUFLa1Msa0JBQ2hDL0YsRUFBWXROLEVBQVEsMkJBc3FCeEJpQixHQUFRa0osRUFBaUJpSixHQUN6QjFTLEVBQU9KLFFBQVUsR0FBSTZKLEtBQ2xCbUosMkJBQTJCLFNBQVMiLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgRm9ybVBhbmVsID0gZzN3c2RrLmd1aS5Gb3JtUGFuZWw7XG52YXIgRm9ybSA9IGczd3Nkay5ndWkuRm9ybTtcblxudmFyIEdlb25vdGVGb3JtUGFuZWwgPSBGb3JtUGFuZWwuZXh0ZW5kKHtcbiAgLy90ZW1wbGF0ZTogcmVxdWlyZSgnLi9hdHRyaWJ1dGVzZm9ybS5odG1sJylcbn0pO1xuXG5mdW5jdGlvbiBHZW9ub3RlRm9ybShvcHRpb25zKXtcbiAgYmFzZSh0aGlzLG9wdGlvbnMpO1xuICB0aGlzLl9mb3JtUGFuZWwgPSBHZW9ub3RlRm9ybVBhbmVsO1xufVxuaW5oZXJpdChHZW9ub3RlRm9ybSxGb3JtKTtcblxubW9kdWxlLmV4cG9ydHMgPSBHZW9ub3RlRm9ybTtcblxufSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgRWRpdG9yID0gZzN3c2RrLmNvcmUuRWRpdG9yO1xudmFyIFBsdWdpblNlcnZpY2UgPSByZXF1aXJlKCcuLi9wbHVnaW5zZXJ2aWNlJyk7XG52YXIgRm9ybSA9IHJlcXVpcmUoJy4vYXR0cmlidXRlc2Zvcm0nKTtcbnZhciBmb3JtID0gbnVsbDsgLy8gYnJ1dHRvIG1hIGRldm8gdGVuZXJsbyBlc3Rlcm5vIHNlbm7DsiBzaSBjcmVhIHVuIGNsaWNvIGRpIHJpZmVyaW1lbnRpIGNoZSBtYW5kYSBpbiBwYWxsYSBWdWVcblxuXG5mdW5jdGlvbiBHZW9ub3Rlc0VkaXRvcihvcHRpb25zKSB7XG5cbiAgLy8gaW4gcXVlc3RvIG1vZG8gcGFzc2lhbW8gaWwgbWFwc2VydmljZSBjb21lIGFyZ29tZW50byBhbCBzdXBlcmNsYXNzIChlZGl0b3IpXG4gIC8vIGRpIGl0ZXJuZXRlZGl0b3IgaW4gbW9kbyBkYSBhc3NlZ25hcmFlIGFuY2hlIGEgaXRlcm5ldGVkaXRvciBpbCBtYXBzZXJ2ZWljZSBjaGUgeHNlcnZpcsOgIGFkIGVzZW1waW8gYWQgYWdnaXVuZ2VyZVxuICAvLyBsJ2ludGVyYWN0aW9uIGFsbGEgbWFwcGEgcXVhbmRvIHZpZW5lIGNsaWNjYXRvIHN1IHVuIHRvb2xcbiAgb3B0aW9ucy5mb3JtVG9vbHMgPSBbXTtcbiAgYmFzZSh0aGlzLCBvcHRpb25zKTtcbiAgdmFyIFNhdmVFZGl0c1RvRGF0YWJhc2UgPSBmdW5jdGlvbigpIHtcbiAgICBQbHVnaW5TZXJ2aWNlLnNhdmVFZGl0cygpO1xuICB9O1xuICAvL3RoaXMuX3NhdmVFZGl0cyA9IF8uYmluZChQbHVnaW5TZXJ2aWNlLnNhdmVFZGl0cywgUGx1Z2luU2VydmljZSk7XG4gIC8vIGFwcmUgZm9ybSBhdHRyaWJ1dGkgcGVyIGkgIG5zZXJpbWVudG9cblxuICB0aGlzLm9uYWZ0ZXIoJ2FkZEZlYXR1cmUnLCBTYXZlRWRpdHNUb0RhdGFiYXNlKTtcbiAgdGhpcy5vbmFmdGVyKCdkZWxldGVGZWF0dXJlJywgU2F2ZUVkaXRzVG9EYXRhYmFzZSk7XG4gIHRoaXMub25hZnRlcignbW92ZUZlYXR1cmUnLCBTYXZlRWRpdHNUb0RhdGFiYXNlKTtcblxuICAvLyBhcHJlIGZvcm0gYXR0cmlidXRpIHBlciBpbnNlcmltZW50b1xufVxuXG5pbmhlcml0KEdlb25vdGVzRWRpdG9yLCBFZGl0b3IpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdlb25vdGVzRWRpdG9yO1xufSx7XCIuLi9wbHVnaW5zZXJ2aWNlXCI6NyxcIi4vYXR0cmlidXRlc2Zvcm1cIjoxfV0sMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vLyBTREsgLy8vXG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgUGx1Z2luID0gZzN3c2RrLmNvcmUuUGx1Z2luO1xudmFyIEdVSSA9IGczd3Nkay5ndWkuR1VJO1xudmFyIFByb2plY3RzUmVnaXN0cnkgPSBnM3dzZGsuY29yZS5Qcm9qZWN0c1JlZ2lzdHJ5O1xuLy8vIFBMVUdJTiAvL1xudmFyIHBsdWdpbkNvbmZpZyA9IHJlcXVpcmUoJ3BsdWdpbmNvbmZpZycpO1xudmFyIFNlcnZpY2UgPSByZXF1aXJlKCcuL3BsdWdpbnNlcnZpY2UnKTtcbnZhciBFZGl0aW5nUGFuZWwgPSByZXF1aXJlKCcuL3BhbmVsJyk7XG5cbnZhciBfUGx1Z2luID0gZnVuY3Rpb24oKSB7XG5cbiAgYmFzZSh0aGlzKTtcbiAgdGhpcy5uYW1lID0gJ25vdGVzJztcbiAgdGhpcy5jb25maWcgPSBudWxsO1xuICB0aGlzLnNlcnZpY2UgPSBudWxsO1xuICB0aGlzLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgLy9zZXR0byBpbCBzZXJ2aXppb1xuICAgIHRoaXMuc2V0UGx1Z2luU2VydmljZShTZXJ2aWNlKTtcbiAgICAvL3JlY3VwZXJvIGNvbmZpZ3VyYXppb25lIGRlbCBwbHVnaW5cbiAgICB0aGlzLmNvbmZpZyA9IHRoaXMuZ2V0UGx1Z2luQ29uZmlnKCk7XG4gICAgdGhpcy5zZXRVcEljb25VcmwodGhpcy5jb25maWcubGF5ZXJzKTtcbiAgICAvL3JlZ2l0cm8gaWwgcGx1Z2luXG4gICAgaWYgKHRoaXMucmVnaXN0ZXJQbHVnaW4odGhpcy5jb25maWcuZ2lkKSkge1xuICAgICAgaWYgKCFHVUkucmVhZHkpIHtcbiAgICAgICAgR1VJLm9uKCdyZWFkeScsIF8uYmluZCh0aGlzLnNldHVwR3VpLCB0aGlzKSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXR1cEd1aSgpO1xuICAgICAgfVxuICAgICAgLy9pbml6aWFsaXp6byBpbCBzZXJ2aXppby4gSWwgc2Vydml6aW8gw6ggbCdpc3RhbnphIGRlbGxhIGNsYXNzZSBzZXJ2aXppb1xuICAgICAgcGx1Z2luQ29uZmlnLmN1c3RvbVVybFBhcmFtZXRlcnMgPSB0aGlzLmNyZWF0ZVBsdWdpbkN1c3RvbVVybFBhcmFtZXRlcnMoKTtcbiAgICAgIHRoaXMuc2VydmljZS5pbml0KHRoaXMuY29uZmlnLCBwbHVnaW5Db25maWcpO1xuICAgIH1cbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIHVuYSB2b2x0YSBjaGUgbGEgR1VJIGhhIGVtZXNzbyBsJ2V2ZW50byAncmVhZHknXG4gIC8vIHNlcnZlIGEgbW9udGFyZSBpIGNvbXBvZW50aSBkZWwgcGx1Z2luIHN1bGxhIHNpZGViYXJcbiAgdGhpcy5zZXR1cEd1aSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0b29sc0NvbXBvbmVudCA9IEdVSS5nZXRDb21wb25lbnQoJ3Rvb2xzJyk7XG4gICAgdmFyIHRvb2xzU2VydmljZSA9IHRvb2xzQ29tcG9uZW50LmdldFNlcnZpY2UoKTtcbiAgICB2YXIgdG9vbHMgPSBwbHVnaW5Db25maWcudG9vbHModGhpcyk7XG4gICAgdG9vbHNTZXJ2aWNlLmFkZFRvb2xzKDEgLCdHRU9OT1RFUycsIHRvb2xzKVxuICB9O1xuICAvLyBhemlvbmkgY2hlIHNvbm8gbGVnYXRpIGFpIHRvb2xzXG4gIHRoaXMudG9vbHNBY3Rpb25zID0ge1xuICAgIHNob3dIaWRlTGF5ZXI6ICBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdzaG93SGlkZUxheWVyJyk7XG4gICAgfSxcbiAgICBzaG93RWRpdGluZ1BhbmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYW5lbCA9IG5ldyBFZGl0aW5nUGFuZWwoKTtcbiAgICAgIHRoaXMuc2VydmljZS50b2dnbGVFZGl0aW5nKCk7XG4gICAgICBHVUkuc2hvd1BhbmVsKHBhbmVsKTtcbiAgICB9XG4gIH07XG5cbiAgLy9zZXR1cFBsdWdpbkN1c3RvbVBhcmFtZXRlcnNcbiAgdGhpcy5jcmVhdGVQbHVnaW5DdXN0b21VcmxQYXJhbWV0ZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGN1c3RvbVVybFBhcmFtZXRlcnM9JyYnO1xuICAgIHZhciBjdXJyZW50UHJvamVjdCA9IFByb2plY3RzUmVnaXN0cnkuZ2V0Q3VycmVudFByb2plY3QoKTtcbiAgICBjdXN0b21VcmxQYXJhbWV0ZXJzKz0ncHJvamVjdF90eXBlPScrY3VycmVudFByb2plY3QuZ2V0VHlwZSgpKycmcHJvamVjdF9pZD0nK2N1cnJlbnRQcm9qZWN0LmdldElkKCk7XG4gICAgcmV0dXJuIGN1c3RvbVVybFBhcmFtZXRlcnNcbiAgfTtcbiAgLy8gc2V0dXAgaWNvblVybCBmb3IgTGF5ZXJcbiAgdGhpcy5zZXRVcEljb25VcmwgPSBmdW5jdGlvbihsYXllcnNDb25maWcpIHtcbiAgICBfLmZvckVhY2gobGF5ZXJzQ29uZmlnLCBmdW5jdGlvbihsYXllckNvbmZpZykge1xuICAgICAgcGx1Z2luQ29uZmlnLmxheWVyc1tsYXllckNvbmZpZy5uYW1lXS5pY29udXJsID0gbGF5ZXJDb25maWcuaWNvbnVybDtcbiAgICB9KVxuICB9O1xuXG4gIHRoaXMuc2V0dXBUb29sc0FjdGlvbiA9IGZ1bmN0aW9uKHRvb2xzKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIF8uZm9yRWFjaCh0b29scywgZnVuY3Rpb24odG9vbCl7XG4gICAgICAvL1RPRE9cbiAgICB9KVxuICB9XG59O1xuXG5pbmhlcml0KF9QbHVnaW4sIFBsdWdpbik7XG5cbihmdW5jdGlvbihwbHVnaW4pe1xuICBwbHVnaW4uaW5pdCgpO1xufSkobmV3IF9QbHVnaW4pO1xuXG5cblxuXG59LHtcIi4vcGFuZWxcIjo1LFwiLi9wbHVnaW5zZXJ2aWNlXCI6NyxcInBsdWdpbmNvbmZpZ1wiOjZ9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbm1vZHVsZS5leHBvcnRzID0gXCI8ZGl2IGNsYXNzPVxcXCJnM3ctaXRlcm5ldC1lZGl0aW5nLXBhbmVsXFxcIj5cXG4gIDx0ZW1wbGF0ZSB2LWZvcj1cXFwidG9vbGJhciBpbiBlZGl0b3JzdG9vbGJhcnNcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJwYW5lbCBwYW5lbC1wcmltYXJ5XFxcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJwYW5lbC1oZWFkaW5nXFxcIj5cXG4gICAgICAgIDxoMyBjbGFzcz1cXFwicGFuZWwtdGl0bGVcXFwiPnt7IHRvb2xiYXIubmFtZSB9fTwvaDM+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwicGFuZWwtYm9keVxcXCI+XFxuICAgICAgICA8dGVtcGxhdGUgdi1mb3I9XFxcInRvb2wgaW4gdG9vbGJhci50b29sc1xcXCI+XFxuICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImVkaXRidG5cXFwiIDpjbGFzcz1cXFwieydlbmFibGVkJyA6IChzdGF0ZS5lZGl0aW5nLm9uICYmIGVkaXRpbmd0b29sYnRuRW5hYmxlZCh0b29sKSksICd0b2dnbGVkJyA6IGVkaXRpbmd0b29sYnRuVG9nZ2xlZCh0b29sYmFyLmxheWVyY29kZSwgdG9vbC50b29sdHlwZSl9XFxcIj5cXG4gICAgICAgICAgICA8aW1nIGhlaWdodD1cXFwiMzBweFxcXCIgd2lkdGg9XFxcIjMwcHhcXFwiIEBjbGljaz1cXFwidG9nZ2xlRWRpdFRvb2wodG9vbGJhci5sYXllcmNvZGUsIHRvb2wudG9vbHR5cGUpXFxcIiA6YWx0Lm9uY2U9XFxcInRvb2wudGl0bGVcXFwiIDp0aXRsZS5vbmNlPVxcXCJ0b29sLnRpdGxlXFxcIiA6c3JjLm9uY2U9XFxcInJlc291cmNlc3VybCsnaW1hZ2VzLycrdG9vbC5pY29uXFxcIj48L2ltZz5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L3RlbXBsYXRlPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvdGVtcGxhdGU+XFxuICA8ZGl2IHYtc2hvdz1cXFwic3RhdGUucmV0cmlldmluZ0RhdGFcXFwiPlxcbiAgICA8IS0tPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1wcmltYXJ5XFxcIiB2LWRpc2FibGVkPVxcXCJlZGl0aW5nYnRuRW5hYmxlZFxcXCIgOmNsYXNzPVxcXCJ7J2J0bi1zdWNjZXNzJyA6IHN0YXRlLmVkaXRpbmdPbn1cXFwiIEBjbGljaz1cXFwidG9nZ2xlRWRpdGluZ1xcXCI+e3sgZWRpdGluZ2J0bmxhYmVsIH19PC9idXR0b24+LS0+XFxuICAgIDwhLS08YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRhbmdlclxcXCIgdi1kaXNhYmxlZD1cXFwiIXN0YXRlLmhhc0VkaXRzXFxcIiBAY2xpY2s9XFxcInNhdmVFZGl0c1xcXCI+e3sgc2F2ZWJ0bmxhYmVsIH19PC9idXR0b24+LS0+XFxuICAgIDxzcGFuPkNhcmljYW1lbnRvIERhdGkgLi4uIDwvc3Bhbj48aW1nIDpzcmM9XFxcInJlc291cmNlc3VybCArJ2ltYWdlcy9sb2FkZXIuc3ZnJ1xcXCI+XFxuICA8L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcIm1lc3NhZ2VcXFwiPlxcbiAgICB7e3sgbWVzc2FnZSB9fX1cXG4gIDwvZGl2PlxcbjwvZGl2PlxcblwiO1xuXG59LHt9XSw1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbnZhciByZXNvbHZlZFZhbHVlID0gZzN3c2RrLmNvcmUudXRpbHMucmVzb2x2ZTtcbnZhciBpbmhlcml0ID0gZzN3c2RrLmNvcmUudXRpbHMuaW5oZXJpdDtcbnZhciBHVUkgPSBnM3dzZGsuZ3VpLkdVSTtcbi8vIGJhc2UgY2xhc3MgUGFuZWxcbnZhciBQYW5lbCA9ICBnM3dzZGsuZ3VpLlBhbmVsO1xudmFyIFNlcnZpY2UgPSByZXF1aXJlKCcuL3BsdWdpbnNlcnZpY2UnKTtcblxudmFyIFBhbmVsQ29tcG9uZW50ID0gVnVlLmV4dGVuZCh7XG4gIHRlbXBsYXRlOiByZXF1aXJlKCcuL3BhbmVsLmh0bWwnKSxcbiAgZGF0YTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXRlOiBTZXJ2aWNlLnN0YXRlLFxuICAgICAgcmVzb3VyY2VzdXJsOiBHVUkuZ2V0UmVzb3VyY2VzVXJsKCksXG4gICAgICBlZGl0b3JzdG9vbGJhcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6IFwiR2Vvbm90ZXNcIixcbiAgICAgICAgICBsYXllcmNvZGU6IFNlcnZpY2UubGF5ZXJDb2Rlcy5HRU9OT1RFUyxcbiAgICAgICAgICB0b29sczpbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkFnZ2l1bmdpIEdlb25vdGFcIixcbiAgICAgICAgICAgICAgLy8gdG9vbHR5cGUgw6ggbCdhdHRyaWJ1dG8gY2hlIHNlcnZlciBwZXIgc2NlZ2xpZXJlIGlsIHRpcG8gZGkgdG9vbFxuICAgICAgICAgICAgICAvLyBkZWxsJ2VkaXRvciBnZW5lcmFsZSBjaGUgZG92csOgIGVzc2VyZSBpbXBvc3RhdG9cbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdhZGRmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRBZGRQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJTcG9zdGEgR2Vvbm90YVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ21vdmVmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRNb3ZlUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiUmltdW92aSBHZW9ub3RhXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnZGVsZXRlZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0RGVsZXRlUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiRWRpdGEgZ2Vvbm90YVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2VkaXRhdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2VkaXRBdHRyaWJ1dGVzLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICBzYXZlYnRubGFiZWw6IFwiU2FsdmFcIlxuICAgIH1cbiAgfSxcbiAgbWV0aG9kczoge1xuICAgIC8vbWV0b2RvIGNoaWFtYXRvIHF1YW5kbyBzaSBjbGljY2Egc3UgYXZ2aWEvdGVybWluYSBlZGl0aW5nXG4gICAgdG9nZ2xlRWRpdGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBTZXJ2aWNlLnRvZ2dsZUVkaXRpbmcoKTtcbiAgICB9LFxuICAgIHNhdmVFZGl0czogZnVuY3Rpb24oKXtcbiAgICAgIFNlcnZpY2Uuc2F2ZUVkaXRzKCk7XG4gICAgfSxcbiAgICAvLyBjaGFpbWF0byBxdWFuZG8gc2kgY2xpY2NhIHN1bCB1biB0b29sIGRlbGwnZWRpdG9yXG4gICAgLy8gY29tZSBhZCBlc2VtcGlvICBhZGQgbW92ZSBlZGl0IGF0dHJpYnV0ZXMgZXRjIC4uXG4gICAgdG9nZ2xlRWRpdFRvb2w6IGZ1bmN0aW9uKGxheWVyQ29kZSwgdG9vbFR5cGUpIHtcbiAgICAgIGlmICh0b29sVHlwZSA9PSAnJyl7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vdmVyaWZpY2Egc2UgbCdlZGl0b3Igw6ggaW4gZWRpdGluZyBvbiB0cnVlXG4gICAgICBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLm9uKSB7XG4gICAgICAgIFNlcnZpY2UudG9nZ2xlRWRpdFRvb2wobGF5ZXJDb2RlLCB0b29sVHlwZSk7XG4gICAgICB9XG4gICAgfSxcbiAgICAvLyBtZXRvZG8gY2hlIHZpZW5lIGNoaWFtYXRvIHBlciB2ZXJpZmljYXJlIGUgc2V0dGFyZVxuICAgIC8vIGxhIGNsYXNzZSAocHJlbXV0byBvIG5vIGRlbCBib3R0b25lIHRvb2wgaW4gcXVlc3Rpb25lKVxuICAgIGVkaXRpbmd0b29sYnRuVG9nZ2xlZDogZnVuY3Rpb24obGF5ZXJDb2RlLCB0b29sVHlwZSkge1xuICAgICAgcmV0dXJuICh0aGlzLnN0YXRlLmVkaXRpbmcubGF5ZXJDb2RlID09IGxheWVyQ29kZSAmJiB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbFR5cGUgPT0gdG9vbFR5cGUpO1xuICAgIH0sXG4gICAgLy8gZnVuemlvbmUgY2hlIHZlcmlmaWNhIHNlIGFiaWxpdGFyZSBvIG1lbm8gaSBib3R0b25pIGRlaSB0b29sc1xuICAgIGVkaXRpbmd0b29sYnRuRW5hYmxlZDogZnVuY3Rpb24odG9vbCl7XG4gICAgICByZXR1cm4gdG9vbC50b29sdHlwZSAhPSAnJztcbiAgICB9XG4gIH0sXG4gIGNvbXB1dGVkOiB7XG4gICAgZWRpdGluZ2J0bmxhYmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlLmVkaXRpbmcub24gPyBcIlRlcm1pbmEgZWRpdGluZ1wiIDogXCJBdnZpYSBlZGl0aW5nXCI7XG4gICAgfSxcbiAgICBlZGl0aW5nYnRuRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gKHRoaXMuc3RhdGUuZWRpdGluZy5lbmFibGVkIHx8IHRoaXMuc3RhdGUuZWRpdGluZy5vbikgPyBcIlwiIDogXCJkaXNhYmxlZFwiO1xuICAgIH0sXG4gICAgbWVzc2FnZTogZnVuY3Rpb24oKXtcbiAgICAgIHZhciBtZXNzYWdlID0gXCJcIjtcbiAgICAgIGlmICghdGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQpe1xuICAgICAgICBtZXNzYWdlID0gJzxzcGFuIHN0eWxlPVwiY29sb3I6IHJlZFwiPkF1bWVudGFyZSBpbCBsaXZlbGxvIGRpIHpvb20gcGVyIGFiaWxpdGFyZSBsXFwnZWRpdGluZyc7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAubWVzc2FnZSl7XG4gICAgICAgIHZhciBuID0gdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm47XG4gICAgICAgIHZhciB0b3RhbCA9IHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC50b3RhbDtcbiAgICAgICAgdmFyIHN0ZXBtZXNzYWdlID0gdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm1lc3NhZ2U7XG4gICAgICAgIG1lc3NhZ2UgPSAnPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6MjBweFwiPkdVSURBIFNUUlVNRU5UTzo8L2Rpdj4nICtcbiAgICAgICAgICAnPGRpdj48c3Bhbj5bJytuKycvJyt0b3RhbCsnXSA8L3NwYW4+PHNwYW4gc3R5bGU9XCJjb2xvcjogeWVsbG93XCI+JytzdGVwbWVzc2FnZSsnPC9zcGFuPjwvZGl2Pic7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBFZGl0b3JQYW5lbCgpIHtcbiAgLy8gcHJvcHJpZXTDoCBuZWNlc3NhcmllLiBJbiBmdXR1cm8gbGUgbWV0dGVybW8gaW4gdW5hXG4gIC8vIGNsYXNzZSBQYW5lbCBkYSBjdWkgZGVyaXZlcmFubm8gdHV0dGkgaSBwYW5uZWxsaSBjaGUgdm9nbGlvbm8gZXNzZXJlIG1vc3RyYXRpIG5lbGxhIHNpZGViYXJcbiAgdGhpcy5pZCA9IFwiaXRlcm5ldC1lZGl0aW5nLXBhbmVsXCI7XG4gIHRoaXMubmFtZSA9IFwiR2VzdGlvbmUgZGF0aSBJVEVSTkVUXCI7XG4gIHRoaXMuaW50ZXJuYWxQYW5lbCA9IG5ldyBQYW5lbENvbXBvbmVudCgpO1xufVxuXG5pbmhlcml0KEVkaXRvclBhbmVsLCBQYW5lbCk7XG5cbnZhciBwcm90byA9IFBhbmVsLnByb3RvdHlwZTtcblxuLy8gdmllbmUgcmljaGlhbWF0byBkYWxsYSB0b29sYmFyXG4vLyBxdWFuZG8gaWwgcGx1Z2luIGNoaWVkZSBkaSBtb3N0cmFyZSB1biBwcm9wcmlvIHBhbm5lbGxvIG5lbGxhIEdVSSAoR1VJLnNob3dQYW5lbClcbnByb3RvLm9uU2hvdyA9IGZ1bmN0aW9uKGNvbnRhaW5lcil7XG4gIHZhciBwYW5lbCA9IHRoaXMuaW50ZXJuYWxQYW5lbDtcbiAgcGFuZWwuJG1vdW50KCkuJGFwcGVuZFRvKGNvbnRhaW5lcik7XG4gIHJldHVybiByZXNvbHZlZFZhbHVlKHRydWUpO1xufTtcblxuLy8gcmljaGlhbWF0byBxdWFuZG8gbGEgR1VJIGNoaWVkZSBkaSBjaGl1ZGVyZSBpbCBwYW5uZWxsby4gU2Ugcml0b3JuYSBmYWxzZSBpbCBwYW5uZWxsbyBub24gdmllbmUgY2hpdXNvXG5wcm90by5vbkNsb3NlID0gZnVuY3Rpb24oKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gIFNlcnZpY2Uuc3RvcCgpXG4gIC50aGVuKGZ1bmN0aW9uKCl7XG4gICAgc2VsZi5pbnRlcm5hbFBhbmVsLiRkZXN0cm95KHRydWUpO1xuICAgIHNlbGYuaW50ZXJuYWxQYW5lbCA9IG51bGw7XG4gICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICB9KVxuICAuZmFpbChmdW5jdGlvbigpe1xuICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICB9KTtcbiAgXG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVkaXRvclBhbmVsO1xuXG59LHtcIi4vcGFuZWwuaHRtbFwiOjQsXCIuL3BsdWdpbnNlcnZpY2VcIjo3fV0sNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vL1F1aSBjaSBzb25vIGdsaSBlZGl0b3IgKGNsYXNzaSkgdXNhdGkgZGFpIHZhcmkgbGF5ZXJcbnZhciBHZW9ub3Rlc0VkaXRvciA9IHJlcXVpcmUoJy4vZWRpdG9ycy9nZW9ub3Rlc2VkaXRvcicpO1xuXG4vL2RlZmluaXNjbyBpIGNvZGljaSBsYXllclxudmFyIGxheWVyQ29kZXMgPSB0aGlzLmxheWVyQ29kZXMgPSB7XG4gICAgR0VPTk9URVM6ICdub3RlJ1xufTtcbi8vIGNsYXNzaSBlZGl0b3JcbnZhciBlZGl0b3JDbGFzcyA9IHt9O1xuZWRpdG9yQ2xhc3NbbGF5ZXJDb2Rlcy5HRU9OT1RFU10gPSBHZW9ub3Rlc0VkaXRvcjtcblxuLy9kZWZpbmlzY28gbGF5ZXIgZGVsIHBsdWdpbiBjb21lIG9nZ2V0dG9cbnZhciBsYXllcnMgPSB7fTtcbmxheWVyc1tsYXllckNvZGVzLkdFT05PVEVTXSA9IHtcbiAgbGF5ZXJDb2RlOiBsYXllckNvZGVzLkdFT05PVEVTLFxuICB2ZWN0b3I6IG51bGwsXG4gIGVkaXRvcjogbnVsbCxcbiAgaWNvbnVybDogJy9zdGF0aWMvaWNvbi5wbmcnLFxuICBjcnM6IG51bGwsXG4gIC8vZGVmaW5pc2NvIGxvIHN0aWxlXG4gIHN0eWxlOiBuZXcgb2wuc3R5bGUuU3R5bGUoe1xuICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuSWNvbigoe1xuICAgICAgYW5jaG9yOiBbMCwgMF0sXG4gICAgICBhbmNob3JYVW5pdHM6ICdwaXhlbHMnLFxuICAgICAgYW5jaG9yWVVuaXRzOiAncGl4ZWxzJyxcbiAgICAgIHNyYzogJy9zdGF0aWMvbm90ZXMvaW1nL3BsYWNlaG9sZGVyLTIwLnBuZydcbiAgICB9KSlcbiAgfSlcbn07XG4vLyBkZWZpbmlzY28gaSB0b29sc1xuZnVuY3Rpb24gdG9vbHMocGx1Z2luKSB7XG5cbiAgICByZXR1cm4gdG9vbHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiVmlzdWFsaXp6YSBHZW9ub3Rlc1wiLFxuICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgICAgICAgICAgIGFjdGlvbjogXy5iaW5kKHBsdWdpbi50b29sc0FjdGlvbnMuc2hvd0hpZGVMYXllciwgcGx1Z2luKVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIlN0cnVtZW50aSBHZW9ub3Rlc1wiLFxuICAgICAgICAgICAgYWN0aW9uOiBfLmJpbmQocGx1Z2luLnRvb2xzQWN0aW9ucy5zaG93RWRpdGluZ1BhbmVsLCBwbHVnaW4pXG4gICAgICAgIH1cbiAgICBdO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBsYXllcnNDb2RlOiBsYXllckNvZGVzLFxuICAgIGxheWVyczogbGF5ZXJzLFxuICAgIGVkaXRvckNsYXNzOiBlZGl0b3JDbGFzcyxcbiAgICB0b29sczogdG9vbHNcbn07XG5cbn0se1wiLi9lZGl0b3JzL2dlb25vdGVzZWRpdG9yXCI6Mn1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIEczV09iamVjdCA9IGczd3Nkay5jb3JlLkczV09iamVjdDtcbnZhciBHVUkgPSBnM3dzZGsuZ3VpLkdVSTtcbnZhciBWZWN0b3JMb2FkZXJMYXllciA9IGczd3Nkay5jb3JlLlZlY3RvckxheWVyTG9hZGVyO1xudmFyIEZvcm1DbGFzcyA9IHJlcXVpcmUoJy4vZWRpdG9ycy9hdHRyaWJ1dGVzZm9ybScpO1xuXG5mdW5jdGlvbiBHZW9ub3Rlc1NlcnZpY2UoKSB7XG5cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICAvL3F1aSB2YWRvICBhIHNldHRhcmUgaWwgbWFwc2VydmljZVxuICB0aGlzLl9tYXBTZXJ2aWNlID0gbnVsbDtcbiAgdGhpcy5fbG9hZERhdGFPbk1hcFZpZXdDaGFuZ2VMaXN0ZW5lciA9IG51bGw7XG4gIHRoaXMuX2N1cnJlbnRFZGl0aW5nTGF5ZXIgPSBudWxsO1xuXG4gIHRoaXMuc3RhdGUgPSB7XG4gICAgZWRpdGluZzoge1xuICAgICAgb246IGZhbHNlLFxuICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICBsYXllckNvZGU6IG51bGwsXG4gICAgICB0b29sVHlwZTogbnVsbCxcbiAgICAgIHN0YXJ0aW5nRWRpdGluZ1Rvb2w6IGZhbHNlLFxuICAgICAgdG9vbHN0ZXA6IHtcbiAgICAgICAgbjogbnVsbCxcbiAgICAgICAgdG90YWw6IG51bGwsXG4gICAgICAgIG1lc3NhZ2U6IG51bGxcbiAgICAgIH1cbiAgICB9LFxuICAgIHJldHJpZXZpbmdEYXRhOiBmYWxzZSxcbiAgICBoYXNFZGl0czogZmFsc2VcbiAgfTtcblxuICAvL2RlZmluaXNjbyBpbCBsb2FkZXIgZGVsIHBsdWdpblxuICB0aGlzLl9sb2FkZXIgPSBuZXcgVmVjdG9yTG9hZGVyTGF5ZXI7XG4gIC8vIHZpbmNvbGkgYWxsYSBwb3NzaWJpbGl0w6AgIGRpIGF0dGl2YXJlIGwnZWRpdGluZ1xuICB2YXIgZWRpdGluZ0NvbnN0cmFpbnRzID0ge1xuICAgIHJlc29sdXRpb246IDEgLy8gdmluY29sbyBkaSByaXNvbHV6aW9uZSBtYXNzaW1hXG4gIH07XG4gIC8vIGluaXppYWxpenphemlvbmUgZGVsIHBsdWdpblxuICAvLyBjaGlhbXRvIGRhbGwgJHNjcmlwdCh1cmwpIGRlbCBwbHVnaW4gcmVnaXN0cnlcbiAgdGhpcy5pbml0ID0gZnVuY3Rpb24oY29uZmlnLCBwbHVnaW5Db25maWcpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5fY3JzID0gbnVsbDtcbiAgICB0aGlzLl9sYXllcnMgPSBwbHVnaW5Db25maWcubGF5ZXJzO1xuICAgIHRoaXMuX2VkaXRvckNsYXNzID0gcGx1Z2luQ29uZmlnLmVkaXRvckNsYXNzO1xuICAgIHRoaXMubGF5ZXJDb2RlcyA9IHBsdWdpbkNvbmZpZy5sYXllcnNDb2RlO1xuICAgIHRoaXMuX2N1c3RvbVVybFBhcmFtZXRlcnMgPSBwbHVnaW5Db25maWcuY3VzdG9tVXJsUGFyYW1ldGVycyB8fCBudWxsO1xuICAgIC8vIHNldHRvIGlsIG1hcHNlcnZpY2UgY2hlIG1pIHBlcm1ldHRlIGRpIGluZXJhZ2lyZSBjb24gbGEgbWFwcGFcbiAgICB0aGlzLl9tYXBTZXJ2aWNlID0gR1VJLmdldENvbXBvbmVudCgnbWFwJykuZ2V0U2VydmljZSgpO1xuICAgIC8vdmFkbyBhIHNldHRhcmUgbGUgaWNvbiB1cmxzIGUgaWwgY3JzIHNlIGVzaXN0ZSBjaSBzb25vOlxuICAgIF8uZm9yRWFjaCh0aGlzLmNvbmZpZy5sYXllcnMsIGZ1bmN0aW9uKGxheWVyQ29uZmlnLCBsYXllck5hbWUgKSB7XG4gICAgICBzZWxmLl9sYXllcnNbbGF5ZXJOYW1lXS5pbmZvdXJsID0gbGF5ZXJDb25maWcuaW5mb3VybDtcbiAgICAgIHNlbGYuX2xheWVyc1tsYXllck5hbWVdLmNycyA9IFwiRVBTRzpcIitsYXllckNvbmZpZy5jcnM7XG4gICAgfSk7XG4gICAgLy9pbml6aWFsaXp6byBpbCBsb2FkZXJcbiAgICAvLyBwYXNzYW5kb2dsaTpcbiAgICAvLyAxIC0gbGF5ZXJzIGRlbCBwbHVnaW4gKHN0eWxlIGV0Yy4uKVxuICAgIC8vIDIgLSBsYSBiYXNldXJsIGNoZSBtaSBzZXJ2ZXIgcGVyIGludGVyYWdpcmUgY29uIGlsIHNlcnZlciBwZXIgZmFyZSB0dXR0ZSBsZSBtb2RpZmljaGVcbiAgICB2YXIgb3B0aW9uc19sb2FkZXIgPSB7XG4gICAgICAnbGF5ZXJzJzogdGhpcy5fbGF5ZXJzLFxuICAgICAgJ2Jhc2V1cmwnOiB0aGlzLmNvbmZpZy5iYXNldXJsLFxuICAgICAgJ21hcFNlcnZpY2UnOiB0aGlzLl9tYXBTZXJ2aWNlXG4gICAgfTtcbiAgICAvL2luaXppYWxpenpvIGlsIGxvYWRlclxuICAgIHRoaXMuX2xvYWRlci5pbml0KG9wdGlvbnNfbG9hZGVyKTtcbiAgICAvL2Nhc28gZGkgbG9hZGluZyBkYXRhXG4gICAgdGhpcy5fbG9hZGVyLm9uKCdsb2FkaW5ndmVjdG9ybGF5ZXJzc3RhcnQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuc3RhdGUucmV0cmlldmluZ0RhdGEgPSB0cnVlO1xuICAgIH0pO1xuICAgIHRoaXMuX2xvYWRlci5vbignbG9hZGluZ3ZlY3RvcmxheWVyc2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5zdGF0ZS5yZXRyaWV2aW5nRGF0YSA9IGZhbHNlO1xuICAgIH0pO1xuXG4gICAgLy8gZGlzYWJpbGl0byBsJ2V2ZW50dWFsZSB0b29sIGF0dGl2byBzZSB2aWVuZSBhdHRpdmF0YVxuICAgIC8vIHVuJ2ludGVyYXppb25lIGRpIHRpcG8gcG9pbnRlckludGVyYWN0aW9uU2V0IHN1bGxhIG1hcHBhXG4gICAgdGhpcy5fbWFwU2VydmljZS5vbigncG9pbnRlckludGVyYWN0aW9uU2V0JywgZnVuY3Rpb24oaW50ZXJhY3Rpb24pIHtcbiAgICAgIHZhciBjdXJyZW50RWRpdGluZ0xheWVyID0gc2VsZi5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIpIHtcbiAgICAgICAgdmFyIGFjdGl2ZVRvb2wgPSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuaW5zdGFuY2U7XG4gICAgICAgIC8vIGRldm8gdmVyaWZpY2FyZSBjaGUgbm9uIHNpYSB1bidpbnRlcmF6aW9uZSBhdHRpdmF0YSBkYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyBkZWwgcGx1Z2luXG4gICAgICAgIGlmIChhY3RpdmVUb29sICYmICFhY3RpdmVUb29sLm93bnNJbnRlcmFjdGlvbihpbnRlcmFjdGlvbikpIHtcbiAgICAgICAgICBzZWxmLl9zdG9wRWRpdGluZ1Rvb2woKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIC8vICBhYmlsaXRvIG8gbWVubyBsJ2VkaXRpbmcgaW4gYmFzZSBhbGxhIHJpc29sdXppb25lIGRlbGxhIG1hcHBhXG4gICAgdGhpcy5fbWFwU2VydmljZS5vbmFmdGVyKCdzZXRNYXBWaWV3JyxmdW5jdGlvbihiYm94LCByZXNvbHV0aW9uLCBjZW50ZXIpe1xuICAgICAgc2VsZi5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgPSAocmVzb2x1dGlvbiA8IGVkaXRpbmdDb25zdHJhaW50cy5yZXNvbHV0aW9uKSA/IHRydWUgOiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBhdHRyaWJ1dG8gZGVsbG8gc3RhdG8gZGVsIHNyZXZpemlvIGNoZSBtaSBwZXJtZXR0ZSBkaSBhY2NlbmRlcmUgbyBzcGVuZ2VyZSBsJ2VkaXRpbmdcbiAgICAvLyBzZXJ2ZSBhbmNoZSBwZXIgcG90ZXIgaW4gZmFzZSBkaSB0b2dnbGVFZGl0aW5nKGJvdHRvbmUgZGkgYXZ2aW8gZWRpdGluZykgZGkgdmVkZXJlIHNlIHBvc3NvIGluemlhcmUgbyBtZW5vXG4gICAgLy8gY2FyaWNhcmUgaSB2ZXR0b3JpYWxpIGV0Yy4uXG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgPSAodGhpcy5fbWFwU2VydmljZS5nZXRSZXNvbHV0aW9uKCkgPCBlZGl0aW5nQ29uc3RyYWludHMucmVzb2x1dGlvbikgPyB0cnVlIDogZmFsc2U7XG4gICAgLy8gcGVyIG9nbmkgbGF5ZXIgZGVmaW5pdGkgbmVsIHBsdWdpbiBzZXR0byBuYW1lIGUgaWRcbiAgICAvLyByZWN1cGVyYXRpIGdyYXppZSBhbCBtYXBzZXJ2aWNlXG4gICAgXy5mb3JFYWNoKHRoaXMuX2xheWVycywgZnVuY3Rpb24oTGF5ZXIsIGxheWVyQ29kZSkge1xuICAgICAgLy9yZWN1cGVybyBsJ2lkIGRhbGxhIGNvbmZpZ3VyYXppb25lIGRlbCBwbHVnaW5cbiAgICAgIC8vIGkgbGF5ZXJzIG5lbGxhIGNvbmZpZ3VyYXppb25lIHBhc3NhdGEgaSBsYXllcnMgaGFubm8gZHVlIGF0dHJpYnV0aTogaWQgZSBuYW1lXG4gICAgICB2YXIgbGF5ZXJJZCA9IGNvbmZpZy5sYXllcnNbbGF5ZXJDb2RlXS5pZDtcbiAgICAgIHZhciBsYXllck5hbWUgPSBjb25maWcubGF5ZXJzW2xheWVyQ29kZV0ubmFtZTtcbiAgICAgIC8vIHJlY3VwZXJhIGlsIGxheWVyIGRhbCBtYXBzZXJ2aWNlXG4gICAgICB2YXIgbGF5ZXIgPSBzZWxmLl9tYXBTZXJ2aWNlLmdldFByb2plY3QoKS5nZXRMYXllckJ5SWQobGF5ZXJJZCk7XG4gICAgICAvLyBtZXNzbyBhbCBtb21lbnRvIGdlbmVyaWNvIHBlciByaXByZW5kZXJlIHN0ZXNzbyBjb25tcG9ydGFtZW50byBJdGVybmV0XG4gICAgICBpZiAobGF5ZXIpIHtcbiAgICAgICAgLy8gcmVjdXBlcm8gbCdvcmlnaW4gbmFtZSBkYWwgcHJvamVjdGxheWVyXG4gICAgICAgIExheWVyLm5hbWUgPSBsYXllci5nZXRPcmlnTmFtZSgpO1xuICAgICAgICBMYXllci5pZCA9IGxheWVySWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBMYXllci5uYW1lID0gbGF5ZXJOYW1lO1xuICAgICAgICBMYXllci5pZCA9IGxheWVySWQ7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIC8vIGZpbmUgZGVsIG1ldG9kbyBJTklUXG5cbiAgLy9zdG9wXG4gIHRoaXMuc3RvcCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcub24pIHtcbiAgICAgIHRoaXMuX2NhbmNlbE9yU2F2ZSgpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuX3N0b3BFZGl0aW5nKCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbigpe1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgfSlcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG5cbiAgLy8gYXZ2aW8gbyB0ZXJtaW5vIGxhIHNlc3Npb25lIGRpIGVkaXRpbmcgZ2VuZXJhbGVcbiAgLy8gdW50byBkaSBwYXJ0ZW56YSBkZWxsJ2F2dmlvIGRlbGwnZWRpdGluZ1xuICB0aGlzLnRvZ2dsZUVkaXRpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBjcmVvIG9nZ2V0dG8gZGVmZXJyZWQgcGVyIHJlc3RpdHVpcmUgdW5hIHByb21pc2VcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgLy8gcXVpIGRpY2UgY2hlIHNlIG5lbCBjYXNvIGxhIHJpc29sdXppb25lIGRlbGxhIG1hcHBhIHZhIGJlbmUgKHN0YXRlLmVkaXRpbmcuZW5hYmxlZClcbiAgICAvLyBlIG5vbiDDqCBhbmNvcmEgc3RhdG8gYXR0aXZhdG8gbCdlZGl0aW5nXG4gICAgLy8gcXVpbmRpIGNhc28gcHJpbWEgdm9sdGFcbiAgICBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgJiYgIXRoaXMuc3RhdGUuZWRpdGluZy5vbikge1xuICAgICAgLy8gZmFjY2lvIHBhcnRpcmUgZWRpdGluZ1xuICAgICAgdGhpcy5fc3RhcnRFZGl0aW5nKCk7XG4gICAgfVxuICAgIC8vIGFsdHJpbWVudGkgc2Ugw6ggZ2nDoCBpbiBlZGl0aW5nIGNoaWFtbyBsbyBzdG9wIGRlbCBwbHVnaW5cbiAgICAvLyBjaGUgbm9uIMOoIGFsdHJvIGNoZSBsb3MgdG9wbyBkZWxsJ2VkaXRpbmdcbiAgICBlbHNlIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcub24pIHtcbiAgICAgIHJldHVybiB0aGlzLnN0b3AoKTtcbiAgICB9XG4gICAgLy8gcmVzdGl0dWlzY28gdW5hIHByb21lc3NhXG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcblxuICB0aGlzLnNhdmVFZGl0cyA9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy5fc2F2ZVdpdGhvdXRBc2soKTtcbiAgICAvL3RoaXMuX2NhbmNlbE9yU2F2ZSgyKTtcbiAgfTtcblxuICAvLyBhdnZpYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyB0cmEgcXVlbGxpIHN1cHBvcnRhdGkgZGEgRWRpdG9yIChhZGRmZWF0dXJlLCBlY2MuKVxuICAvLyBmdW56aW9uZSBkZWxsJ2VsZW1lbnRvIHBhbmVsIHZ1ZVxuICB0aGlzLnRvZ2dsZUVkaXRUb29sID0gZnVuY3Rpb24obGF5ZXJDb2RlLCB0b29sVHlwZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvL3ByZW5kbyBpbCBsYXllciBpbiBiYXNlIGFsIGNvZGljZSBwYXNzYXRvIGRhbGwgY29tcG9uZW50ZSB2dWVcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXTtcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIC8vcmVjdXByZXJvIGlsIGN1cnJlbnQgbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgdmFyIGN1cnJlbnRFZGl0aW5nTGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgICAvLyBzZSBzaSBzdGEgdXNhbmRvIHVuIHRvb2wgY2hlIHByZXZlZGUgbG8gc3Rlc3NvIGxheWVyIGluIGVkaXRhemlvbmVcbiAgICAgIGlmIChjdXJyZW50RWRpdGluZ0xheWVyICYmIGxheWVyQ29kZSA9PSBjdXJyZW50RWRpdGluZ0xheWVyLmxheWVyQ29kZSkge1xuICAgICAgICAvLyBlIGxvIHN0ZXNzbyB0b29sIGFsbG9yYSBkaXNhdHRpdm8gaWwgdG9vbCAoaW4gcXVhbnRvIMOoXG4gICAgICAgIC8vIHByZW11dG8gc3VsbG8gc3Rlc3NvIGJvdHRvbmUpXG4gICAgICAgIGlmICh0b29sVHlwZSA9PSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuZ2V0VHlwZSgpKSB7XG4gICAgICAgICAgLy8gc3Rlc3NvIHRpcG8gZGkgdG9vbCBxdWluZGkgc2kgw6ggdmVyaWZpY2F0byB1biB0b2dnbGUgbmVsIGJvdHRvbmVcbiAgICAgICAgICAvLyBhbGxvcmEgc3RpcHBvIGwnZWRpdGluZyBUb29sXG4gICAgICAgICAgdGhpcy5fc3RvcEVkaXRpbmdUb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWx0cmltZW50aSBhdHRpdm8gaWwgdG9vbCByaWNoaWVzdG9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy9zdG9wcG8gcHJldmVudGl2YW1lbnRlIGwnZWRpdGluZyB0b29sIGF0dGl2b1xuICAgICAgICAgIHRoaXMuX3N0b3BFZGl0aW5nVG9vbCgpO1xuICAgICAgICAgIC8vZmFjY2lvIHBhcnRpcmUgbCdlZGl0bmcgdG9vbCBwYXNzYW5kbyBjdXJyZW50IEVkaXRpbmcgTGF5ZXIgZSBpbCB0aXBvIGRpIHRvb2xcbiAgICAgICAgICB0aGlzLl9zdGFydEVkaXRpbmdUb29sKGN1cnJlbnRFZGl0aW5nTGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gYWx0cmltZW50aSBjYXNvIGluIGN1aSBub24gw6ggc3RhdG8gc2V0dGF0byBpbCBjdXJyZW50IGVkaXRpbmcgbGF5ZXIgb1xuICAgICAgICAvLyBpbCBsYXllciBjaGUgc2kgc3RhIGNlcmNhbmRvIGRpIGVkaXRhcmUgw6ggZGl2ZXJzbyBkYSBxdWVsbG8gaW4gZWRpdGluZyBpbiBwcmVjZWRlbnphXG4gICAgICAgIC8vIG5lbCBjYXNvIHNpYSBnacOgICBhdHRpdm8gdW4gZWRpdG9yIHZlcmlmaWNvIGRpIHBvdGVybG8gc3RvcHBhcmVcbiAgICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIgJiYgY3VycmVudEVkaXRpbmdMYXllci5lZGl0b3IuaXNTdGFydGVkKCkpIHtcbiAgICAgICAgICAvLyBzZSBsYSB0ZXJtaW5hemlvbmUgZGVsbCdlZGl0aW5nIHNhcsOgICBhbmRhdGEgYSBidW9uIGZpbmUsIHNldHRvIGlsIHRvb2xcbiAgICAgICAgICAvLyBwcm92byBhIHN0b3BwYXJlXG4gICAgICAgICAgdGhpcy5fY2FuY2VsT3JTYXZlKDIpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX3N0b3BFZGl0b3IoKSkge1xuICAgICAgICAgICAgICAgICAgc2VsZi5fc3RhcnRFZGl0aW5nVG9vbChsYXllciwgdG9vbFR5cGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vbmVsIGNhc28gc2lhIGxhIHByaW1hIHZvbHRhIGNoZSBpbnRlcmFnaXNjbyBjb24gdW4gdG9vbFxuICAgICAgICAgIC8vIGUgcXVpbmRpIG5vbiDDqCBzdGF0byBzZXR0YXRvIG5lc3N1biBsYXllciBpbiBlZGl0aW5nXG4gICAgICAgICAgdGhpcy5fc3RhcnRFZGl0aW5nVG9vbChsYXllciwgdG9vbFR5cGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vZnVuemlvbmUgY2hlIHJlc3RpdHVpc2NlIGwnYXJyYXkgZGVpIGNvZGljaSBkZWkgbGF5ZXJzXG4gIHRoaXMuZ2V0TGF5ZXJDb2RlcyA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIF8udmFsdWVzKHRoaXMubGF5ZXJDb2Rlcyk7XG4gIH07XG5cbiAgLyogTUVUT0RJIFBSSVZBVEkgKi9cbiAgLy8gZnVuemlvbmUgcGVyIHNldHRhcmUgaWwgdmVjdG9ybGF5ZXIgYWxsYSBwcm9yaWV0w6AgdmVjdG9yIGRlbCBsYXllclxuICB0aGlzLl9zZXRVcFZlY3RvckxheWVyID0gZnVuY3Rpb24obGF5ZXJDb2RlLCB2ZWN0b3JMYXllcikge1xuICAgIHRoaXMuX2xheWVyc1tsYXllckNvZGVdLnZlY3RvciA9IHZlY3RvckxheWVyO1xuICB9O1xuXG4gIC8vZnVuemlvbmUgY2hlIHBlcm1ldHRlIGRpIGZhcmUgaWwgc2V0dXAgZGVsbCdlZGl0b3IgZSBhc3NlZ2FucmxvIGFsIGxheWVyXG4gIHRoaXMuX3NldFVwRWRpdG9yID0gZnVuY3Rpb24obGF5ZXJDb2RlKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgLy9vcHRpb24gZWRpdG9yXG4gICAgdmFyIG9wdGlvbnNfZWRpdG9yID0ge1xuICAgICAgJ21hcFNlcnZpY2UnOiBzZWxmLl9tYXBTZXJ2aWNlLFxuICAgICAgJ2Zvcm1DbGFzcyc6IEZvcm1DbGFzc1xuICAgIH07XG4gICAgLy8gcHJlbmRvIGlsIHZlY3RvciBsYXllciBkZWwgbGF5ZXJcbiAgICB2YXIgdmVjdG9yTGF5ZXIgPSB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXS52ZWN0b3I7XG4gICAgLy9HRVNUSU9ORSBFIElOSVpJQUxJWlpBWklPTkUgREVMTCdFRElUT1IgUkVMQVRJVk8gQUwgTEFZRVIgVkVUVE9SSUFMRVxuICAgIC8vY3JlbyBsJ2lzdGFuemEgZGVsbCdlZGl0b3IgY2hlIGdlc3RpcsOgIGlsIGxheWVyXG4gICAgdmFyIGVkaXRvciA9IG5ldyBzZWxmLl9lZGl0b3JDbGFzc1tsYXllckNvZGVdKG9wdGlvbnNfZWRpdG9yKTtcbiAgICAvL3NldHRvIGlsIGxheWVyIHZldHRvcmlhbGUgYXNzb2NpYXRvIGFsbCdlZGl0b3JcbiAgICAvLyBlIGkgdGlwaSBkaSB0b29scyBhc3NvY2lhdGkgYWQgZXNzb1xuICAgIGVkaXRvci5zZXRWZWN0b3JMYXllcih2ZWN0b3JMYXllcik7XG4gICAgLy9lbWV0dGUgZXZlbnRvIGNoZSDDqCBzdGF0YSBnZW5lcmF0YSB1bmEgbW9kaWZpY2EgbGEgbGF5ZXJcbiAgICBlZGl0b3Iub24oXCJkaXJ0eVwiLCBmdW5jdGlvbiAoZGlydHkpIHtcbiAgICAgIHNlbGYuc3RhdGUuaGFzRWRpdHMgPSBkaXJ0eTtcbiAgICB9KTtcbiAgICAvL2Fzc2Vnbm8gbCdpc3RhbnphIGVkaXRvciBhbCBsYXllciB0cmFtaXRlIGxhIHByb3ByaWV0w6AgZWRpdG9yXG4gICAgdGhpcy5fbGF5ZXJzW2xheWVyQ29kZV0uZWRpdG9yID0gZWRpdG9yO1xuICAgIC8vLy8gRklORSBHRVNUSU9ORSBFRElUT1JcbiAgfTtcblxuICAvL2ZhIHBhcnRpcmUgbCdlZGl0aW5nXG4gIHRoaXMuX3N0YXJ0RWRpdGluZyA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIG1pIGFzc2ljdXJvIGNoZSBzZSBwZXIgcXVhbHNpc2kgbW90aXZvXG4gICAgLy8gZmFjY2lvIHVubyBzdGFyZWRpdGluZyBkaSB1biBlZGl0aW5nIGdpw6AgYXZ2aWF0b1xuICAgIC8vIHJpdG9ybm8gcGVyY2jDqCBobyBnacOgIHR1dHRvIChsbyBmYWNjaW8gcGVyIHNpY3VyZW5uemEgbm9uIHNpIHNhIG1haSlcbiAgICBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLm9uIHx8IHRoaXMuc3RhdGUucmV0cmlldmluZ0RhdGEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIC8vIGNoaWVkbyBhbCBsb2FkZXIgZGkgY2FyaWNhcmUgaSBkYXRpXG4gICAgdGhpcy5fbG9hZGVyLmxvYWRMYXllcnMoJ3cnLCB0aGlzLl9jdXN0b21VcmxQYXJhbWV0ZXJzKSAvLyBjYXJpY28gaSBsYXllciBpbiBtb2RhbGl0w6AgZWRpdGluZyAoc2NyaXR0dXJhKVxuICAgICAgICAudGhlbihmdW5jdGlvbih2ZWN0b3JMYXllcnNMb2FkZWQpIHtcbiAgICAgICAgICAvL3VuYSB2b2x0YSBjaGUgaWwgbG9hZGVyIGhhIGZpbml0byBkaSBjYXJpY2FyZSBpIGxheWVyIHZldHRvcmlhbGlcbiAgICAgICAgICAvL3F1ZXN0byBtaSByZXN0aXR1aXNjZSBpIGNvZGljZSBkZWkgbGF5ZXIgY2hlIHNvbm8gc3RhdGkgY2FyaWNhdGkoYXJyYXkpXG4gICAgICAgICAgXy5mb3JFYWNoKHZlY3RvckxheWVyc0xvYWRlZCwgZnVuY3Rpb24gKGxheWVyQ29kZSkge1xuICAgICAgICAgICAgLy8gcGVyIG9nbmkgbGF5ZXIgZmFjY2lvIGlsIHNldHVwIGRlbGwnZWRpdG9yXG4gICAgICAgICAgICBzZWxmLl9zZXRVcEVkaXRvcihsYXllckNvZGUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIHNlIHR1dHRvICDDqCBhbmRhdG8gYSBidW9uIGZpbmUgYWdnaXVuZ28gaSBWZWN0b3JMYXllciBhbGxhIG1hcHBhXG4gICAgICAgICAgc2VsZi5fYWRkVG9NYXAoKTtcbiAgICAgICAgICBzZWxmLnN0YXRlLmVkaXRpbmcub24gPSB0cnVlO1xuICAgICAgICAgIHNlbGYuZW1pdChcImVkaXRpbmdzdGFydGVkXCIpO1xuICAgICAgICAgIGlmICghc2VsZi5fbG9hZERhdGFPbk1hcFZpZXdDaGFuZ2VMaXN0ZW5lcikge1xuICAgICAgICAgICAgLy92aWVuZSByaXRvcm5hdGEgbGEgbGlzdGVuZXIga2V5XG4gICAgICAgICAgICBzZWxmLl9sb2FkRGF0YU9uTWFwVmlld0NoYW5nZUxpc3RlbmVyID0gc2VsZi5fbWFwU2VydmljZS5vbmFmdGVyKCdzZXRNYXBWaWV3JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmIChzZWxmLnN0YXRlLmVkaXRpbmcub24gJiYgc2VsZi5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQpe1xuICAgICAgICAgICAgICAgIHNlbGYuX2xvYWRlci5sb2FkQWxsVmVjdG9yc0RhdGEoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpe1xuICAgICAgICAgIEdVSS5ub3RpZnkuZXJyb3IodCgnY291bGRfbm90X2xvYWRfdmVjdG9yX2xheWVycycpKTtcbiAgICAgICAgfSlcbiAgfTtcblxuICB0aGlzLl9zdG9wRWRpdGluZyA9IGZ1bmN0aW9uKHJlc2V0KXtcbiAgICAvLyBzZSBwb3NzbyBzdG9wcGFyZSB0dXR0aSBnbGkgZWRpdG9yLi4uXG4gICAgaWYgKHRoaXMuX3N0b3BFZGl0b3IocmVzZXQpKXtcbiAgICAgIF8uZm9yRWFjaCh0aGlzLl9sYXllcnMsIGZ1bmN0aW9uKGxheWVyLCBsYXllckNvZGUpe1xuICAgICAgICB2YXIgdmVjdG9yID0gbGF5ZXIudmVjdG9yO1xuICAgICAgICBzZWxmLl9tYXBTZXJ2aWNlLnZpZXdlci5yZW1vdmVMYXllckJ5TmFtZSh2ZWN0b3IubmFtZSk7XG4gICAgICAgIGxheWVyLnZlY3Rvcj0gbnVsbDtcbiAgICAgICAgbGF5ZXIuZWRpdG9yPSBudWxsO1xuICAgICAgICBzZWxmLl91bmxvY2tMYXllcihzZWxmLl9sYXllcnNbbGF5ZXJDb2RlXSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3VwZGF0ZUVkaXRpbmdTdGF0ZSgpO1xuICAgICAgc2VsZi5zdGF0ZS5lZGl0aW5nLm9uID0gZmFsc2U7XG4gICAgICBzZWxmLl9jbGVhblVwKCk7XG4gICAgICBzZWxmLmVtaXQoXCJlZGl0aW5nc3RvcHBlZFwiKTtcbiAgICB9XG4gIH07XG5cbiAgdGhpcy5fY2xlYW5VcCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vdmFkbyBhZCBhbm51bGFyZSBsJ2VzdGVuemlvbmUgZGVsIGxvYWRlciBwZXIgcG90ZXIgcmljYXJpY2FyZSBpIGRhdGkgdmV0dHRvcmlhbGlcbiAgICAvL2RhIHJpdmVkZXJlO1xuICAgIHRoaXMuX2xvYWRlci5jbGVhblVwTGF5ZXJzKCk7XG5cbiAgfTtcbiAgLy9zZSBub24gw6ggYW5jb3JhIHBhcnRpdG8gZmFjY2lvIHBhcnRpcmUgbG8gc3RhcnQgZWRpdG9yXG4gIHRoaXMuX3N0YXJ0RWRpdG9yID0gZnVuY3Rpb24obGF5ZXIpe1xuICAgIC8vIGF2dmlvIGwnZWRpdG9yXG4gICAgLy8gcGFzc2FuZG9saSBpbCBzZXJ2aWNlIGNoZSBsbyBhY2NldHRhXG4gICAgaWYgKGxheWVyLmVkaXRvci5zdGFydCh0aGlzKSkge1xuICAgICAgLy8gcmVnaXN0cm8gaWwgY3VycmVudCBsYXllciBpbiBlZGl0aW5nXG4gICAgICB0aGlzLl9zZXRDdXJyZW50RWRpdGluZ0xheWVyKGxheWVyKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIC8vZnVuemlvbmUgY2hlIHZpZW5lIGNoaWFtYXRhIGFsIGNsaWNrIHN1IHVuIHRvb2wgZGVsbCdlZGl0aW5nIGUgc2VcbiAgLy9ub24gw6ggc3RhdG8gYXNzZWduYXRvIGFuY29yYSBuZXNzdW4gbGF5ZXIgY29tZSBjdXJyZW50IGxheWVyIGVkaXRpbmdcbiAgdGhpcy5fc3RhcnRFZGl0aW5nVG9vbCA9IGZ1bmN0aW9uKGxheWVyLCB0b29sVHlwZSwgb3B0aW9ucykge1xuICAgIC8vYXNzZWdubyB0cnVlIGFsbG8gc3RhcnRFZGl0aW5nVG9vbCBhdHRyaWJ1dG8gZGVsbGxvIHN0YXRlXG4gICAgdGhpcy5zdGF0ZS5zdGFydGluZ0VkaXRpbmdUb29sID0gdHJ1ZTtcbiAgICB2YXIgY2FuU3RhcnRUb29sID0gdHJ1ZTtcbiAgICAvL3ZlcmlmaWNvIHNlIGwnZWRpdG9yIMOoIHBhcnRpdG8gbyBtZW5vXG4gICAgaWYgKCFsYXllci5lZGl0b3IuaXNTdGFydGVkKCkpIHtcbiAgICAgIC8vc2Ugbm9uIMOoIGFuY29yYSBwYXJ0aXRvIGxvIGZhY2NpbyBwYXJ0aXJlIGUgbmUgcHJlbmRvIGlsIHJpc3VsdGF0b1xuICAgICAgLy8gdHJ1ZSBvIGZhbHNlXG4gICAgICBjYW5TdGFydFRvb2wgPSB0aGlzLl9zdGFydEVkaXRvcihsYXllcik7XG4gICAgfVxuICAgIC8vIHZlcmlmaWNhIHNlIGlsIHRvb2wgcHXDsiBlc3NlcmUgYXR0aXZhdG9cbiAgICAvLyBsJ2VkaXRvciB2ZXJpZmljYSBzZSBpbCB0b29sIHJpY2hpZXN0byDDqCBjb21wYXRpYmlsZVxuICAgIC8vIGNvbiBpIHRvb2xzIHByZXZpc3RpIGRhbGwnZWRpdG9yLiBDcmVhIGlzdGFuemEgZGkgdG9vbCBlIGF2dmlhIGlsIHRvb2xcbiAgICAvLyBhdHRyYXZlcnNvIGlsIG1ldG9kbyBydW5cbiAgICBpZiAoY2FuU3RhcnRUb29sICYmIGxheWVyLmVkaXRvci5zZXRUb29sKHRvb2xUeXBlLCBvcHRpb25zKSkge1xuICAgICAgdGhpcy5fdXBkYXRlRWRpdGluZ1N0YXRlKCk7XG4gICAgICB0aGlzLnN0YXRlLnN0YXJ0aW5nRWRpdGluZ1Rvb2wgPSBmYWxzZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB0aGlzLnN0YXRlLnN0YXJ0aW5nRWRpdGluZ1Rvb2wgPSBmYWxzZTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgdGhpcy5fc3RvcEVkaXRvciA9IGZ1bmN0aW9uKHJlc2V0KXtcbiAgICB2YXIgcmV0ID0gdHJ1ZTtcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgaWYgKGxheWVyKSB7XG4gICAgICByZXQgPSBsYXllci5lZGl0b3Iuc3RvcChyZXNldCk7XG4gICAgICBpZiAocmV0KXtcbiAgICAgICAgdGhpcy5fc2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9O1xuICAvLyBmdW56aW9uZSBjaGUgc2kgb2NjdXBhIGRpIGludGVycm9tZXBlcmUgbCdlZHRpbmcgdG9vbFxuICB0aGlzLl9zdG9wRWRpdGluZ1Rvb2wgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmV0ID0gdHJ1ZTtcbiAgICAvLyByZWN1cGVyZSBpbCBsYXllciBpbiBjdXJyZW50IGVkaXRpbmdcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgLy8gc2UgZXNpc3RlIGVkIGVyYSBzdGF0byBzZXR0YXRvXG4gICAgaWYgKGxheWVyKSB7XG4gICAgICAvLyBzZSBhbmRhdG8gYmVuZSByaXRvcm5hIHRydWVcbiAgICAgIHJldCA9IGxheWVyLmVkaXRvci5zdG9wVG9vbCgpO1xuICAgICAgaWYgKHJldCkge1xuICAgICAgICB0aGlzLl91cGRhdGVFZGl0aW5nU3RhdGUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIGFjY2V0dGEgY29tZSBwYXJhbWV0cm8gaWwgdGlwbyBkaVxuICAvLyBvcGVyYXppb25lIGRhIGZhcmUgYSBzZWNvbmRhIGRpY29zYSDDqCBhdnZlbnV0b1xuICB0aGlzLl9zYXZlV2l0aG91dEFzayA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICB2YXIgZGlydHlFZGl0b3JzID0ge307XG4gICAgLy8gdmVyaWZpY28gcGVyIG9nbmkgbGF5ZXIgc2UgbCdlZGl0byBhc3NvY2lhdG8gw6ggRGlydHlcbiAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihsYXllciwgbGF5ZXJDb2RlKSB7XG4gICAgICBpZiAobGF5ZXIuZWRpdG9yLmlzRGlydHkoKSkge1xuICAgICAgICBkaXJ0eUVkaXRvcnNbbGF5ZXJDb2RlXSA9IGxheWVyLmVkaXRvcjtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLl9zYXZlRWRpdHMoZGlydHlFZGl0b3JzKS5cbiAgICB0aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfSkuZmFpbChmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgfSlcblxuICB9O1xuICB0aGlzLl9jYW5jZWxPclNhdmUgPSBmdW5jdGlvbih0eXBlKXtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgLy8gcGVyIHNpY3VyZXp6YSB0ZW5nbyB0dXR0byBkZW50cm8gdW4gZ3Jvc3NvIHRyeS9jYXRjaCxcbiAgICAvLyBwZXIgbm9uIHJpc2NoaWFyZSBkaSBwcm92b2NhcmUgaW5jb25zaXN0ZW56ZSBuZWkgZGF0aSBkdXJhbnRlIGlsIHNhbHZhdGFnZ2lvXG4gICAgdHJ5IHtcbiAgICAgIHZhciBfYXNrVHlwZSA9IDE7XG4gICAgICBpZiAodHlwZSkge1xuICAgICAgICBfYXNrVHlwZSA9IHR5cGVcbiAgICAgIH1cbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHZhciBjaG9pY2UgPSBcImNhbmNlbFwiO1xuICAgICAgdmFyIGRpcnR5RWRpdG9ycyA9IHt9O1xuICAgICAgLy8gdmVyaWZpY28gcGVyIG9nbmkgbGF5ZXIgc2UgbCdlZGl0byBhc3NvY2lhdG8gw6ggRGlydHlcbiAgICAgIF8uZm9yRWFjaCh0aGlzLl9sYXllcnMsIGZ1bmN0aW9uKGxheWVyLCBsYXllckNvZGUpIHtcbiAgICAgICAgaWYgKGxheWVyLmVkaXRvci5pc0RpcnR5KCkpIHtcbiAgICAgICAgICBkaXJ0eUVkaXRvcnNbbGF5ZXJDb2RlXSA9IGxheWVyLmVkaXRvcjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvLyB2ZXJpZmljbyBzZSBjaSBzb25vIG8gbWVubyBlZGl0b3Igc3BvcmNoaVxuICAgICAgaWYoXy5rZXlzKGRpcnR5RWRpdG9ycykubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX2Fza0NhbmNlbE9yU2F2ZShfYXNrVHlwZSkuXG4gICAgICAgIHRoZW4oZnVuY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgICAgLy8gcml0b3JuYSBpbCB0aXBvIGRpIGF6aW9uZSBkYSBmYXJlXG4gICAgICAgICAgLy8gc2F2ZSwgY2FuY2VsLCBub3NhdmVcbiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnc2F2ZScpIHtcbiAgICAgICAgICAgIC8vIHBhc3NvIGdsaSBlZGl0b3Igc3BvY2hpIGFsbGEgZnVuemlvbmUgX3NhdmVFZGl0c1xuICAgICAgICAgICAgc2VsZi5fc2F2ZUVkaXRzKGRpcnR5RWRpdG9ycykuXG4gICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09ICdub3NhdmUnKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT0gJ2NhbmNlbCcpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIGluIGJhc2UgYWwgdGlwbyBkaSBhc2tUeXBlXG4gIC8vIHZpc3VhbGl6emEgaWwgbW9kYWxlIGEgY3VpIHJpc3BvbmRlcmUsIHNhbHZhIGV0YyAuLlxuICB0aGlzLl9hc2tDYW5jZWxPclNhdmUgPSBmdW5jdGlvbih0eXBlKXtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgdmFyIGJ1dHRvblR5cGVzID0ge1xuICAgICAgU0FWRToge1xuICAgICAgICBsYWJlbDogXCJTYWx2YVwiLFxuICAgICAgICBjbGFzc05hbWU6IFwiYnRuLXN1Y2Nlc3NcIixcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnc2F2ZScpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgTk9TQVZFOiB7XG4gICAgICAgIGxhYmVsOiBcIlRlcm1pbmEgc2VuemEgc2FsdmFyZVwiLFxuICAgICAgICBjbGFzc05hbWU6IFwiYnRuLWRhbmdlclwiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdub3NhdmUnKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIENBTkNFTDoge1xuICAgICAgICBsYWJlbDogXCJBbm51bGxhXCIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJidG4tcHJpbWFyeVwiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdjYW5jZWwnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgc3dpdGNoICh0eXBlKXtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgYnV0dG9ucyA9IHtcbiAgICAgICAgICBzYXZlOiBidXR0b25UeXBlcy5TQVZFLFxuICAgICAgICAgIG5vc2F2ZTogYnV0dG9uVHlwZXMuTk9TQVZFLFxuICAgICAgICAgIGNhbmNlbDogYnV0dG9uVHlwZXMuQ0FOQ0VMXG4gICAgICAgIH07XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBidXR0b25zID0ge1xuICAgICAgICAgIHNhdmU6IGJ1dHRvblR5cGVzLlNBVkUsXG4gICAgICAgICAgY2FuY2VsOiBidXR0b25UeXBlcy5DQU5DRUxcbiAgICAgICAgfTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIEdVSS5kaWFsb2cuZGlhbG9nKHtcbiAgICAgIG1lc3NhZ2U6IFwiVnVvaSBzYWx2YXJlIGRlZmluaXRpdmFtZW50ZSBsZSBtb2RpZmljaGU/XCIsXG4gICAgICB0aXRsZTogXCJTYWx2YXRhZ2dpbyBtb2RpZmljYVwiLFxuICAgICAgYnV0dG9uczogYnV0dG9uc1xuICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBzYWx2YSBpIGRhdGkgcmVsYXRpdmkgYWwgbGF5ZXIgdmV0dG9yaWFsZVxuICAvLyBkZWwgZGlydHlFZGl0b3JcbiAgdGhpcy5fc2F2ZUVkaXRzID0gZnVuY3Rpb24oZGlydHlFZGl0b3JzKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICB0aGlzLl9zZW5kRWRpdHMoZGlydHlFZGl0b3JzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgR1VJLm5vdGlmeS5zdWNjZXNzKFwiSSBkYXRpIHNvbm8gc3RhdGkgc2FsdmF0aSBjb3JyZXR0YW1lbnRlXCIpO1xuICAgICAgICAgIHNlbGYuX2NvbW1pdEVkaXRzKGRpcnR5RWRpdG9ycywgcmVzcG9uc2UpO1xuICAgICAgICAgIHNlbGYuX21hcFNlcnZpY2UucmVmcmVzaE1hcCgpO1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3JzKXtcbiAgICAgICAgICBHVUkubm90aWZ5LmVycm9yKFwiRXJyb3JlIG5lbCBzYWx2YXRhZ2dpbyBzdWwgc2VydmVyXCIpO1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIHByZW5kZSBjb21lIGluZ3Jlc3NvIGdsaSBlZGl0b3Igc3BvcmNoaVxuICB0aGlzLl9zZW5kRWRpdHMgPSBmdW5jdGlvbihkaXJ0eUVkaXRvcnMpIHtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgdmFyIGVkaXRzVG9QdXNoID0gXy5tYXAoZGlydHlFZGl0b3JzLCBmdW5jdGlvbihlZGl0b3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxheWVybmFtZTogZWRpdG9yLmdldFZlY3RvckxheWVyKCkubmFtZSxcbiAgICAgICAgZWRpdHM6IGVkaXRvci5nZXRFZGl0ZWRGZWF0dXJlcygpXG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gZXNlZ3VlIGlsIHBvc3QgZGVpIGRhdGlcbiAgICB0aGlzLl9wb3N0RGF0YShlZGl0c1RvUHVzaClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmV0dXJuZWQpe1xuICAgICAgICAgIGlmIChyZXR1cm5lZC5yZXN1bHQpe1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXR1cm5lZC5yZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJldHVybmVkLnJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKHJldHVybmVkKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmV0dXJuZWQucmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xuICB9O1xuXG4gIHRoaXMuX2NvbW1pdEVkaXRzID0gZnVuY3Rpb24oZWRpdG9ycyxyZXNwb25zZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIF8uZm9yRWFjaChlZGl0b3JzLGZ1bmN0aW9uKGVkaXRvcil7XG4gICAgICB2YXIgbmV3QXR0cmlidXRlc0Zyb21TZXJ2ZXIgPSBudWxsO1xuICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLm5ldyl7XG4gICAgICAgIF8uZm9yRWFjaChyZXNwb25zZS5uZXcsIGZ1bmN0aW9uKHVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcyl7XG4gICAgICAgICAgdmFyIG9sZGZpZCA9IHVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcy5jbGllbnRpZDtcbiAgICAgICAgICB2YXIgZmlkID0gdXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzLmlkO1xuICAgICAgICAgIGVkaXRvci5nZXRFZGl0VmVjdG9yTGF5ZXIoKS5zZXRGZWF0dXJlRGF0YShvbGRmaWQsZmlkLG51bGwsdXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzKTtcbiAgICAgICAgICBfLmZvckVhY2gocmVzcG9uc2UubmV3X2xvY2tpZHMsIGZ1bmN0aW9uKG5ld2xvY2tJZCl7XG4gICAgICAgICAgICBlZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKS5hZGRMb2NrSWQobmV3bG9ja0lkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIGVkaXRvci5jb21taXQoKTtcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLl91bmRvRWRpdHMgPSBmdW5jdGlvbihkaXJ0eUVkaXRvcnMpe1xuICAgIHZhciBjdXJyZW50RWRpdGluZ0xheWVyQ29kZSA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKS5sYXllckNvZGU7XG4gICAgdmFyIGVkaXRvciA9IGRpcnR5RWRpdG9yc1tjdXJyZW50RWRpdGluZ0xheWVyQ29kZV07XG4gICAgdGhpcy5fc3RvcEVkaXRpbmcodHJ1ZSk7XG4gIH07XG4gIC8vIGVzZWd1ZSBsJ3VwZGF0ZSBkZWxsbyBzdGF0ZSBuZWwgY2FzbyBhZCBlc2VtcGlvIGRpIHVuIHRvZ2dsZSBkZWwgYm90dG9uZSB0b29sXG4gIHRoaXMuX3VwZGF0ZUVkaXRpbmdTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIHByZW5kZSBpbCBsYXllciBpbiBFZGl0aW5nXG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIGlmIChsYXllcikge1xuICAgICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmxheWVyQ29kZSA9IGxheWVyLmxheWVyQ29kZTtcbiAgICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sVHlwZSA9IGxheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuZ2V0VHlwZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdGUuZWRpdGluZy5sYXllckNvZGUgPSBudWxsO1xuICAgICAgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xUeXBlID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5fdXBkYXRlVG9vbFN0ZXBzU3RhdGUoKTtcbiAgfTtcblxuICB0aGlzLl91cGRhdGVUb29sU3RlcHNTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgdmFyIGFjdGl2ZVRvb2w7XG4gICAgaWYgKGxheWVyKSB7XG4gICAgICBhY3RpdmVUb29sID0gbGF5ZXIuZWRpdG9yLmdldEFjdGl2ZVRvb2woKTtcbiAgICB9XG4gICAgaWYgKGFjdGl2ZVRvb2wgJiYgYWN0aXZlVG9vbC5nZXRUb29sKCkpIHtcbiAgICAgIHZhciB0b29sSW5zdGFuY2UgPSBhY3RpdmVUb29sLmdldFRvb2woKTtcbiAgICAgIGlmICh0b29sSW5zdGFuY2Uuc3RlcHMpe1xuICAgICAgICB0aGlzLl9zZXRUb29sU3RlcFN0YXRlKGFjdGl2ZVRvb2wpO1xuICAgICAgICB0b29sSW5zdGFuY2Uuc3RlcHMub24oJ3N0ZXAnLCBmdW5jdGlvbihpbmRleCxzdGVwKSB7XG4gICAgICAgICAgc2VsZi5fc2V0VG9vbFN0ZXBTdGF0ZShhY3RpdmVUb29sKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRvb2xJbnN0YW5jZS5zdGVwcy5vbignY29tcGxldGUnLCBmdW5jdGlvbigpe1xuICAgICAgICAgIHNlbGYuX3NldFRvb2xTdGVwU3RhdGUoKTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBzZWxmLl9zZXRUb29sU3RlcFN0YXRlKCk7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuX3NldFRvb2xTdGVwU3RhdGUgPSBmdW5jdGlvbihhY3RpdmVUb29sKXtcbiAgICB2YXIgaW5kZXgsIHRvdGFsLCBtZXNzYWdlO1xuICAgIGlmIChfLmlzVW5kZWZpbmVkKGFjdGl2ZVRvb2wpKXtcbiAgICAgIGluZGV4ID0gbnVsbDtcbiAgICAgIHRvdGFsID0gbnVsbDtcbiAgICAgIG1lc3NhZ2UgPSBudWxsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHZhciB0b29sID0gYWN0aXZlVG9vbC5nZXRUb29sKCk7XG4gICAgICB2YXIgbWVzc2FnZXMgPSB0b29sU3RlcHNNZXNzYWdlc1thY3RpdmVUb29sLmdldFR5cGUoKV07XG4gICAgICBpbmRleCA9IHRvb2wuc3RlcHMuY3VycmVudFN0ZXBJbmRleCgpO1xuICAgICAgdG90YWwgPSB0b29sLnN0ZXBzLnRvdGFsU3RlcHMoKTtcbiAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlc1tpbmRleF07XG4gICAgICBpZiAoXy5pc1VuZGVmaW5lZChtZXNzYWdlKSkge1xuICAgICAgICBpbmRleCA9IG51bGw7XG4gICAgICAgIHRvdGFsID0gbnVsbDtcbiAgICAgICAgbWVzc2FnZSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5uID0gaW5kZXggKyAxO1xuICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC50b3RhbCA9IHRvdGFsO1xuICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5tZXNzYWdlID0gbWVzc2FnZTtcbiAgfTtcblxuICB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRFZGl0aW5nTGF5ZXI7XG4gIH07XG5cbiAgdGhpcy5fc2V0Q3VycmVudEVkaXRpbmdMYXllciA9IGZ1bmN0aW9uKGxheWVyKXtcbiAgICBpZiAoIWxheWVyKXtcbiAgICAgIHRoaXMuX2N1cnJlbnRFZGl0aW5nTGF5ZXIgPSBudWxsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuX2N1cnJlbnRFZGl0aW5nTGF5ZXIgPSBsYXllcjtcbiAgICB9XG4gIH07XG5cbiAgdGhpcy5fYWRkVG9NYXAgPSBmdW5jdGlvbigpIHtcbiAgICAvL3JlY3VwZXJvIGwnZWxlbWVudG8gbWFwIG9sM1xuICAgIHZhciBtYXAgPSB0aGlzLl9tYXBTZXJ2aWNlLnZpZXdlci5tYXA7XG4gICAgdmFyIGxheWVyQ29kZXMgPSB0aGlzLmdldExheWVyQ29kZXMoKTtcbiAgICAvL29nbmkgbGF5ZXIgbG8gYWdnaXVuZ28gYWxsYSBtYXBwYVxuICAgIC8vY29uIGlsIG1ldG9kbyBhZGRUb01hcCBkaSB2ZWN0b3JMYXllclxuICAgIF8uZm9yRWFjaChsYXllckNvZGVzLCBmdW5jdGlvbihsYXllckNvZGUpIHtcbiAgICAgIHNlbGYuX2xheWVyc1tsYXllckNvZGVdLnZlY3Rvci5hZGRUb01hcChtYXApO1xuICAgIH0pXG4gIH07XG5cbiAgdGhpcy5fcG9zdERhdGEgPSBmdW5jdGlvbihlZGl0c1RvUHVzaCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvLyBtYW5kbyB1biBvZ2dldHRvIGNvbWUgbmVsIGNhc28gZGVsIGJhdGNoLFxuICAgIC8vIG1hIGluIHF1ZXN0byBjYXNvIGRldm8gcHJlbmRlcmUgc29sbyBpbCBwcmltbywgZSB1bmljbywgZWxlbWVudG9cbiAgICBpZiAoZWRpdHNUb1B1c2gubGVuZ3RoID4gMSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Bvc3RCYXRjaERhdGEoZWRpdHNUb1B1c2gpO1xuICAgIH1cbiAgICB2YXIgbGF5ZXJOYW1lID0gZWRpdHNUb1B1c2hbMF0ubGF5ZXJuYW1lO1xuICAgIHZhciBlZGl0cyA9IGVkaXRzVG9QdXNoWzBdLmVkaXRzO1xuICAgIHZhciBqc29uRGF0YSA9IEpTT04uc3RyaW5naWZ5KGVkaXRzKTtcbiAgICByZXR1cm4gJC5wb3N0KHtcbiAgICAgIHVybDogdGhpcy5jb25maWcuYmFzZXVybCtsYXllck5hbWUrXCIvP1wiK3NlbGYuX2N1c3RvbVVybFBhcmFtZXRlcnMsXG4gICAgICBkYXRhOiBqc29uRGF0YSxcbiAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH0pO1xuICB9O1xuXG4gIHRoaXMuX3Bvc3RCYXRjaERhdGEgPSBmdW5jdGlvbihtdWx0aUVkaXRzVG9QdXNoKXtcbiAgICB2YXIgZWRpdHMgPSB7fTtcbiAgICBfLmZvckVhY2gobXVsdGlFZGl0c1RvUHVzaCxmdW5jdGlvbihlZGl0c1RvUHVzaCl7XG4gICAgICBlZGl0c1tlZGl0c1RvUHVzaC5sYXllcm5hbWVdID0gZWRpdHNUb1B1c2guZWRpdHM7XG4gICAgfSk7XG4gICAgdmFyIGpzb25EYXRhID0gSlNPTi5zdHJpbmdpZnkoZWRpdHMpO1xuICAgIHJldHVybiAkLnBvc3Qoe1xuICAgICAgdXJsOiB0aGlzLmNvbmZpZy5iYXNldXJsLFxuICAgICAgZGF0YToganNvbkRhdGEsXG4gICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLl91bmxvY2sgPSBmdW5jdGlvbigpe1xuICAgIHZhciBsYXllckNvZGVzID0gdGhpcy5nZXRMYXllckNvZGVzKCk7XG4gICAgLy8gZXNlZ3VvIGxlIHJpY2hpZXN0ZSBkZWxsZSBjb25maWd1cmF6aW9uaSBlIG1pIHRlbmdvIGxlIHByb21lc3NlXG4gICAgdmFyIHVubG9ja1JlcXVlc3RzID0gXy5tYXAobGF5ZXJDb2RlcyxmdW5jdGlvbihsYXllckNvZGUpe1xuICAgICAgcmV0dXJuIHNlbGYuX3VubG9ja0xheWVyKHNlbGYuX2xheWVyc1tsYXllckNvZGVdKTtcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLl91bmxvY2tMYXllciA9IGZ1bmN0aW9uKGxheWVyQ29uZmlnKXtcbiAgICAkLmdldCh0aGlzLmNvbmZpZy5iYXNldXJsK2xheWVyQ29uZmlnLm5hbWUrXCIvP3VubG9ja1wiKTtcbiAgfTtcbiAgLy9nZXQgbG9hZGVyIHNlcnZpY2VcbiAgdGhpcy5nZXRMb2FkZXIgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5fbG9hZGVyO1xuICB9XG59XG5cbmluaGVyaXQoR2Vvbm90ZXNTZXJ2aWNlLCBHM1dPYmplY3QpO1xubW9kdWxlLmV4cG9ydHMgPSBuZXcgR2Vvbm90ZXNTZXJ2aWNlO1xufSx7XCIuL2VkaXRvcnMvYXR0cmlidXRlc2Zvcm1cIjoxfV19LHt9LFszXSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
