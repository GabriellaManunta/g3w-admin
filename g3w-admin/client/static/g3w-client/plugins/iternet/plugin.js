!function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return o(i?i:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){function n(t){var e={layer:["cod_acc"],relations:{interno:["cod_acc"],numero_civico:["cod_civ"]}};t.copyAndPasteFieldsNotOverwritable=e;var t=t;this._askConfirmToDeleteEditingListener=function(){this.onbeforeasync("deleteFeature",function(t,e,i){"0102"==t.get("tip_acc")?s.dialog.confirm("Vuoi eliminare l'elemento selezionato e gli elementi ad essi collegati?",function(t){i(t)}):r(this,"_deleteFeatureDialog",i)})},r(this,t)}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.gui.GUI,a=t("./iterneteditor");o(n,a),e.exports=n},{"./iterneteditor":4}],2:[function(t,e,i){function n(t){r(this,t),this._formPanel=d}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.core.ProjectsRegistry,a=g3wsdk.gui.FormPanel,l=g3wsdk.gui.Form,d=a.extend({});o(n,l);var c=n.prototype;c._isVisible=function(t){var e=!0;switch(t.name){case"cod_acc_est":var i=this._getField("tip_acc");"0101"==i.value&&(e=!1);break;case"cod_acc_int":var i=this._getField("tip_acc");"0101"!=i.value&&"0501"!=i.value||(e=!1)}return e},c._isEditable=function(t){return!("tip_acc"==t.name&&!this._isNew())&&l.prototype._isEditable.call(this,t)},c._shouldShowRelation=function(t){if("numero_civico"==t.name){var e=this._getField("tip_acc");if("0102"==e.value)return!1}return!0},c._pickLayer=function(t){var e=this,i=t.input.options.layerid;l.prototype._pickLayer.call(this,t).then(function(n){var o,r;switch(t.name){case"cod_ele":o=e._getRelationField("cod_top","numero_civico");break;case"cod_top":o=e._getField("cod_ele")}if(o){var a=s.getCurrentProject();r=a.getLayerAttributeLabel(i,o.input.options.field),o&&n[r]&&(o.value=n[r])}})},e.exports=n},{}],3:[function(t,e,i){function n(t){r(this,t),this._service=null,this._stradeEditor=null,this._giunzioneGeomListener=null,this._setupMoveGiunzioniListener=function(){var t=this;this.on("movestart",function(e){t._startMovingGiunzione(e)})},this._stradeToUpdate=[],this._startMovingGiunzione=function(t){var e=this,i=(this.getVectorLayer(),this._stradeEditor),n=t,o=n.get("cod_gnz");this._stradeToUpdate=[];var r=i.getVectorLayer().getSource().getFeatures();_.forEach(r,function(t){var i=t.get("nod_ini"),r=t.get("nod_fin"),s=i==o,a=r==o;if(s||a){var l=!!s;e._stradeToUpdate.push(t),e._startGiunzioniStradeTopologicalEditing(n,t,l)}}),this.once("moveend",function(t){e._stradeToUpdate.length&&(i.isStarted()||i.start(this._service),_.forEach(e._stradeToUpdate,function(t){i.updateFeature(t)}))})},this._startGiunzioniStradeTopologicalEditing=function(t,e,i){var n=e.getGeometry(),o=e.getGeometry().getCoordinates(),r=i?0:o.length-1,s=t.getGeometry(),a=s.on("change",function(t){o[r]=t.target.getCoordinates(),n.setCoordinates(o)});this._giunzioneGeomListener=a},this._setupDeleteGiunzioniListener=function(){var t=this._stradeEditor;this.onbeforeasync("deleteFeature",function(e,i,n){var o=!1,r=t.getVectorLayer();_.forEach(r.getFeatures(),function(t){var i=e.get("cod_gnz"),n=t.get("nod_ini"),r=t.get("nod_fin"),s=n==i,a=r==i;(s||a)&&(o=!0)}),o&&GUI.notify.error("Non è possibile rimuovere la giunzioni perché risulta connessa ad una o più strade"),n(!o)})}}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=t("./iterneteditor");o(n,s),e.exports=n;var a=n.prototype;a.start=function(t){return this._service=t,this._stradeEditor=t._layers[t.layerCodes.STRADE].editor,this._setupMoveGiunzioniListener(),this._setupDeleteGiunzioniListener(),s.prototype.start.call(this)},a.stop=function(){var t=!1;return s.prototype.stop.call(this)&&(t=!0,ol.Observable.unByKey(this._giunzioneGeomListener)),t},a.setTool=function(t){var e;return"addfeature"==t&&(e={snap:{vectorLayer:this._stradeEditor.getVectorLayer()}}),s.prototype.setTool.call(this,t,e)}},{"./iterneteditor":4}],4:[function(t,e,i){function n(t){r(this,t)}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.core.Editor;t("./attributesform");o(n,s),e.exports=n},{"./attributesform":2}],5:[function(t,e,i){function n(t){r(this,t),this._service=null,this._giunzioniEditor=null,this._mapService=s.getComponent("map").getService(),this._stradeSnaps=null,this._stradeSnapsCollection=function(){var t=[];this.length=0,this.push=function(e){var i=!1;return this.canSnap(e)&&(t.push(e),this.length+=1,i=!0),i},this.getLast=function(){return t[t.length-1]},this.getFirst=function(){return t[0]},this.clear=function(){t.splice(0,t.length),this.length=0},this.getSnaps=function(){return t},this.canSnap=function(t){if(this.isAlreadySnapped(t))return!1;var e=t.get("cod_gnz");return!_.isNil(e)&&""!=e},this.isAlreadySnapped=function(t){return _.includes(this.snaps,t)}},this._updateStradaAttributes=function(t){var e=this._stradeSnaps;t.set("nod_ini",e.getSnaps()[0].get("cod_gnz")),t.set("nod_fin",e.getSnaps()[1].get("cod_gnz"))},this._loadMissingGiunzioniInView=function(){var t=this.getVectorLayer(),e=this._giunzioniEditor.getVectorLayer(),i=t.getSource(),n=ol.extent.buffer(i.getExtent(),1),o=this._service.getLoader();o._loadVectorData(e,n)},this._drawRemoveLastPoint=_.bind(function(t){var e=this,i=this.getActiveTool().getType();"addfeature"==i&&46==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.getActiveTool().getTool().removeLastPoint())},this),this._setupDrawStradeConstraints=function(){var t=this;this._mapService.viewer.map.getTargetElement().id,this._mapService.viewer.map;this.onbefore("addFeature",function(e){var i=t._stradeSnaps;return 2==i.length&&(t._updateStradaAttributes(e),i.clear(),!0)},0)},this._getCheckSnapsCondition=function(){var t=this;return function(e){var i=t._stradeSnaps;return 2==i.length||(s.notify.error("L'ultimo vertice deve corrispondere con una giunzione"),!1)}},this._getStradaIsBeingSnappedCondition=function(){var t=this,e=this._mapService.viewer.map,i=this._giunzioniEditor.getVectorLayer();return function(n){var o=t._stradeSnaps,r=e.getCoordinateFromPixel(n.pixel),a=i.getSource(),l=ol.extent.buffer([r[0],r[1],r[0],r[1]],1),d=a.getFeaturesInExtent(l)[0];if(2==o.length&&(!d||d!=o.getSnaps()[1])){return s.notify.error("Una strada non può avere vertici intermedi in corrispondenza di giunzioni.<br> Premere <b>CANC</b> per rimuovere l'ultimo vertice."),!1}return d&&o.length<2&&o.push(d),0!=o.length||(s.notify.error("Il primo vertice deve corrispondere con una giunzione"),!1)}},this._modifyRemovePoint=_.bind(function(t){var e=this,i=this.getActiveTool().getType();"modifyvertex"==i&&46==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.getActiveTool().getTool().removePoint())},this),this._setupModifyVertexStradeConstraints=function(){var t=this;this._mapService.viewer.map;this.onbefore("modifyFeature",function(e){var i=t._stradeSnaps,n=t._checkStradaIsCorrectlySnapped(e.getGeometry());return n&&(t._updateStradaAttributes(e),i.clear()),n})},this._checkStradaIsCorrectlySnapped=function(t){var e=!0,i=(this._mapService.viewer.map,this._giunzioniEditor.getVectorLayer());this._stradeSnaps.clear();var n=this._stradeSnaps,o=t.getCoordinates(),r=!1,a=!1;return _.forEach(o,function(t,e){var s=i.getSource(),l=ol.extent.buffer([t[0],t[1],t[0],t[1]],.1),d=s.getFeaturesInExtent(l)[0];d&&(0==e&&n.push(d)?r=!0:e==o.length-1&&n.push(d)&&(a=!0))}),n.length>2&&(s.notify.error("Una strada non può avere vertici intermedi in corrispondenza di giunzioni"),e=!1),r||(s.notify.error("Il primo vertice deve corrispondere con una giunzione"),e=!1),a||(s.notify.error("L'ultimo vertice deve corrispondere con una giunzione"),e=!1),e},this._setupStradeCutterPostSelection=function(){var t=this;this.onbeforeasync("cutLine",function(e,i,n){if("MODONCUT"==i){var o=e.added[0],r=t._getFirstLastSnappedGiunzioni(o.getGeometry());o.set("nod_ini",r[0].get("cod_gnz")),o.set("nod_fin",r[1].get("cod_gnz"));var s=e.updated,a=t._getFirstLastSnappedGiunzioni(s.getGeometry());s.set("nod_ini",a[0].get("cod_gnz")),s.set("nod_fin",a[1].get("cod_gnz")),t._openEditorForm("new",o,n)}else n(!0)})},this._getFirstLastSnappedGiunzioni=function(t){var e=t.getCoordinates(),i=this._giunzioniEditor.getVectorLayer(),n=null,o=null;return _.forEach(e,function(t,r){var s=i.getSource(),a=ol.extent.buffer([t[0],t[1],t[0],t[1]],.1),l=s.getFeaturesInExtent(a)[0];l&&(0==r?n=l:r==e.length-1&&(o=l))}),[n,o]}}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.gui.GUI,a=t("./iterneteditor");o(n,a),e.exports=n;var l=n.prototype;l.start=function(t){return this._service=t,this._giunzioniEditor=t._layers[t.layerCodes.GIUNZIONI].editor,this._loadMissingGiunzioniInView(),this._setupDrawStradeConstraints(),this._setupModifyVertexStradeConstraints(),this._setupStradeCutterPostSelection(),a.prototype.start.call(this)},l.setTool=function(t){var e,i=this._giunzioniEditor.getVectorLayer();"addfeature"==t&&(e={snap:{vectorLayer:i},finishCondition:this._getCheckSnapsCondition(),condition:this._getStradaIsBeingSnappedCondition()}),"modifyvertex"==t&&(e={snap:{vectorLayer:i},deleteCondition:_.constant(!1)}),"cutline"==t&&(e={pointLayer:i.getMapLayer()});var n=a.prototype.setTool.call(this,t,e);return n&&(this._stradeSnaps=new this._stradeSnapsCollection,$("body").keyup(this._drawRemoveLastPoint),$("body").keyup(this._modifyRemovePoint)),n},l.stopTool=function(){var t=!1;return t=a.prototype.stopTool.call(this),t&&(this._stradeSnaps=null,$("body").off("keyup",this._drawRemoveLastPoint),$("body").off("keyup",this._modifyRemovePoint)),t}},{"./iterneteditor":4}],6:[function(t,e,i){var n=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,r=g3wsdk.core.Plugin,s=g3wsdk.gui.GUI,a=t("./pluginservice"),l=t("./panel"),d=function(){o(this),this.name="iternet",this.config=null,this.service=null,this.init=function(){this.setPluginService(a),this.config=this.getPluginConfig(),this.registerPlugin(this.config.gid)&&(s.ready?this.setupGui():s.on("ready",_.bind(this.setupGui,this)),this.service.init(this.config))},this.setupGui=function(){var t=this,e=s.getComponent("tools"),i=e.getService();i.addTools(0,"ITERNET",[{name:"Editing dati",action:_.bind(t.showEditingPanel,this)}])},this.showEditingPanel=function(){var t=new l;s.showPanel(t)}};n(d,r),function(t){t.init()}(new d)},{"./panel":8,"./pluginservice":9}],7:[function(t,e,i){e.exports='<div class="g3w-iternet-editing-panel">\n  <template v-for="toolbar in editorstoolbars">\n    <div class="panel panel-primary">\n      <div class="panel-heading">\n        <h3 class="panel-title">{{ toolbar.name }}</h3>\n      </div>\n      <div class="panel-body">\n        <template v-for="tool in toolbar.tools">\n          <div class="editbtn" :class="{\'enabled\' : (state.editing.on && editingtoolbtnEnabled(tool)), \'toggled\' : editingtoolbtnToggled(toolbar.layercode,tool.tooltype)}">\n            <img height="30px" width="30px" @click="toggleEditTool(toolbar.layercode,tool.tooltype)" :alt.once="tool.title" :title.once="tool.title" :src.once="resourcesurl+\'images/\'+tool.icon"/>\n          </div>\n        </template>\n      </div>\n    </div>\n  </template>\n  <div>\n    <button class="btn btn-primary" v-disabled="editingbtnEnabled" :class="{\'btn-success\' : state.editingOn}" @click="toggleEditing">{{ editingbtnlabel }}</button>\n    <button class="btn btn-danger" v-disabled="!state.hasEdits" @click="saveEdits">{{ savebtnlabel }}</button>\n    <img v-show="state.retrievingData" :src="resourcesurl +\'images/loader.svg\'">\n  </div>\n  <div class="message">\n    {{{ message }}}\n  </div>\n</div>\n'},{}],8:[function(t,e,i){function n(){this.id="iternet-editing-panel",this.name="Gestione dati ITERNET",this.internalPanel=new d}var o=g3wsdk.core.utils.resolve,r=g3wsdk.core.utils.inherit,s=g3wsdk.gui.GUI,a=g3wsdk.gui.Panel,l=t("./pluginservice"),d=Vue.extend({template:t("./panel.html"),data:function(){return{state:l.state,resourcesurl:s.getResourcesUrl(),editorstoolbars:[{name:"Accessi",layercode:l.layerCodes.ACCESSI,tools:[{title:"Aggiungi accesso",tooltype:"addfeature",icon:"iternetAddPoint.png"},{title:"Sposta accesso",tooltype:"movefeature",icon:"iternetMovePoint.png"},{title:"Rimuovi accesso",tooltype:"deletefeature",icon:"iternetDeletePoint.png"},{title:"Edita attributi",tooltype:"editattributes",icon:"editAttributes.png"}]},{name:"Giunzioni stradali",layercode:l.layerCodes.GIUNZIONI,tools:[{title:"Aggiungi giunzione",tooltype:"addfeature",icon:"iternetAddPoint.png"},{title:"Sposta giunzione",tooltype:"movefeature",icon:"iternetMovePoint.png"},{title:"Rimuovi giunzione",tooltype:"deletefeature",icon:"iternetDeletePoint.png"},{title:"Edita attributi",tooltype:"editattributes",icon:"editAttributes.png"}]},{name:"Elementi stradali",layercode:l.layerCodes.STRADE,tools:[{title:"Aggiungi strada",tooltype:"addfeature",icon:"iternetAddLine.png"},{title:"Sposta vertice strada",tooltype:"modifyvertex",icon:"iternetMoveVertex.png"},{title:"Taglia su giunzione",tooltype:"cutline",icon:"iternetCutOnVertex.png"},{title:"Sposta strada",tooltype:"movefeature",icon:"iternetMoveLine.png"},{title:"Rimuovi strada",tooltype:"deletefeature",icon:"iternetDeleteLine.png"},{title:"Edita attributi",tooltype:"editattributes",icon:"editAttributes.png"}]}],savebtnlabel:"Salva"}},methods:{toggleEditing:function(){l.toggleEditing()},saveEdits:function(){l.saveEdits()},toggleEditTool:function(t,e){""!=e&&this.state.editing.on&&l.toggleEditTool(t,e)},editingtoolbtnToggled:function(t,e){return this.state.editing.layerCode==t&&this.state.editing.toolType==e},editingtoolbtnEnabled:function(t){return""!=t.tooltype}},computed:{editingbtnlabel:function(){return this.state.editing.on?"Termina editing":"Avvia editing"},editingbtnEnabled:function(){return this.state.editing.enabled||this.state.editing.on?"":"disabled"},message:function(){var t="";if(this.state.editing.enabled){if(this.state.editing.toolstep.message){var e=this.state.editing.toolstep.n,i=this.state.editing.toolstep.total,n=this.state.editing.toolstep.message;t='<div style="margin-top:20px">GUIDA STRUMENTO:</div><div><span>['+e+"/"+i+'] </span><span style="color: yellow">'+n+"</span></div>"}}else t='<span style="color: red">Aumentare il livello di zoom per abilitare l\'editing';return t}}});r(n,a);var c=a.prototype;c.onShow=function(t){console.log("ciao");var e=this.internalPanel;return e.$mount().$appendTo(t),o(!0)},c.onClose=function(){var t=this,e=$.Deferred();return l.stop().then(function(){t.internalPanel.$destroy(!0),t.internalPanel=null,e.resolve()}).fail(function(){e.reject()}),e.promise()},e.exports=n},{"./panel.html":7,"./pluginservice":9}],9:[function(t,e,i){function n(){var t=this;this._mapService=null,this._runningEditor=null;var e=this.layerCodes={STRADE:"strade",GIUNZIONI:"giunzioni",ACCESSI:"accessi"};this._editorClass={},this._editorClass[e.ACCESSI]=d,this._editorClass[e.GIUNZIONI]=c,this._editorClass[e.STRADE]=u,this._layers={},this._layers[e.ACCESSI]={layerCode:e.ACCESSI,vector:null,editor:null,style:function(t){var e="#d9b581";switch(t.get("tip_acc")){case"0101":e="#d9b581";break;case"0102":e="#d9bc29";break;case"0501":e="#68aad9";break;default:e="#d9b581"}return[new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:e})})})]}},this._layers[e.GIUNZIONI]={layerCode:e.GIUNZIONI,vector:null,editor:null,style:new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"#0000ff"})})})},this._layers[e.STRADE]={layerCode:e.STRADE,vector:null,editor:null,style:new ol.style.Style({stroke:new ol.style.Stroke({width:3,color:"#ff7d2d"})})},this._loadDataOnMapViewChangeListener=null,this._currentEditingLayer=null,this._loadedExtent=null,this.state={editing:{on:!1,enabled:!1,layerCode:null,toolType:null,startingEditingTool:!1,toolstep:{n:null,total:null,message:null}},retrievingData:!1,hasEdits:!1},this._loader=new a,this.init=function(t){var e=this;this.config=t,this._mapService=s.getComponent("map").getService();var i={layers:this._layers,baseurl:this.config.baseurl,mapService:this._mapService};this._loader.init(i),this._loader.on("retriewvectorlayers",function(t,i){_.forEach(i,function(i,n){t&&(e._setUpVectorLayer(n,i),e._setUpEditor(n)),e.state.retrievingData=t})}),this._loader.on("retriewvectolayersdata",function(t){e.state.retrievingData=t}),this._loader.on("featurelocks",function(t,i){e._layers[t].editor.setFeatureLocks(i)}),this._mapService.on("pointerInteractionSet",function(t){var i=e._getCurrentEditingLayer();if(i){var n=i.editor.getActiveTool().instance;n&&!n.ownsInteraction(t)&&e._stopEditingTool()}}),this.state.editing.enabled=!0,_.forEach(this._layers,function(i,n){var o=t.layers[n].id,r=e._mapService.getProject().getLayerById(o);i.name=r.getOrigName(),i.id=o})},this.stop=function(){var e=$.Deferred();return this.state.editing.on?this._cancelOrSave().then(function(){t._stopEditing(),e.resolve()}).fail(function(){e.reject()}):e.resolve(),e.promise()},this.toggleEditing=function(){var t=$.Deferred();if(this.state.editing.enabled&&!this.state.editing.on)this._startEditing();else if(this.state.editing.on)return this.stop();return t.promise()},this.saveEdits=function(){this._cancelOrSave(2)},this.toggleEditTool=function(t,e){var i=this,n=this._layers[t];if(n){var o=this._getCurrentEditingLayer();o&&t==o.layerCode?e==o.editor.getActiveTool().getType()?this._stopEditingTool():(this._stopEditingTool(),this._startEditingTool(o,e)):o&&o.editor.isStarted()?this._cancelOrSave(2).then(function(){i._stopEditor()&&(console.log("sono qui dopo invio dei dati"),i._startEditingTool(n,e))}):this._startEditingTool(n,e)}},this.getLayerCodes=function(){return _.values(this.layerCodes)},this._setUpVectorLayer=function(t,e){this._layers[t].vector=e},this._setUpEditor=function(t){var e=this,i={mapService:e._mapService,formClass:l},n=this._layers[t].vector,o=new e._editorClass[t](i);o.setVectorLayer(n),o.on("dirty",function(t){e.state.hasEdits=t}),this._layers[t].editor=o},this._startEditing=function(){var t=this;this._loader.loadLayers().then(function(e){t._addToMap(),t.state.editing.on=!0,t.emit("editingstarted"),t._loadDataOnMapViewChangeListener||(t._loadDataOnMapViewChangeListener=t._mapService.onafter("setMapView",function(){t.state.editing.on&&t.state.editing.enabled&&t._loader.loadAllVectorsData()}))})},this._stopEditing=function(e){this._stopEditor(e)&&(_.forEach(this._layers,function(e,i){var n=e.vector;t._mapService.viewer.removeLayerByName(n.name),e.vector=null,e.editor=null,t._unlockLayer(t._layers[i])}),this._updateEditingState(),t.state.editing.on=!1,t._cleanUp(),t.emit("editingstopped"))},this._cleanUp=function(){this._loader.cleanUpLayers()},this._startEditor=function(t){return!!t.editor.start(this)&&(this._setCurrentEditingLayer(t),!0)},this._startEditingTool=function(t,e,i){this.state.startingEditingTool=!0;var n=!0;return t.editor.isStarted()||(n=this._startEditor(t)),n&&t.editor.setTool(e,i)?(this._updateEditingState(),this.state.startingEditingTool=!1,!0):(this.state.startingEditingTool=!1,!1)},this._stopEditor=function(t){var e=!0,i=this._getCurrentEditingLayer();return i&&(e=i.editor.stop(t),e&&this._setCurrentEditingLayer()),e},this._stopEditingTool=function(){var t=!0,e=this._getCurrentEditingLayer();return e&&(t=e.editor.stopTool(),t&&this._updateEditingState()),t},this._cancelOrSave=function(t){var e=$.Deferred();try{var i=1;t&&(i=t);var n=this,o={};_.forEach(this._layers,function(t,e){t.editor.isDirty()&&(o[e]=t.editor)}),_.keys(o).length?(console.log("askType: ",i),this._askCancelOrSave(i).then(function(t){"save"===t?n._saveEdits(o).then(function(t){e.resolve()}).fail(function(t){e.reject()}):"nosave"==t?e.resolve():"cancel"==t&&e.reject()})):e.resolve()}catch(r){e.reject()}return e.promise()},this._askCancelOrSave=function(t){var e=$.Deferred(),i={SAVE:{label:"Salva",className:"btn-success",callback:function(){e.resolve("save")}},NOSAVE:{label:"Termina senza salvare",className:"btn-danger",callback:function(){e.resolve("nosave")}},CANCEL:{label:"Annulla",className:"btn-primary",callback:function(){e.resolve("cancel")}}};switch(t){case 1:buttons={save:i.SAVE,nosave:i.NOSAVE,cancel:i.CANCEL};break;case 2:buttons={save:i.SAVE,cancel:i.CANCEL}}return s.dialog.dialog({message:"Vuoi salvare definitivamente le modifiche?",title:"Salvataggio modifica",buttons:buttons}),e.promise()},this._saveEdits=function(e){var i=$.Deferred();return this._sendEdits(e).then(function(n){s.notify.success("I dati sono stati salvati correttamente"),t._commitEdits(e,n),t._mapService.refreshMap(),i.resolve()}).fail(function(t){s.notify.error("Errore nel salvataggio sul server"),i.resolve()}),i.promise()},this._sendEdits=function(t){var e=$.Deferred(),i=_.map(t,function(t){return{layername:t.getVectorLayer().name,edits:t.getEditedFeatures()}});return this._postData(i).then(function(t){t.result?e.resolve(t.response):e.reject(t.response)}).fail(function(t){e.reject(t.response)}),e.promise()},this._commitEdits=function(t,e){_.forEach(t,function(t){e&&e["new"]&&_.forEach(e["new"],function(e){var i=e.clientid,n=e.id;t.getEditVectorLayer().setFeatureData(i,n,null,e)}),t.commit()})},this._undoEdits=function(t){var e=this._getCurrentEditingLayer().layerCode;t[e];this._stopEditing(!0)},this._updateEditingState=function(){var t=this._getCurrentEditingLayer();t?(this.state.editing.layerCode=t.layerCode,this.state.editing.toolType=t.editor.getActiveTool().getType()):(this.state.editing.layerCode=null,this.state.editing.toolType=null),this._updateToolStepsState()},this._updateToolStepsState=function(){var t,e=this,i=this._getCurrentEditingLayer();if(i&&(t=i.editor.getActiveTool()),t&&t.getTool()){var n=t.getTool();n.steps&&(this._setToolStepState(t),n.steps.on("step",function(i,n){e._setToolStepState(t)}),n.steps.on("complete",function(){e._setToolStepState()}))}else e._setToolStepState()},this._setToolStepState=function(t){var e,i,n;if(_.isUndefined(t))e=null,i=null,n=null;else{var o=t.getTool(),r=g[t.getType()];e=o.steps.currentStepIndex(),i=o.steps.totalSteps(),n=r[e],_.isUndefined(n)&&(e=null,i=null,n=null)}this.state.editing.toolstep.n=e+1,this.state.editing.toolstep.total=i,this.state.editing.toolstep.message=n},this._getCurrentEditingLayer=function(){return this._currentEditingLayer},this._setCurrentEditingLayer=function(t){t?this._currentEditingLayer=t:this._currentEditingLayer=null},this._addToMap=function(){var e=this._mapService.viewer.map,i=this.getLayerCodes();_.forEach(i,function(i){t._layers[i].vector.addToMap(e)})},this._postData=function(t){if(t.length>1)return this._postBatchData(t);var e=t[0].layername,i=t[0].edits;console.log(i);var n=JSON.stringify(i);return $.post({url:this.config.baseurl+e+"/",data:n,contentType:"application/json"})},this._postBatchData=function(t){var e={};_.forEach(t,function(t){e[t.layername]=t.edits});var i=JSON.stringify(e);return $.post({url:this.config.baseurl,data:i,contentType:"application/json"})},this._unlock=function(){var e=this.getLayerCodes();_.map(e,function(e){return t._unlockLayer(t._layers[e])})},this._unlockLayer=function(t){$.get(this.config.baseurl+t.name+"/?unlock")},this.getLoader=function(){return this._loader}}var o=g3wsdk.core.utils.inherit,r=(g3wsdk.core.utils.resolve,g3wsdk.core.utils.reject,g3wsdk.core.G3WObject),s=g3wsdk.gui.GUI,a=(g3wsdk.core.VectorLayer,g3wsdk.core.VectorLayerLoader),l=t("./editors/attributesform"),d=t("./editors/accessieditor"),c=t("./editors/giunzionieditor"),u=t("./editors/stradeeditor"),g={cutline:["Seleziona la strada da tagliare","Seleziona la giunzione di taglio","Seleziona la porizione di strada originale da mantenere"]};o(n,r),e.exports=new n},{"./editors/accessieditor":1,"./editors/attributesform":2,"./editors/giunzionieditor":3,"./editors/stradeeditor":5}]},{},[6]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1aWxkLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIkFjY2Vzc2lFZGl0b3IiLCJvcHRpb25zIiwiY29weUFuZFBhc3RlRmllbGRzTm90T3ZlcndyaXRhYmxlIiwibGF5ZXIiLCJyZWxhdGlvbnMiLCJpbnRlcm5vIiwibnVtZXJvX2NpdmljbyIsInRoaXMiLCJfYXNrQ29uZmlybVRvRGVsZXRlRWRpdGluZ0xpc3RlbmVyIiwib25iZWZvcmVhc3luYyIsImZlYXR1cmUiLCJpc05ldyIsIm5leHQiLCJnZXQiLCJHVUkiLCJkaWFsb2ciLCJjb25maXJtIiwicmVzdWx0IiwiYmFzZSIsImluaGVyaXQiLCJnM3dzZGsiLCJjb3JlIiwidXRpbHMiLCJndWkiLCJJdGVybmV0RWRpdG9yIiwiLi9pdGVybmV0ZWRpdG9yIiwiMiIsIkl0ZXJuZXRGb3JtIiwiX2Zvcm1QYW5lbCIsIkl0ZXJuZXRGb3JtUGFuZWwiLCJQcm9qZWN0c1JlZ2lzdHJ5IiwiRm9ybVBhbmVsIiwiRm9ybSIsImV4dGVuZCIsInByb3RvIiwicHJvdG90eXBlIiwiX2lzVmlzaWJsZSIsImZpZWxkIiwicmV0IiwibmFtZSIsInRpcF9hY2MiLCJfZ2V0RmllbGQiLCJ2YWx1ZSIsIl9pc0VkaXRhYmxlIiwiX2lzTmV3IiwiX3Nob3VsZFNob3dSZWxhdGlvbiIsInJlbGF0aW9uIiwiX3BpY2tMYXllciIsInNlbGYiLCJsYXllcklkIiwiaW5wdXQiLCJsYXllcmlkIiwidGhlbiIsImF0dHJpYnV0ZXMiLCJsaW5rZWRGaWVsZCIsImxpbmtlZEZpZWxkQXR0cmlidXRlTmFtZSIsIl9nZXRSZWxhdGlvbkZpZWxkIiwicHJvamVjdCIsImdldEN1cnJlbnRQcm9qZWN0IiwiZ2V0TGF5ZXJBdHRyaWJ1dGVMYWJlbCIsIjMiLCJHaXVuemlvbmlFZGl0b3IiLCJfc2VydmljZSIsIl9zdHJhZGVFZGl0b3IiLCJfZ2l1bnppb25lR2VvbUxpc3RlbmVyIiwiX3NldHVwTW92ZUdpdW56aW9uaUxpc3RlbmVyIiwib24iLCJfc3RhcnRNb3ZpbmdHaXVuemlvbmUiLCJfc3RyYWRlVG9VcGRhdGUiLCJzdHJhZGVFZGl0b3IiLCJnZXRWZWN0b3JMYXllciIsImdpdW56aW9uZSIsImNvZF9nbnoiLCJzdHJhZGUiLCJnZXRTb3VyY2UiLCJnZXRGZWF0dXJlcyIsIl8iLCJmb3JFYWNoIiwic3RyYWRhIiwibm9kX2luaSIsIm5vZF9maW4iLCJpbmkiLCJmaW4iLCJpbml0aWFsIiwicHVzaCIsIl9zdGFydEdpdW56aW9uaVN0cmFkZVRvcG9sb2dpY2FsRWRpdGluZyIsIm9uY2UiLCJpc1N0YXJ0ZWQiLCJzdGFydCIsInVwZGF0ZUZlYXR1cmUiLCJzdHJhZGFHZW9tIiwiZ2V0R2VvbWV0cnkiLCJzdHJhZGFDb29yZHMiLCJnZXRDb29yZGluYXRlcyIsImNvb3JkSW5kZXgiLCJnaXVuemlvbmVHZW9tIiwibGlzdGVuZXJLZXkiLCJ0YXJnZXQiLCJzZXRDb29yZGluYXRlcyIsIl9zZXR1cERlbGV0ZUdpdW56aW9uaUxpc3RlbmVyIiwic3RvcERlbGV0aW9uIiwic3RyYWRlVmVjdG9yTGF5ZXIiLCJub3RpZnkiLCJlcnJvciIsIml0ZXJuZXRTZXJ2aWNlIiwiX2xheWVycyIsImxheWVyQ29kZXMiLCJTVFJBREUiLCJlZGl0b3IiLCJzdG9wIiwib2wiLCJPYnNlcnZhYmxlIiwidW5CeUtleSIsInNldFRvb2wiLCJ0b29sVHlwZSIsInNuYXAiLCJ2ZWN0b3JMYXllciIsIjQiLCJFZGl0b3IiLCIuL2F0dHJpYnV0ZXNmb3JtIiwiNSIsIlN0cmFkZUVkaXRvciIsIl9naXVuemlvbmlFZGl0b3IiLCJfbWFwU2VydmljZSIsImdldENvbXBvbmVudCIsImdldFNlcnZpY2UiLCJfc3RyYWRlU25hcHMiLCJfc3RyYWRlU25hcHNDb2xsZWN0aW9uIiwic25hcHMiLCJwdXNoZWQiLCJjYW5TbmFwIiwiZ2V0TGFzdCIsImdldEZpcnN0IiwiY2xlYXIiLCJzcGxpY2UiLCJnZXRTbmFwcyIsImlzQWxyZWFkeVNuYXBwZWQiLCJpc05pbCIsImluY2x1ZGVzIiwiX3VwZGF0ZVN0cmFkYUF0dHJpYnV0ZXMiLCJzZXQiLCJfbG9hZE1pc3NpbmdHaXVuemlvbmlJblZpZXciLCJnaXVuemlvbmlWZWN0b3JMYXllciIsInN0cmFkZVNvdXJjZSIsImV4dGVudCIsImJ1ZmZlciIsImdldEV4dGVudCIsImxvYWRlciIsImdldExvYWRlciIsIl9sb2FkVmVjdG9yRGF0YSIsIl9kcmF3UmVtb3ZlTGFzdFBvaW50IiwiYmluZCIsImdldEFjdGl2ZVRvb2wiLCJnZXRUeXBlIiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiZ2V0VG9vbCIsInJlbW92ZUxhc3RQb2ludCIsIl9zZXR1cERyYXdTdHJhZGVDb25zdHJhaW50cyIsInZpZXdlciIsIm1hcCIsImdldFRhcmdldEVsZW1lbnQiLCJpZCIsIm9uYmVmb3JlIiwiX2dldENoZWNrU25hcHNDb25kaXRpb24iLCJfZ2V0U3RyYWRhSXNCZWluZ1NuYXBwZWRDb25kaXRpb24iLCJjIiwiZ2V0Q29vcmRpbmF0ZUZyb21QaXhlbCIsInBpeGVsIiwiZ2l1bnppb25pU291cmNlIiwic25hcHBlZEZlYXR1cmUiLCJnZXRGZWF0dXJlc0luRXh0ZW50IiwiX21vZGlmeVJlbW92ZVBvaW50IiwicmVtb3ZlUG9pbnQiLCJfc2V0dXBNb2RpZnlWZXJ0ZXhTdHJhZGVDb25zdHJhaW50cyIsImNvcnJlY3QiLCJfY2hlY2tTdHJhZGFJc0NvcnJlY3RseVNuYXBwZWQiLCJnZW9tZXRyeSIsImNvb3JkaW5hdGVzIiwiZmlyc3RWZXJ0ZXhTbmFwcGVkIiwibGFzdFZlcnRleFNuYXBwZWQiLCJpbmRleCIsIl9zZXR1cFN0cmFkZUN1dHRlclBvc3RTZWxlY3Rpb24iLCJkYXRhIiwibW9kVHlwZSIsIm5ld0ZlYXR1cmUiLCJhZGRlZCIsIm5ld0ZlYXR1cmVTbmFwcyIsIl9nZXRGaXJzdExhc3RTbmFwcGVkR2l1bnppb25pIiwidXBkYXRlZCIsInVwZGF0ZUZlYXR1cmVTbmFwcyIsIl9vcGVuRWRpdG9yRm9ybSIsIkdJVU5aSU9OSSIsImZpbmlzaENvbmRpdGlvbiIsImNvbmRpdGlvbiIsImRlbGV0ZUNvbmRpdGlvbiIsImNvbnN0YW50IiwicG9pbnRMYXllciIsImdldE1hcExheWVyIiwiJCIsImtleXVwIiwic3RvcFRvb2wiLCJvZmYiLCI2IiwiUGx1Z2luIiwiU2VydmljZSIsIkVkaXRpbmdQYW5lbCIsIl9QbHVnaW4iLCJjb25maWciLCJzZXJ2aWNlIiwiaW5pdCIsInNldFBsdWdpblNlcnZpY2UiLCJnZXRQbHVnaW5Db25maWciLCJyZWdpc3RlclBsdWdpbiIsImdpZCIsInJlYWR5Iiwic2V0dXBHdWkiLCJ0b29sc0NvbXBvbmVudCIsInRvb2xzU2VydmljZSIsImFkZFRvb2xzIiwiYWN0aW9uIiwic2hvd0VkaXRpbmdQYW5lbCIsInBhbmVsIiwic2hvd1BhbmVsIiwicGx1Z2luIiwiLi9wYW5lbCIsIi4vcGx1Z2luc2VydmljZSIsIjciLCI4IiwiRWRpdG9yUGFuZWwiLCJpbnRlcm5hbFBhbmVsIiwiUGFuZWxDb21wb25lbnQiLCJyZXNvbHZlZFZhbHVlIiwicmVzb2x2ZSIsIlBhbmVsIiwiVnVlIiwidGVtcGxhdGUiLCJzdGF0ZSIsInJlc291cmNlc3VybCIsImdldFJlc291cmNlc1VybCIsImVkaXRvcnN0b29sYmFycyIsImxheWVyY29kZSIsIkFDQ0VTU0kiLCJ0b29scyIsInRpdGxlIiwidG9vbHR5cGUiLCJpY29uIiwic2F2ZWJ0bmxhYmVsIiwibWV0aG9kcyIsInRvZ2dsZUVkaXRpbmciLCJzYXZlRWRpdHMiLCJ0b2dnbGVFZGl0VG9vbCIsImxheWVyQ29kZSIsImVkaXRpbmciLCJlZGl0aW5ndG9vbGJ0blRvZ2dsZWQiLCJlZGl0aW5ndG9vbGJ0bkVuYWJsZWQiLCJ0b29sIiwiY29tcHV0ZWQiLCJlZGl0aW5nYnRubGFiZWwiLCJlZGl0aW5nYnRuRW5hYmxlZCIsImVuYWJsZWQiLCJtZXNzYWdlIiwidG9vbHN0ZXAiLCJ0b3RhbCIsInN0ZXBtZXNzYWdlIiwib25TaG93IiwiY29udGFpbmVyIiwiY29uc29sZSIsImxvZyIsIiRtb3VudCIsIiRhcHBlbmRUbyIsIm9uQ2xvc2UiLCJkZWZlcnJlZCIsIkRlZmVycmVkIiwiJGRlc3Ryb3kiLCJmYWlsIiwicmVqZWN0IiwicHJvbWlzZSIsIi4vcGFuZWwuaHRtbCIsIjkiLCJJdGVybmV0U2VydmljZSIsIl9ydW5uaW5nRWRpdG9yIiwiX2VkaXRvckNsYXNzIiwidmVjdG9yIiwic3R5bGUiLCJjb2xvciIsIlN0eWxlIiwiaW1hZ2UiLCJDaXJjbGUiLCJyYWRpdXMiLCJmaWxsIiwiRmlsbCIsInN0cm9rZSIsIlN0cm9rZSIsIndpZHRoIiwiX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIiLCJfY3VycmVudEVkaXRpbmdMYXllciIsIl9sb2FkZWRFeHRlbnQiLCJzdGFydGluZ0VkaXRpbmdUb29sIiwicmV0cmlldmluZ0RhdGEiLCJoYXNFZGl0cyIsIl9sb2FkZXIiLCJWZWN0b3JMb2FkZXJMYXllciIsIm9wdGlvbnNfbG9hZGVyIiwibGF5ZXJzIiwiYmFzZXVybCIsIm1hcFNlcnZpY2UiLCJib29sIiwidmVjdG9yTGF5ZXJzIiwiX3NldFVwVmVjdG9yTGF5ZXIiLCJfc2V0VXBFZGl0b3IiLCJmZWF0dXJlbG9ja3MiLCJzZXRGZWF0dXJlTG9ja3MiLCJpbnRlcmFjdGlvbiIsImN1cnJlbnRFZGl0aW5nTGF5ZXIiLCJfZ2V0Q3VycmVudEVkaXRpbmdMYXllciIsImFjdGl2ZVRvb2wiLCJpbnN0YW5jZSIsIm93bnNJbnRlcmFjdGlvbiIsIl9zdG9wRWRpdGluZ1Rvb2wiLCJMYXllciIsImdldFByb2plY3QiLCJnZXRMYXllckJ5SWQiLCJnZXRPcmlnTmFtZSIsIl9jYW5jZWxPclNhdmUiLCJfc3RvcEVkaXRpbmciLCJfc3RhcnRFZGl0aW5nIiwiX3N0YXJ0RWRpdGluZ1Rvb2wiLCJfc3RvcEVkaXRvciIsImdldExheWVyQ29kZXMiLCJ2YWx1ZXMiLCJvcHRpb25zX2VkaXRvciIsImZvcm1DbGFzcyIsIkZvcm1DbGFzcyIsInNldFZlY3RvckxheWVyIiwiZGlydHkiLCJsb2FkTGF5ZXJzIiwiX2FkZFRvTWFwIiwiZW1pdCIsIm9uYWZ0ZXIiLCJsb2FkQWxsVmVjdG9yc0RhdGEiLCJyZXNldCIsInJlbW92ZUxheWVyQnlOYW1lIiwiX3VubG9ja0xheWVyIiwiX3VwZGF0ZUVkaXRpbmdTdGF0ZSIsIl9jbGVhblVwIiwiY2xlYW5VcExheWVycyIsIl9zdGFydEVkaXRvciIsIl9zZXRDdXJyZW50RWRpdGluZ0xheWVyIiwiY2FuU3RhcnRUb29sIiwidHlwZSIsIl9hc2tUeXBlIiwiZGlydHlFZGl0b3JzIiwiaXNEaXJ0eSIsImtleXMiLCJfYXNrQ2FuY2VsT3JTYXZlIiwiX3NhdmVFZGl0cyIsImJ1dHRvblR5cGVzIiwiU0FWRSIsImxhYmVsIiwiY2xhc3NOYW1lIiwiY2FsbGJhY2siLCJOT1NBVkUiLCJDQU5DRUwiLCJidXR0b25zIiwic2F2ZSIsIm5vc2F2ZSIsImNhbmNlbCIsIl9zZW5kRWRpdHMiLCJyZXNwb25zZSIsInN1Y2Nlc3MiLCJfY29tbWl0RWRpdHMiLCJyZWZyZXNoTWFwIiwiZXJyb3JzIiwiZWRpdHNUb1B1c2giLCJsYXllcm5hbWUiLCJlZGl0cyIsImdldEVkaXRlZEZlYXR1cmVzIiwiX3Bvc3REYXRhIiwicmV0dXJuZWQiLCJlZGl0b3JzIiwidXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzIiwib2xkZmlkIiwiY2xpZW50aWQiLCJmaWQiLCJnZXRFZGl0VmVjdG9yTGF5ZXIiLCJzZXRGZWF0dXJlRGF0YSIsImNvbW1pdCIsIl91bmRvRWRpdHMiLCJjdXJyZW50RWRpdGluZ0xheWVyQ29kZSIsIl91cGRhdGVUb29sU3RlcHNTdGF0ZSIsInRvb2xJbnN0YW5jZSIsInN0ZXBzIiwiX3NldFRvb2xTdGVwU3RhdGUiLCJzdGVwIiwiaXNVbmRlZmluZWQiLCJtZXNzYWdlcyIsInRvb2xTdGVwc01lc3NhZ2VzIiwiY3VycmVudFN0ZXBJbmRleCIsInRvdGFsU3RlcHMiLCJhZGRUb01hcCIsIl9wb3N0QmF0Y2hEYXRhIiwibGF5ZXJOYW1lIiwianNvbkRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwicG9zdCIsInVybCIsImNvbnRlbnRUeXBlIiwibXVsdGlFZGl0c1RvUHVzaCIsIl91bmxvY2siLCJsYXllckNvbmZpZyIsIkczV09iamVjdCIsIlZlY3RvckxheWVyIiwiVmVjdG9yTGF5ZXJMb2FkZXIiLCJjdXRsaW5lIiwiLi9lZGl0b3JzL2FjY2Vzc2llZGl0b3IiLCIuL2VkaXRvcnMvYXR0cmlidXRlc2Zvcm0iLCIuL2VkaXRvcnMvZ2l1bnppb25pZWRpdG9yIiwiLi9lZGl0b3JzL3N0cmFkZWVkaXRvciJdLCJtYXBwaW5ncyI6IkNBQUEsUUFBVUEsR0FBRUMsRUFBRUMsRUFBRUMsR0FBRyxRQUFTQyxHQUFFQyxFQUFFQyxHQUFHLElBQUlKLEVBQUVHLEdBQUcsQ0FBQyxJQUFJSixFQUFFSSxHQUFHLENBQUMsR0FBSUUsR0FBa0Isa0JBQVRDLFVBQXFCQSxPQUFRLEtBQUlGLEdBQUdDLEVBQUUsTUFBT0EsR0FBRUYsR0FBRSxFQUFJLElBQUdJLEVBQUUsTUFBT0EsR0FBRUosR0FBRSxFQUFJLElBQUlLLEdBQUUsR0FBSUMsT0FBTSx1QkFBdUJOLEVBQUUsSUFBSyxNQUFNSyxHQUFFRSxLQUFLLG1CQUFtQkYsRUFBRSxHQUFJRyxHQUFFWCxFQUFFRyxJQUFJUyxXQUFZYixHQUFFSSxHQUFHLEdBQUdVLEtBQUtGLEVBQUVDLFFBQVEsU0FBU2QsR0FBRyxHQUFJRSxHQUFFRCxFQUFFSSxHQUFHLEdBQUdMLEVBQUcsT0FBT0ksR0FBRUYsRUFBRUEsRUFBRUYsSUFBSWEsRUFBRUEsRUFBRUMsUUFBUWQsRUFBRUMsRUFBRUMsRUFBRUMsR0FBRyxNQUFPRCxHQUFFRyxHQUFHUyxRQUFrRCxJQUFJLEdBQTFDTCxHQUFrQixrQkFBVEQsVUFBcUJBLFFBQWdCSCxFQUFFLEVBQUVBLEVBQUVGLEVB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ME0sT0FBT2lHLFFBQVEwRyxFQUFZclgsS0FBSyxhQUc3Q2hDLEtBQUs2SSxVQUFZLFdBQ2YsTUFBTzdJLE1BQUt1UyxTQXZzQmhCLEdBQUkzUixHQUFVQyxPQUFPQyxLQUFLQyxNQUFNSCxRQUc1QjBZLEdBRmdCelksT0FBT0MsS0FBS0MsTUFBTW9OLFFBQ2xCdE4sT0FBT0MsS0FBS0MsTUFBTStQLE9BQ3RCalEsT0FBT0MsS0FBS3dZLFdBQ3hCL1ksRUFBTU0sT0FBT0csSUFBSVQsSUFFakJpUyxHQURjM1IsT0FBT0MsS0FBS3lZLFlBQ04xWSxPQUFPQyxLQUFLMFksbUJBRWhDakYsRUFBWXpWLEVBQVEsNEJBR3BCVyxFQUFnQlgsRUFBUSwyQkFDeEJ3RSxFQUFrQnhFLEVBQVEsNkJBQzFCb0ksRUFBZXBJLEVBQVEsMEJBR3ZCeVosR0FDRmtCLFNBQ0Usa0NBQ0EsbUNBQ0EsMkRBc3JCSjdZLEdBQVFzUSxFQUFlb0ksR0FFdkI5WixFQUFPSixRQUFVLEdBQUk4UixLQUNsQndJLDBCQUEwQixFQUFFQywyQkFBMkIsRUFBRUMsNEJBQTRCLEVBQUVDLHlCQUF5QixTQUFTIiwiZmlsZSI6ImJ1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIEdVSSA9IGczd3Nkay5ndWkuR1VJO1xudmFyIEl0ZXJuZXRFZGl0b3IgPSByZXF1aXJlKCcuL2l0ZXJuZXRlZGl0b3InKTtcblxuZnVuY3Rpb24gQWNjZXNzaUVkaXRvcihvcHRpb25zKXtcbiAgdmFyIGNvcHlBbmRQYXN0ZUZpZWxkc05vdE92ZXJ3cml0YWJsZSA9IHtcbiAgICAnbGF5ZXInOiAgWydjb2RfYWNjJ10sXG4gICAgJ3JlbGF0aW9ucyc6IHtcbiAgICAgICAgJ2ludGVybm8nOiBbJ2NvZF9hY2MnXSxcbiAgICAgICAgJ251bWVyb19jaXZpY28nOiBbJ2NvZF9jaXYnXVxuICAgIH1cbiAgfTtcbiAgb3B0aW9ucy5jb3B5QW5kUGFzdGVGaWVsZHNOb3RPdmVyd3JpdGFibGUgPSBjb3B5QW5kUGFzdGVGaWVsZHNOb3RPdmVyd3JpdGFibGU7XG4gIHZhciBvcHRpb25zID0gb3B0aW9ucztcbiAgLy9zb3ZyYXNjcml2byBhc2tjb25maXJtIGxpc3RlbmVyc1xuICB0aGlzLl9hc2tDb25maXJtVG9EZWxldGVFZGl0aW5nTGlzdGVuZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm9uYmVmb3JlYXN5bmMoJ2RlbGV0ZUZlYXR1cmUnLCBmdW5jdGlvbiAoZmVhdHVyZSwgaXNOZXcsIG5leHQpIHtcbiAgICAgIGlmIChmZWF0dXJlLmdldCgndGlwX2FjYycpID09IFwiMDEwMlwiKSB7XG4gICAgICAgIEdVSS5kaWFsb2cuY29uZmlybShcIlZ1b2kgZWxpbWluYXJlIGwnZWxlbWVudG8gc2VsZXppb25hdG8gZSBnbGkgZWxlbWVudGkgYWQgZXNzaSBjb2xsZWdhdGk/XCIsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICBuZXh0KHJlc3VsdCk7XG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyB2YWRvIGEgcmljaGlhbWFyZSBpbCBkaWFsb2cgcGFkcmVcbiAgICAgICAgYmFzZSh0aGlzLCdfZGVsZXRlRmVhdHVyZURpYWxvZycsbmV4dCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIGJhc2UodGhpcyxvcHRpb25zKTtcbn1cblxuaW5oZXJpdChBY2Nlc3NpRWRpdG9yLCBJdGVybmV0RWRpdG9yKTtcblxubW9kdWxlLmV4cG9ydHMgPSBBY2Nlc3NpRWRpdG9yO1xuXG59LHtcIi4vaXRlcm5ldGVkaXRvclwiOjR9XSwyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbnZhciBpbmhlcml0ID0gZzN3c2RrLmNvcmUudXRpbHMuaW5oZXJpdDtcbnZhciBiYXNlID0gZzN3c2RrLmNvcmUudXRpbHMuYmFzZTtcbnZhciBQcm9qZWN0c1JlZ2lzdHJ5ID0gZzN3c2RrLmNvcmUuUHJvamVjdHNSZWdpc3RyeTtcbnZhciBGb3JtUGFuZWwgPSBnM3dzZGsuZ3VpLkZvcm1QYW5lbDtcbnZhciBGb3JtID0gZzN3c2RrLmd1aS5Gb3JtO1xuXG52YXIgSXRlcm5ldEZvcm1QYW5lbCA9IEZvcm1QYW5lbC5leHRlbmQoe1xuICAvL3RlbXBsYXRlOiByZXF1aXJlKCcuL2F0dHJpYnV0ZXNmb3JtLmh0bWwnKVxufSk7XG5cbmZ1bmN0aW9uIEl0ZXJuZXRGb3JtKG9wdGlvbnMpe1xuICBiYXNlKHRoaXMsb3B0aW9ucyk7XG4gIHRoaXMuX2Zvcm1QYW5lbCA9IEl0ZXJuZXRGb3JtUGFuZWw7XG59XG5pbmhlcml0KEl0ZXJuZXRGb3JtLEZvcm0pO1xuXG52YXIgcHJvdG8gPSBJdGVybmV0Rm9ybS5wcm90b3R5cGU7XG5cbnByb3RvLl9pc1Zpc2libGUgPSBmdW5jdGlvbihmaWVsZCl7XG4gIHZhciByZXQgPSB0cnVlO1xuICBzd2l0Y2ggKGZpZWxkLm5hbWUpe1xuICAgIGNhc2UgXCJjb2RfYWNjX2VzdFwiOlxuICAgICAgdmFyIHRpcF9hY2MgPSB0aGlzLl9nZXRGaWVsZChcInRpcF9hY2NcIik7XG4gICAgICBpZiAodGlwX2FjYy52YWx1ZT09XCIwMTAxXCIpe1xuICAgICAgICByZXQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjb2RfYWNjX2ludFwiOlxuICAgICAgdmFyIHRpcF9hY2MgPSB0aGlzLl9nZXRGaWVsZChcInRpcF9hY2NcIik7XG4gICAgICBpZiAodGlwX2FjYy52YWx1ZT09XCIwMTAxXCIgfHwgdGlwX2FjYy52YWx1ZT09XCIwNTAxXCIpe1xuICAgICAgICByZXQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICB9XG4gIHJldHVybiByZXQ7XG59O1xuXG5wcm90by5faXNFZGl0YWJsZSA9IGZ1bmN0aW9uKGZpZWxkKXtcbiAgaWYgKGZpZWxkLm5hbWUgPT0gXCJ0aXBfYWNjXCIgJiYgIXRoaXMuX2lzTmV3KCkpe1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgcmV0dXJuIEZvcm0ucHJvdG90eXBlLl9pc0VkaXRhYmxlLmNhbGwodGhpcyxmaWVsZCk7XG59O1xuXG5wcm90by5fc2hvdWxkU2hvd1JlbGF0aW9uID0gZnVuY3Rpb24ocmVsYXRpb24pe1xuICBpZiAocmVsYXRpb24ubmFtZT09XCJudW1lcm9fY2l2aWNvXCIpe1xuICAgIHZhciB0aXBfYWNjID0gdGhpcy5fZ2V0RmllbGQoXCJ0aXBfYWNjXCIpO1xuICAgIGlmICh0aXBfYWNjLnZhbHVlID09ICcwMTAyJyl7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufTtcblxucHJvdG8uX3BpY2tMYXllciA9IGZ1bmN0aW9uKGZpZWxkKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgbGF5ZXJJZCA9IGZpZWxkLmlucHV0Lm9wdGlvbnMubGF5ZXJpZDtcbiAgXG4gIEZvcm0ucHJvdG90eXBlLl9waWNrTGF5ZXIuY2FsbCh0aGlzLGZpZWxkKVxuICAudGhlbihmdW5jdGlvbihhdHRyaWJ1dGVzKXtcbiAgICB2YXIgbGlua2VkRmllbGQ7XG4gICAgdmFyIGxpbmtlZEZpZWxkQXR0cmlidXRlTmFtZTtcbiAgICBcbiAgICBzd2l0Y2ggKGZpZWxkLm5hbWUpIHtcbiAgICAgIGNhc2UgJ2NvZF9lbGUnOlxuICAgICAgICBsaW5rZWRGaWVsZCA9IHNlbGYuX2dldFJlbGF0aW9uRmllbGQoXCJjb2RfdG9wXCIsXCJudW1lcm9fY2l2aWNvXCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2NvZF90b3AnOlxuICAgICAgICBsaW5rZWRGaWVsZCA9IHNlbGYuX2dldEZpZWxkKFwiY29kX2VsZVwiKTs7XG4gICAgfVxuICAgIFxuICAgIGlmIChsaW5rZWRGaWVsZCkge1xuICAgICAgdmFyIHByb2plY3QgPSBQcm9qZWN0c1JlZ2lzdHJ5LmdldEN1cnJlbnRQcm9qZWN0KCk7XG4gICAgICBsaW5rZWRGaWVsZEF0dHJpYnV0ZU5hbWUgPSBwcm9qZWN0LmdldExheWVyQXR0cmlidXRlTGFiZWwobGF5ZXJJZCxsaW5rZWRGaWVsZC5pbnB1dC5vcHRpb25zLmZpZWxkKTtcbiAgICAgIGlmIChsaW5rZWRGaWVsZCAmJiBhdHRyaWJ1dGVzW2xpbmtlZEZpZWxkQXR0cmlidXRlTmFtZV0pe1xuICAgICAgICBsaW5rZWRGaWVsZC52YWx1ZSA9IGF0dHJpYnV0ZXNbbGlua2VkRmllbGRBdHRyaWJ1dGVOYW1lXTtcbiAgICAgIH1cbiAgICB9XG4gIH0pXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEl0ZXJuZXRGb3JtO1xuXG59LHt9XSwzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbnZhciBpbmhlcml0ID0gZzN3c2RrLmNvcmUudXRpbHMuaW5oZXJpdDtcbnZhciBiYXNlID0gZzN3c2RrLmNvcmUudXRpbHMuYmFzZTtcbnZhciBJdGVybmV0RWRpdG9yID0gcmVxdWlyZSgnLi9pdGVybmV0ZWRpdG9yJyk7XG5cbmZ1bmN0aW9uIEdpdW56aW9uaUVkaXRvcihvcHRpb25zKXtcbiAgYmFzZSh0aGlzLG9wdGlvbnMpO1xuICBcbiAgdGhpcy5fc2VydmljZSA9IG51bGw7XG4gIHRoaXMuX3N0cmFkZUVkaXRvciA9IG51bGw7XG4gIHRoaXMuX2dpdW56aW9uZUdlb21MaXN0ZW5lciA9IG51bGw7XG4gIFxuICAvKiBJTklaSU8gTU9ESUZJQ0EgVE9QT0xPR0lDQSBERUxMRSBHSVVOWklPTkkgKi9cbiAgXG4gIHRoaXMuX3NldHVwTW92ZUdpdW56aW9uaUxpc3RlbmVyID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5vbignbW92ZXN0YXJ0JyxmdW5jdGlvbihmZWF0dXJlKXtcbiAgICAgIC8vIHJpbXVvdm8gZXZlbnR1YWxpIHByZWNlZGVudGkgbGlzdGVuZXJzXG4gICAgICBzZWxmLl9zdGFydE1vdmluZ0dpdW56aW9uZShmZWF0dXJlKTtcbiAgICB9KTtcbiAgfTtcbiAgXG4gIHRoaXMuX3N0cmFkZVRvVXBkYXRlID0gW107XG4gIFxuICB0aGlzLl9zdGFydE1vdmluZ0dpdW56aW9uZSA9IGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdmVjdG9yTGF5ZXIgPSB0aGlzLmdldFZlY3RvckxheWVyKCk7XG4gICAgdmFyIHN0cmFkZUVkaXRvciA9IHRoaXMuX3N0cmFkZUVkaXRvcjtcbiAgICB2YXIgZ2l1bnppb25lID0gZmVhdHVyZTtcbiAgICB2YXIgY29kX2dueiA9IGdpdW56aW9uZS5nZXQoJ2NvZF9nbnonKTtcbiAgICAvLyBkZXZvIGF2dmlhcmUgbCdlZGl0b3IgZGVsbGUgc3RyYWRlXG4gICAgdGhpcy5fc3RyYWRlVG9VcGRhdGUgPSBbXTtcbiAgICB2YXIgc3RyYWRlID0gc3RyYWRlRWRpdG9yLmdldFZlY3RvckxheWVyKCkuZ2V0U291cmNlKCkuZ2V0RmVhdHVyZXMoKTtcbiAgICBfLmZvckVhY2goc3RyYWRlLGZ1bmN0aW9uKHN0cmFkYSl7XG4gICAgICB2YXIgbm9kX2luaSA9IHN0cmFkYS5nZXQoJ25vZF9pbmknKTtcbiAgICAgIHZhciBub2RfZmluID0gc3RyYWRhLmdldCgnbm9kX2ZpbicpO1xuICAgICAgdmFyIGluaSA9IChub2RfaW5pID09IGNvZF9nbnopO1xuICAgICAgdmFyIGZpbiA9IChub2RfZmluID09IGNvZF9nbnopO1xuICAgICAgaWYgKGluaSB8fCBmaW4pe1xuICAgICAgICB2YXIgaW5pdGlhbCA9IGluaSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgc2VsZi5fc3RyYWRlVG9VcGRhdGUucHVzaChzdHJhZGEpO1xuICAgICAgICBzZWxmLl9zdGFydEdpdW56aW9uaVN0cmFkZVRvcG9sb2dpY2FsRWRpdGluZyhnaXVuemlvbmUsc3RyYWRhLGluaXRpYWwpXG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5vbmNlKCdtb3ZlZW5kJyxmdW5jdGlvbihmZWF0dXJlKXtcbiAgICAgIGlmICggc2VsZi5fc3RyYWRlVG9VcGRhdGUubGVuZ3RoKXtcbiAgICAgICAgaWYgKCFzdHJhZGVFZGl0b3IuaXNTdGFydGVkKCkpe1xuICAgICAgICAgIHN0cmFkZUVkaXRvci5zdGFydCh0aGlzLl9zZXJ2aWNlKTtcbiAgICAgICAgfVxuICAgICAgICBfLmZvckVhY2goIHNlbGYuX3N0cmFkZVRvVXBkYXRlLGZ1bmN0aW9uKHN0cmFkYSl7XG4gICAgICAgICAgc3RyYWRlRWRpdG9yLnVwZGF0ZUZlYXR1cmUoc3RyYWRhKTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgXG4gIHRoaXMuX3N0YXJ0R2l1bnppb25pU3RyYWRlVG9wb2xvZ2ljYWxFZGl0aW5nID0gZnVuY3Rpb24oZ2l1bnppb25lLHN0cmFkYSxpbml0aWFsKXtcbiAgICB2YXIgc3RyYWRhR2VvbSA9IHN0cmFkYS5nZXRHZW9tZXRyeSgpO1xuICAgIHZhciBzdHJhZGFDb29yZHMgPSBzdHJhZGEuZ2V0R2VvbWV0cnkoKS5nZXRDb29yZGluYXRlcygpO1xuICAgIHZhciBjb29yZEluZGV4ID0gaW5pdGlhbCA/IDAgOiBzdHJhZGFDb29yZHMubGVuZ3RoLTE7XG4gICAgdmFyIGdpdW56aW9uZUdlb20gPSBnaXVuemlvbmUuZ2V0R2VvbWV0cnkoKTtcbiAgICB2YXIgbGlzdGVuZXJLZXkgPSBnaXVuemlvbmVHZW9tLm9uKCdjaGFuZ2UnLGZ1bmN0aW9uKGUpe1xuICAgICAgc3RyYWRhQ29vcmRzW2Nvb3JkSW5kZXhdID0gZS50YXJnZXQuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICAgIHN0cmFkYUdlb20uc2V0Q29vcmRpbmF0ZXMoc3RyYWRhQ29vcmRzKTtcbiAgICB9KTtcbiAgICB0aGlzLl9naXVuemlvbmVHZW9tTGlzdGVuZXIgPSBsaXN0ZW5lcktleTtcbiAgfTtcbiAgXG4gIC8qIEZJTkUgTU9ESUZJQ0EgVE9QT0xPR0lDQSBHSVVOWklPTkkgKi9cbiAgXG4gIC8qIElOSVpJTyBSSU1PWklPTkUgR0lVTlpJT05JICovXG4gIFxuICB0aGlzLl9zZXR1cERlbGV0ZUdpdW56aW9uaUxpc3RlbmVyID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHN0cmFkZUVkaXRvciA9IHRoaXMuX3N0cmFkZUVkaXRvcjtcbiAgICB0aGlzLm9uYmVmb3JlYXN5bmMoJ2RlbGV0ZUZlYXR1cmUnLGZ1bmN0aW9uKGZlYXR1cmUsaXNOZXcsbmV4dCl7XG4gICAgICB2YXIgc3RvcERlbGV0aW9uID0gZmFsc2U7XG4gICAgICB2YXIgc3RyYWRlVmVjdG9yTGF5ZXIgPSBzdHJhZGVFZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgICAgIF8uZm9yRWFjaChzdHJhZGVWZWN0b3JMYXllci5nZXRGZWF0dXJlcygpLGZ1bmN0aW9uKHN0cmFkYSl7XG4gICAgICAgIHZhciBjb2RfZ256ID0gZmVhdHVyZS5nZXQoJ2NvZF9nbnonKTtcbiAgICAgICAgdmFyIG5vZF9pbmkgPSBzdHJhZGEuZ2V0KCdub2RfaW5pJyk7XG4gICAgICAgIHZhciBub2RfZmluID0gc3RyYWRhLmdldCgnbm9kX2ZpbicpO1xuICAgICAgICB2YXIgaW5pID0gKG5vZF9pbmkgPT0gY29kX2dueik7XG4gICAgICAgIHZhciBmaW4gPSAobm9kX2ZpbiA9PSBjb2RfZ256KTtcbiAgICAgICAgaWYgKGluaSB8fCBmaW4pe1xuICAgICAgICAgIHN0b3BEZWxldGlvbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoc3RvcERlbGV0aW9uKXtcbiAgICAgICAgR1VJLm5vdGlmeS5lcnJvcihcIk5vbiDDqCBwb3NzaWJpbGUgcmltdW92ZXJlIGxhIGdpdW56aW9uaSBwZXJjaMOpIHJpc3VsdGEgY29ubmVzc2EgYWQgdW5hIG8gcGnDuSBzdHJhZGVcIik7XG4gICAgICB9XG4gICAgICBuZXh0KCFzdG9wRGVsZXRpb24pO1xuICAgIH0pO1xuICB9O1xuICBcbiAgLyogRklORSAqL1xufVxuaW5oZXJpdChHaXVuemlvbmlFZGl0b3IsSXRlcm5ldEVkaXRvcik7XG5tb2R1bGUuZXhwb3J0cyA9IEdpdW56aW9uaUVkaXRvcjtcblxudmFyIHByb3RvID0gR2l1bnppb25pRWRpdG9yLnByb3RvdHlwZTtcblxucHJvdG8uc3RhcnQgPSBmdW5jdGlvbihpdGVybmV0U2VydmljZSkge1xuICB0aGlzLl9zZXJ2aWNlID0gaXRlcm5ldFNlcnZpY2U7XG4gIHRoaXMuX3N0cmFkZUVkaXRvciA9IGl0ZXJuZXRTZXJ2aWNlLl9sYXllcnNbaXRlcm5ldFNlcnZpY2UubGF5ZXJDb2Rlcy5TVFJBREVdLmVkaXRvcjtcbiAgdGhpcy5fc2V0dXBNb3ZlR2l1bnppb25pTGlzdGVuZXIoKTtcbiAgdGhpcy5fc2V0dXBEZWxldGVHaXVuemlvbmlMaXN0ZW5lcigpO1xuICByZXR1cm4gSXRlcm5ldEVkaXRvci5wcm90b3R5cGUuc3RhcnQuY2FsbCh0aGlzKTtcbn07XG5cbnByb3RvLnN0b3AgPSBmdW5jdGlvbigpe1xuICB2YXIgcmV0ID0gZmFsc2U7XG4gIGlmIChJdGVybmV0RWRpdG9yLnByb3RvdHlwZS5zdG9wLmNhbGwodGhpcykpe1xuICAgIHJldCA9IHRydWU7XG4gICAgb2wuT2JzZXJ2YWJsZS51bkJ5S2V5KHRoaXMuX2dpdW56aW9uZUdlb21MaXN0ZW5lcik7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn07XG5cbnByb3RvLnNldFRvb2wgPSBmdW5jdGlvbih0b29sVHlwZSl7XG4gIHZhciBvcHRpb25zO1xuICBpZiAodG9vbFR5cGU9PSdhZGRmZWF0dXJlJyl7XG4gICAgb3B0aW9ucyA9IHtcbiAgICAgIHNuYXA6IHtcbiAgICAgICAgdmVjdG9yTGF5ZXI6IHRoaXMuX3N0cmFkZUVkaXRvci5nZXRWZWN0b3JMYXllcigpXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBJdGVybmV0RWRpdG9yLnByb3RvdHlwZS5zZXRUb29sLmNhbGwodGhpcyx0b29sVHlwZSxvcHRpb25zKTtcbn07XG5cbn0se1wiLi9pdGVybmV0ZWRpdG9yXCI6NH1dLDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIEVkaXRvciA9IGczd3Nkay5jb3JlLkVkaXRvcjtcblxudmFyIEZvcm0gPSByZXF1aXJlKCcuL2F0dHJpYnV0ZXNmb3JtJyk7XG52YXIgZm9ybSA9IG51bGw7IC8vIGJydXR0byBtYSBkZXZvIHRlbmVybG8gZXN0ZXJubyBzZW5uw7Igc2kgY3JlYSB1biBjbGljbyBkaSByaWZlcmltZW50aSBjaGUgbWFuZGEgaW4gcGFsbGEgVnVlXG4gIFxuZnVuY3Rpb24gSXRlcm5ldEVkaXRvcihvcHRpb25zKSB7XG5cbiAgLy8gaW4gcXVlc3RvIG1vZG8gcGFzc2lhbW8gaWwgbWFwc2VydmljZSBjb21lIGFyZ29tZW50byBhbCBzdXBlcmNsYXNzIChlZGl0b3IpXG4gIC8vIGRpIGl0ZXJuZXRlZGl0b3IgaW4gbW9kbyBkYSBhc3NlZ25hcmFlIGFuY2hlIGEgaXRlcm5ldGVkaXRvciBpbCBtYXBzZXJ2ZWljZSBjaGUgeHNlcnZpcsOgIGFkIGVzZW1waW8gYWQgYWdnaXVuZ2VyZVxuICAvLyBsJ2ludGVyYWN0aW9uIGFsbGEgbWFwcGEgcXVhbmRvIHZpZW5lIGNsaWNjYXRvIHN1IHVuIHRvb2xcbiAgYmFzZSh0aGlzLCBvcHRpb25zKTtcbiAgLy8gYXByZSBmb3JtIGF0dHJpYnV0aSBwZXIgaW5zZXJpbWVudG9cbn1cbmluaGVyaXQoSXRlcm5ldEVkaXRvciwgRWRpdG9yKTtcblxubW9kdWxlLmV4cG9ydHMgPSBJdGVybmV0RWRpdG9yO1xuXG59LHtcIi4vYXR0cmlidXRlc2Zvcm1cIjoyfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgR1VJID0gZzN3c2RrLmd1aS5HVUk7XG52YXIgSXRlcm5ldEVkaXRvciA9IHJlcXVpcmUoJy4vaXRlcm5ldGVkaXRvcicpO1xuXG5cbmZ1bmN0aW9uIFN0cmFkZUVkaXRvcihvcHRpb25zKXtcbiAgYmFzZSh0aGlzLG9wdGlvbnMpO1xuICBcbiAgdGhpcy5fc2VydmljZSA9IG51bGw7XG4gIHRoaXMuX2dpdW56aW9uaUVkaXRvciA9IG51bGw7XG4gIFxuICB0aGlzLl9tYXBTZXJ2aWNlID0gR1VJLmdldENvbXBvbmVudCgnbWFwJykuZ2V0U2VydmljZSgpO1xuICBcbiAgdGhpcy5fc3RyYWRlU25hcHMgPSBudWxsO1xuICBcbiAgdGhpcy5fc3RyYWRlU25hcHNDb2xsZWN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc25hcHMgPSBbXTtcbiAgICB0aGlzLmxlbmd0aCA9IDA7XG4gICAgXG4gICAgdGhpcy5wdXNoID0gZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICB2YXIgcHVzaGVkID0gZmFsc2U7XG4gICAgICBpZiAodGhpcy5jYW5TbmFwKGZlYXR1cmUpKXtcbiAgICAgICAgc25hcHMucHVzaChmZWF0dXJlKTtcbiAgICAgICAgdGhpcy5sZW5ndGggKz0gMTtcbiAgICAgICAgcHVzaGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwdXNoZWQ7XG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmdldExhc3QgPSBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHNuYXBzW3NuYXBzLmxlbmd0aC0xXTtcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuZ2V0Rmlyc3QgPSBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHNuYXBzWzBdO1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKCl7XG4gICAgICBzbmFwcy5zcGxpY2UoMCxzbmFwcy5sZW5ndGgpO1xuICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5nZXRTbmFwcyA9IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gc25hcHM7XG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmNhblNuYXAgPSBmdW5jdGlvbihmZWF0dXJlKXtcbiAgICAgIGlmICh0aGlzLmlzQWxyZWFkeVNuYXBwZWQoZmVhdHVyZSkpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgY29kX2dueiA9IGZlYXR1cmUuZ2V0KCdjb2RfZ256Jyk7XG4gICAgICByZXR1cm4gKCFfLmlzTmlsKGNvZF9nbnopICYmIGNvZF9nbnogIT0gJycpO1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5pc0FscmVhZHlTbmFwcGVkID0gZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICByZXR1cm4gXy5pbmNsdWRlcyh0aGlzLnNuYXBzLGZlYXR1cmUpO1xuICAgIH1cbiAgfTtcbiAgXG4gIHRoaXMuX3VwZGF0ZVN0cmFkYUF0dHJpYnV0ZXMgPSBmdW5jdGlvbihmZWF0dXJlKXtcbiAgICB2YXIgc25hcHMgPSB0aGlzLl9zdHJhZGVTbmFwcztcbiAgICBmZWF0dXJlLnNldCgnbm9kX2luaScsc25hcHMuZ2V0U25hcHMoKVswXS5nZXQoJ2NvZF9nbnonKSk7XG4gICAgZmVhdHVyZS5zZXQoJ25vZF9maW4nLHNuYXBzLmdldFNuYXBzKClbMV0uZ2V0KCdjb2RfZ256JykpO1xuICB9O1xuICBcbiAgLyogQ09OVFJPTExPIEdJVU5aSU9OSSBQRVIgTEUgU1RSQURFIE5PTiBDT01QTEVUQU1FTlRFIENPTlRFTlVURSBORUxMQSBWSVNUQSAqL1xuICBcbiAgLy8gcGVyIGxlIHN0cmFkZSBwcmVzZW50aSBuZWxsYSB2aXN0YSBjYXJpY2EgbGUgZ2l1bnppb25pIGV2ZW50dWFsbWVudGUgbWFuY2FudGkgKGVzdGVybmUgYWxsYSB2aXN0YSlcbiAgdGhpcy5fbG9hZE1pc3NpbmdHaXVuemlvbmlJblZpZXcgPSBmdW5jdGlvbigpe1xuICAgIHZhciB2ZWN0b3JMYXllciA9IHRoaXMuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgICB2YXIgZ2l1bnppb25pVmVjdG9yTGF5ZXIgPSB0aGlzLl9naXVuemlvbmlFZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgICBcbiAgICB2YXIgc3RyYWRlU291cmNlID0gdmVjdG9yTGF5ZXIuZ2V0U291cmNlKCk7XG4gICAgdmFyIGV4dGVudCA9IG9sLmV4dGVudC5idWZmZXIoc3RyYWRlU291cmNlLmdldEV4dGVudCgpLDEpO1xuICAgIHZhciBsb2FkZXIgPSB0aGlzLl9zZXJ2aWNlLmdldExvYWRlcigpO1xuICAgIGxvYWRlci5fbG9hZFZlY3RvckRhdGEoZ2l1bnppb25pVmVjdG9yTGF5ZXIsZXh0ZW50KTtcbiAgfTtcbiAgXG4gIC8qIEZJTkUgKi9cbiAgXG4gIC8qIElOSVpJTyBHRVNUSU9ORSBWSU5DT0xPIFNOQVAgU1UgR0lVTlpJT05JIERVUkFOVEUgSUwgRElTRUdOTyBERUxMRSBTVFJBREUgKi9cbiAgXG4gIHRoaXMuX2RyYXdSZW1vdmVMYXN0UG9pbnQgPSBfLmJpbmQoZnVuY3Rpb24oZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB0b29sVHlwZSA9IHRoaXMuZ2V0QWN0aXZlVG9vbCgpLmdldFR5cGUoKTtcbiAgICAvLyBpbCBsaXN0ZW5lciB2aWVuZSBhdHRpdmF0byBwZXIgdHV0dGkgaSB0b29sIGRlbGwnZWRpdG9yIHN0cmFkZSwgcGVyIGN1aSBkZXZvIGNvbnRyb2xsYXJlIGNoZSBzaWEgcXVlbGxvIGdpdXN0b1xuICAgIGlmICh0b29sVHlwZSA9PSAnYWRkZmVhdHVyZScpe1xuICAgICAgLy8gQ0FOQ1xuICAgICAgaWYoZS5rZXlDb2RlPT00Nil7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgc2VsZi5nZXRBY3RpdmVUb29sKCkuZ2V0VG9vbCgpLnJlbW92ZUxhc3RQb2ludCgpO1xuICAgICAgfVxuICAgIH1cbiAgfSx0aGlzKTtcbiAgXG4gIHRoaXMuX3NldHVwRHJhd1N0cmFkZUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIG1hcElkID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwLmdldFRhcmdldEVsZW1lbnQoKS5pZDtcbiAgICB2YXIgbWFwID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwO1xuICAgIFxuICAgIHZhciBkcmF3aW5nR2VvbWV0cnkgPSBudWxsO1xuICAgIFxuICAgIHRoaXMub25iZWZvcmUoJ2FkZEZlYXR1cmUnLGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgICAgdmFyIHNuYXBzID0gc2VsZi5fc3RyYWRlU25hcHM7XG4gICAgICBpZiAoc25hcHMubGVuZ3RoID09IDIpe1xuICAgICAgICBzZWxmLl91cGRhdGVTdHJhZGFBdHRyaWJ1dGVzKGZlYXR1cmUpO1xuICAgICAgICBzbmFwcy5jbGVhcigpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LDApO1xuICB9O1xuICBcbiAgdGhpcy5fZ2V0Q2hlY2tTbmFwc0NvbmRpdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIC8vIGFkIG9nbmkgY2xpY2sgY29udHJvbGxvIHNlIGNpIHNvbm8gZGVnbGkgc25hcCBjb24gbGUgZ2l1bnppb25pXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGUpe1xuICAgICAgdmFyIHNuYXBzID0gc2VsZi5fc3RyYWRlU25hcHM7XG4gICAgICBpZiAoc25hcHMubGVuZ3RoID09IDIpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIEdVSS5ub3RpZnkuZXJyb3IoXCJMJ3VsdGltbyB2ZXJ0aWNlIGRldmUgY29ycmlzcG9uZGVyZSBjb24gdW5hIGdpdW56aW9uZVwiKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG4gIFxuICAvLyBhZCBvZ25pIGNsaWNrIGNvbnRyb2xsbyBzZSBjaSBzb25vIGRlZ2xpIHNuYXAgY29uIGxlIGdpdW56aW9uaVxuICB0aGlzLl9nZXRTdHJhZGFJc0JlaW5nU25hcHBlZENvbmRpdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBtYXAgPSB0aGlzLl9tYXBTZXJ2aWNlLnZpZXdlci5tYXA7XG4gICAgdmFyIGdpdW56aW9uaVZlY3RvckxheWVyID0gdGhpcy5fZ2l1bnppb25pRWRpdG9yLmdldFZlY3RvckxheWVyKCk7XG4gICAgXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGUpe1xuICAgICAgdmFyIHNuYXBzID0gc2VsZi5fc3RyYWRlU25hcHM7XG4gICAgICB2YXIgYyA9IG1hcC5nZXRDb29yZGluYXRlRnJvbVBpeGVsKGUucGl4ZWwpO1xuICAgICAgdmFyIGdpdW56aW9uaVNvdXJjZSA9IGdpdW56aW9uaVZlY3RvckxheWVyLmdldFNvdXJjZSgpO1xuICAgICAgdmFyIGV4dGVudCA9IG9sLmV4dGVudC5idWZmZXIoW2NbMF0sY1sxXSxjWzBdLGNbMV1dLDEpO1xuICAgICAgdmFyIHNuYXBwZWRGZWF0dXJlID0gZ2l1bnppb25pU291cmNlLmdldEZlYXR1cmVzSW5FeHRlbnQoZXh0ZW50KVswXTtcbiAgICAgIFxuICAgICAgLy8gc2UgaG8gZ2nDoCBkdWUgc25hcCBlIHF1ZXN0byBjbGljayBub24gw6ggc3UgdW4nYWx0cmEgZ2l1bnppb25lLCBvcHB1cmUgc2UgaG8gcGnDuSBkaSAyIHNuYXAsIG5vbiBwb3NzbyBpbnNlcmlyZSB1biB1bHRlcmlvcmUgdmVydGljZVxuICAgICAgaWYgKChzbmFwcy5sZW5ndGggPT0gMiAmJiAoIXNuYXBwZWRGZWF0dXJlIHx8IHNuYXBwZWRGZWF0dXJlICE9IHNuYXBzLmdldFNuYXBzKClbMV0pKSl7XG4gICAgICAgIHZhciBsYXN0U25hcHBlZFxuICAgICAgICBHVUkubm90aWZ5LmVycm9yKFwiVW5hIHN0cmFkYSBub24gcHXDsiBhdmVyZSB2ZXJ0aWNpIGludGVybWVkaSBpbiBjb3JyaXNwb25kZW56YSBkaSBnaXVuemlvbmkuPGJyPiBQcmVtZXJlIDxiPkNBTkM8L2I+IHBlciByaW11b3ZlcmUgbCd1bHRpbW8gdmVydGljZS5cIik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHNuYXBwZWRGZWF0dXJlICYmIHNuYXBzLmxlbmd0aCA8IDIpe1xuICAgICAgICBzbmFwcy5wdXNoKHNuYXBwZWRGZWF0dXJlKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gc2Ugbm9uIGNpIHNvbm8gc25hcCwgdnVvbCBkaXJlIGNoZSBzb25vIGFuY29yYSBhbCBwcmltbyBjbGljayBlIG5vbiBobyBzbmFwcGF0byBjb24gbGEgZ2l1bnppb25lIGluaXppYWxlXG4gICAgICBpZiAoc25hcHMubGVuZ3RoID09IDApe1xuICAgICAgICBHVUkubm90aWZ5LmVycm9yKFwiSWwgcHJpbW8gdmVydGljZSBkZXZlIGNvcnJpc3BvbmRlcmUgY29uIHVuYSBnaXVuemlvbmVcIik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfTtcbiAgXG4gIC8qIEZJTkUgRElTRUdOTyAqL1xuICBcbiAgLyogSU5JWklPIENPTlRST0xMSSBTVSBNT0RJRklDQSAqL1xuICBcbiAgdGhpcy5fbW9kaWZ5UmVtb3ZlUG9pbnQgPSBfLmJpbmQoZnVuY3Rpb24oZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB0b29sVHlwZSA9IHRoaXMuZ2V0QWN0aXZlVG9vbCgpLmdldFR5cGUoKTtcbiAgICBpZiAodG9vbFR5cGUgPT0gJ21vZGlmeXZlcnRleCcpe1xuICAgICAgaWYoZS5rZXlDb2RlPT00Nil7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgc2VsZi5nZXRBY3RpdmVUb29sKCkuZ2V0VG9vbCgpLnJlbW92ZVBvaW50KCk7XG4gICAgICB9XG4gICAgfVxuICB9LHRoaXMpO1xuICBcbiAgdGhpcy5fc2V0dXBNb2RpZnlWZXJ0ZXhTdHJhZGVDb25zdHJhaW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBtYXAgPSB0aGlzLl9tYXBTZXJ2aWNlLnZpZXdlci5tYXA7XG4gICAgdGhpcy5vbmJlZm9yZSgnbW9kaWZ5RmVhdHVyZScsZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICB2YXIgc25hcHMgPSBzZWxmLl9zdHJhZGVTbmFwcztcbiAgICAgIHZhciBjb3JyZWN0ID0gc2VsZi5fY2hlY2tTdHJhZGFJc0NvcnJlY3RseVNuYXBwZWQoZmVhdHVyZS5nZXRHZW9tZXRyeSgpKTtcbiAgICAgIGlmIChjb3JyZWN0KXtcbiAgICAgICAgc2VsZi5fdXBkYXRlU3RyYWRhQXR0cmlidXRlcyhmZWF0dXJlKTtcbiAgICAgICAgc25hcHMuY2xlYXIoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb3JyZWN0O1xuICAgIH0pO1xuICB9O1xuICBcbiAgdGhpcy5fY2hlY2tTdHJhZGFJc0NvcnJlY3RseVNuYXBwZWQgPSBmdW5jdGlvbihnZW9tZXRyeSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciByZXQgPSB0cnVlO1xuICAgIHZhciBtYXAgPSB0aGlzLl9tYXBTZXJ2aWNlLnZpZXdlci5tYXA7XG4gICAgdmFyIGdpdW56aW9uaVZlY3RvckxheWVyID0gdGhpcy5fZ2l1bnppb25pRWRpdG9yLmdldFZlY3RvckxheWVyKCk7XG4gICAgdGhpcy5fc3RyYWRlU25hcHMuY2xlYXIoKTtcbiAgICB2YXIgc25hcHMgPSB0aGlzLl9zdHJhZGVTbmFwcztcbiAgICB2YXIgY29vcmRpbmF0ZXMgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuICAgIFxuICAgIHZhciBmaXJzdFZlcnRleFNuYXBwZWQgPSBmYWxzZTtcbiAgICB2YXIgbGFzdFZlcnRleFNuYXBwZWQgPSBmYWxzZTtcbiAgICBcbiAgICBfLmZvckVhY2goY29vcmRpbmF0ZXMsZnVuY3Rpb24oYyxpbmRleCl7ICAgICAgXG4gICAgICB2YXIgZ2l1bnppb25pU291cmNlID0gZ2l1bnppb25pVmVjdG9yTGF5ZXIuZ2V0U291cmNlKCk7XG4gICAgICBcbiAgICAgIHZhciBleHRlbnQgPSBvbC5leHRlbnQuYnVmZmVyKFtjWzBdLGNbMV0sY1swXSxjWzFdXSwwLjEpO1xuICAgICAgXG4gICAgICB2YXIgc25hcHBlZEZlYXR1cmUgPSBnaXVuemlvbmlTb3VyY2UuZ2V0RmVhdHVyZXNJbkV4dGVudChleHRlbnQpWzBdO1xuICAgICAgXG4gICAgICBpZiAoc25hcHBlZEZlYXR1cmUpe1xuICAgICAgICBpZiAoaW5kZXggPT0gMCAmJiBzbmFwcy5wdXNoKHNuYXBwZWRGZWF0dXJlKSl7XG4gICAgICAgICAgZmlyc3RWZXJ0ZXhTbmFwcGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpbmRleCA9PSAoY29vcmRpbmF0ZXMubGVuZ3RoLTEpICYmIHNuYXBzLnB1c2goc25hcHBlZEZlYXR1cmUpKXtcbiAgICAgICAgICBsYXN0VmVydGV4U25hcHBlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgaWYgKHNuYXBzLmxlbmd0aCA+IDIpe1xuICAgICAgR1VJLm5vdGlmeS5lcnJvcihcIlVuYSBzdHJhZGEgbm9uIHB1w7IgYXZlcmUgdmVydGljaSBpbnRlcm1lZGkgaW4gY29ycmlzcG9uZGVuemEgZGkgZ2l1bnppb25pXCIpO1xuICAgICAgcmV0ID0gZmFsc2U7XG4gICAgfVxuICAgIFxuICAgIGlmICghZmlyc3RWZXJ0ZXhTbmFwcGVkKXtcbiAgICAgIEdVSS5ub3RpZnkuZXJyb3IoXCJJbCBwcmltbyB2ZXJ0aWNlIGRldmUgY29ycmlzcG9uZGVyZSBjb24gdW5hIGdpdW56aW9uZVwiKTtcbiAgICAgIHJldCA9IGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIWxhc3RWZXJ0ZXhTbmFwcGVkKXtcbiAgICAgIEdVSS5ub3RpZnkuZXJyb3IoXCJMJ3VsdGltbyB2ZXJ0aWNlIGRldmUgY29ycmlzcG9uZGVyZSBjb24gdW5hIGdpdW56aW9uZVwiKTtcbiAgICAgIHJldCA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9O1xuICBcbiAgLyogRklORSBNT0RJRklDQSAqL1xuICBcbiAgLyogSU5JWklPIFRBR0xJTyAqL1xuICBcbiAgdGhpcy5fc2V0dXBTdHJhZGVDdXR0ZXJQb3N0U2VsZWN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5vbmJlZm9yZWFzeW5jKCdjdXRMaW5lJyxmdW5jdGlvbihkYXRhLG1vZFR5cGUsbmV4dCl7XG4gICAgICBpZiAobW9kVHlwZSA9PSAnTU9ET05DVVQnKXtcbiAgICAgICAgLy8gbGEgcHJpbWEgZmVhdHVyZSBpbiBkYXRhLmFkZCDDqCBxdWVsbGEgZGEgYWdnaXVuZ2VyZSBjb21lIG51b3ZhXG4gICAgICAgIHZhciBuZXdGZWF0dXJlID0gZGF0YS5hZGRlZFswXTtcbiAgICAgICAgdmFyIG5ld0ZlYXR1cmVTbmFwcyA9IHNlbGYuX2dldEZpcnN0TGFzdFNuYXBwZWRHaXVuemlvbmkobmV3RmVhdHVyZS5nZXRHZW9tZXRyeSgpKTtcbiAgICAgICAgbmV3RmVhdHVyZS5zZXQoJ25vZF9pbmknLG5ld0ZlYXR1cmVTbmFwc1swXS5nZXQoJ2NvZF9nbnonKSk7XG4gICAgICAgIG5ld0ZlYXR1cmUuc2V0KCdub2RfZmluJyxuZXdGZWF0dXJlU25hcHNbMV0uZ2V0KCdjb2RfZ256JykpO1xuICAgICAgICBcbiAgICAgICAgdmFyIHVwZGF0ZUZlYXR1cmUgPSBkYXRhLnVwZGF0ZWQ7XG4gICAgICAgIHZhciB1cGRhdGVGZWF0dXJlU25hcHMgPSBzZWxmLl9nZXRGaXJzdExhc3RTbmFwcGVkR2l1bnppb25pKHVwZGF0ZUZlYXR1cmUuZ2V0R2VvbWV0cnkoKSk7XG4gICAgICAgIHVwZGF0ZUZlYXR1cmUuc2V0KCdub2RfaW5pJyx1cGRhdGVGZWF0dXJlU25hcHNbMF0uZ2V0KCdjb2RfZ256JykpO1xuICAgICAgICB1cGRhdGVGZWF0dXJlLnNldCgnbm9kX2ZpbicsdXBkYXRlRmVhdHVyZVNuYXBzWzFdLmdldCgnY29kX2dueicpKTtcbiAgICAgICAgXG4gICAgICAgIHNlbGYuX29wZW5FZGl0b3JGb3JtKCduZXcnLG5ld0ZlYXR1cmUsbmV4dCk7XG4gICAgICAgIFxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIG5leHQodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIFxuICB0aGlzLl9nZXRGaXJzdExhc3RTbmFwcGVkR2l1bnppb25pID0gZnVuY3Rpb24oZ2VvbWV0cnkpe1xuICAgIHZhciBjb29yZGluYXRlcyA9IGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7XG4gICAgdmFyIGdpdW56aW9uaVZlY3RvckxheWVyID0gdGhpcy5fZ2l1bnppb25pRWRpdG9yLmdldFZlY3RvckxheWVyKCk7XG4gICAgdmFyIGZpcnN0VmVydGV4U25hcHBlZCA9IG51bGw7XG4gICAgdmFyIGxhc3RWZXJ0ZXhTbmFwcGVkID0gbnVsbDtcbiAgICBcbiAgICBfLmZvckVhY2goY29vcmRpbmF0ZXMsZnVuY3Rpb24oYyxpbmRleCl7ICAgICAgXG4gICAgICB2YXIgZ2l1bnppb25pU291cmNlID0gZ2l1bnppb25pVmVjdG9yTGF5ZXIuZ2V0U291cmNlKCk7XG4gICAgICBcbiAgICAgIHZhciBleHRlbnQgPSBvbC5leHRlbnQuYnVmZmVyKFtjWzBdLGNbMV0sY1swXSxjWzFdXSwwLjEpO1xuICAgICAgXG4gICAgICB2YXIgc25hcHBlZEZlYXR1cmUgPSBnaXVuemlvbmlTb3VyY2UuZ2V0RmVhdHVyZXNJbkV4dGVudChleHRlbnQpWzBdO1xuICAgICAgXG4gICAgICBpZiAoc25hcHBlZEZlYXR1cmUpe1xuICAgICAgICBpZiAoaW5kZXggPT0gMCl7XG4gICAgICAgICAgZmlyc3RWZXJ0ZXhTbmFwcGVkID0gc25hcHBlZEZlYXR1cmU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5kZXggPT0gKGNvb3JkaW5hdGVzLmxlbmd0aC0xKSl7XG4gICAgICAgICAgbGFzdFZlcnRleFNuYXBwZWQgPSBzbmFwcGVkRmVhdHVyZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBbZmlyc3RWZXJ0ZXhTbmFwcGVkLGxhc3RWZXJ0ZXhTbmFwcGVkXTtcbiAgfVxuICBcbiAgLyogRklORSBUQUdMSU8gKi9cbn07XG5pbmhlcml0KFN0cmFkZUVkaXRvcixJdGVybmV0RWRpdG9yKTtcbm1vZHVsZS5leHBvcnRzID0gU3RyYWRlRWRpdG9yO1xuXG52YXIgcHJvdG8gPSBTdHJhZGVFZGl0b3IucHJvdG90eXBlO1xuXG5wcm90by5zdGFydCA9IGZ1bmN0aW9uKGl0ZXJuZXRTZXJ2aWNlKXtcbiAgdGhpcy5fc2VydmljZSA9IGl0ZXJuZXRTZXJ2aWNlO1xuICB0aGlzLl9naXVuemlvbmlFZGl0b3IgPSBpdGVybmV0U2VydmljZS5fbGF5ZXJzW2l0ZXJuZXRTZXJ2aWNlLmxheWVyQ29kZXMuR0lVTlpJT05JXS5lZGl0b3I7XG4gIFxuICB0aGlzLl9sb2FkTWlzc2luZ0dpdW56aW9uaUluVmlldygpO1xuICB0aGlzLl9zZXR1cERyYXdTdHJhZGVDb25zdHJhaW50cygpO1xuICB0aGlzLl9zZXR1cE1vZGlmeVZlcnRleFN0cmFkZUNvbnN0cmFpbnRzKCk7XG4gIHRoaXMuX3NldHVwU3RyYWRlQ3V0dGVyUG9zdFNlbGVjdGlvbigpO1xuICAgICAgICBcbiAgcmV0dXJuIEl0ZXJuZXRFZGl0b3IucHJvdG90eXBlLnN0YXJ0LmNhbGwodGhpcyk7XG59O1xuXG5wcm90by5zZXRUb29sID0gZnVuY3Rpb24odG9vbFR5cGUpe1xuICB2YXIgZ2l1bnppb25pVmVjdG9yTGF5ZXIgPSB0aGlzLl9naXVuemlvbmlFZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgdmFyIHN0ZXBzSW5mbyA9IFtdO1xuICB2YXIgb3B0aW9ucztcbiAgaWYgKHRvb2xUeXBlPT0nYWRkZmVhdHVyZScpe1xuICAgIG9wdGlvbnMgPSB7XG4gICAgICBzbmFwOiB7XG4gICAgICAgIHZlY3RvckxheWVyOiBnaXVuemlvbmlWZWN0b3JMYXllclxuICAgICAgfSxcbiAgICAgIGZpbmlzaENvbmRpdGlvbjogdGhpcy5fZ2V0Q2hlY2tTbmFwc0NvbmRpdGlvbigpLFxuICAgICAgY29uZGl0aW9uOiB0aGlzLl9nZXRTdHJhZGFJc0JlaW5nU25hcHBlZENvbmRpdGlvbigpXG4gICAgfVxuICB9XG4gIGlmICh0b29sVHlwZT09J21vZGlmeXZlcnRleCcpe1xuICAgIG9wdGlvbnMgPSB7XG4gICAgICBzbmFwOiB7XG4gICAgICAgIHZlY3RvckxheWVyOiBnaXVuemlvbmlWZWN0b3JMYXllclxuICAgICAgfSxcbiAgICAgIGRlbGV0ZUNvbmRpdGlvbjogXy5jb25zdGFudChmYWxzZSlcbiAgICB9XG4gIH1cbiAgaWYgKHRvb2xUeXBlPT0nY3V0bGluZScpe1xuICAgIG9wdGlvbnMgPSB7XG4gICAgICBwb2ludExheWVyOiBnaXVuemlvbmlWZWN0b3JMYXllci5nZXRNYXBMYXllcigpXG4gICAgfVxuICB9XG4gIFxuICB2YXIgc3RhcnQgPSAgSXRlcm5ldEVkaXRvci5wcm90b3R5cGUuc2V0VG9vbC5jYWxsKHRoaXMsdG9vbFR5cGUsb3B0aW9ucyk7XG4gIFxuICBpZiAoc3RhcnQpe1xuICAgIC8vdGhpcy50b29sUHJvZ3Jlc3Muc2V0U3RlcHNJbmZvKHN0ZXBzSW5mbyk7XG4gICAgdGhpcy5fc3RyYWRlU25hcHMgPSBuZXcgdGhpcy5fc3RyYWRlU25hcHNDb2xsZWN0aW9uO1xuICAgICQoJ2JvZHknKS5rZXl1cCh0aGlzLl9kcmF3UmVtb3ZlTGFzdFBvaW50KTtcbiAgICAkKCdib2R5Jykua2V5dXAodGhpcy5fbW9kaWZ5UmVtb3ZlUG9pbnQpO1xuICB9O1xuICBcbiAgcmV0dXJuIHN0YXJ0O1xufTtcblxucHJvdG8uc3RvcFRvb2wgPSBmdW5jdGlvbigpe1xuICB2YXIgc3RvcCA9IGZhbHNlO1xuICBzdG9wID0gSXRlcm5ldEVkaXRvci5wcm90b3R5cGUuc3RvcFRvb2wuY2FsbCh0aGlzKTtcbiAgXG4gIGlmIChzdG9wKXtcbiAgICB0aGlzLl9zdHJhZGVTbmFwcyA9IG51bGw7XG4gICAgJCgnYm9keScpLm9mZigna2V5dXAnLHRoaXMuX2RyYXdSZW1vdmVMYXN0UG9pbnQpO1xuICAgICQoJ2JvZHknKS5vZmYoJ2tleXVwJyx0aGlzLl9tb2RpZnlSZW1vdmVQb2ludCk7XG4gIH1cbiAgXG4gIHJldHVybiBzdG9wOyBcbn07XG5cbn0se1wiLi9pdGVybmV0ZWRpdG9yXCI6NH1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIFBsdWdpbiA9IGczd3Nkay5jb3JlLlBsdWdpbjtcbnZhciBHVUkgPSBnM3dzZGsuZ3VpLkdVSTtcblxudmFyIFNlcnZpY2UgPSByZXF1aXJlKCcuL3BsdWdpbnNlcnZpY2UnKTtcbnZhciBFZGl0aW5nUGFuZWwgPSByZXF1aXJlKCcuL3BhbmVsJyk7XG5cbi8qIC0tLS0gUEFSVEUgREkgQ09ORklHVVJBWklPTkUgREVMTCdJTlRFUk8gIFBMVUdJTlNcbi8gU0FSRUJCRSBJTlRFUlNTQU5URSBDT05GSUdVUkFSRSBJTiBNQU5JRVJBIFBVTElUQSBMQVlFUlMgKFNUWUxFUywgRVRDLi4pIFBBTk5FTExPIElOIFVOXG4vIFVOSUNPIFBVTlRPIENISUFSTyBDT1PDjCBEQSBMRUdBUkUgVE9PTFMgQUkgTEFZRVJcbiovXG5cblxudmFyIF9QbHVnaW4gPSBmdW5jdGlvbigpe1xuICBiYXNlKHRoaXMpO1xuICB0aGlzLm5hbWUgPSAnaXRlcm5ldCc7XG4gIHRoaXMuY29uZmlnID0gbnVsbDtcbiAgdGhpcy5zZXJ2aWNlID0gbnVsbDtcbiAgXG4gIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvL3NldHRvIGlsIHNlcnZpemlvXG4gICAgdGhpcy5zZXRQbHVnaW5TZXJ2aWNlKFNlcnZpY2UpO1xuICAgIC8vcmVjdXBlcm8gY29uZmlndXJhemlvbmUgZGVsIHBsdWdpblxuICAgIHRoaXMuY29uZmlnID0gdGhpcy5nZXRQbHVnaW5Db25maWcoKTtcbiAgICAvL3JlZ2l0cm8gaWwgcGx1Z2luXG4gICAgaWYgKHRoaXMucmVnaXN0ZXJQbHVnaW4odGhpcy5jb25maWcuZ2lkKSkge1xuICAgICAgaWYgKCFHVUkucmVhZHkpIHtcbiAgICAgICAgR1VJLm9uKCdyZWFkeScsXy5iaW5kKHRoaXMuc2V0dXBHdWksIHRoaXMpKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB0aGlzLnNldHVwR3VpKCk7XG4gICAgICB9XG4gICAgICAvL2luaXppYWxpenpvIGlsIHNlcnZpemlvLiBJbCBzZXJ2aXppbyDDqCBsJ2lzdGFuemEgZGVsbGEgY2xhc3NlIHNlcnZpemlvXG4gICAgICB0aGlzLnNlcnZpY2UuaW5pdCh0aGlzLmNvbmZpZyk7XG4gICAgfVxuICB9O1xuICAvL21ldHRvIHN1IGwnaW50ZXJmYWNjaWEgZGVsIHBsdWdpblxuICB0aGlzLnNldHVwR3VpID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHRvb2xzQ29tcG9uZW50ID0gR1VJLmdldENvbXBvbmVudCgndG9vbHMnKTtcbiAgICB2YXIgdG9vbHNTZXJ2aWNlID0gdG9vbHNDb21wb25lbnQuZ2V0U2VydmljZSgpO1xuICAgIC8vYWRkIFRvb2xzIChvcmRpbmUsIE5vbWUgZ3J1cHBvLCB0b29scylcbiAgICB0b29sc1NlcnZpY2UuYWRkVG9vbHMoMCwgJ0lURVJORVQnLCBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiRWRpdGluZyBkYXRpXCIsXG4gICAgICAgIGFjdGlvbjogXy5iaW5kKHNlbGYuc2hvd0VkaXRpbmdQYW5lbCwgdGhpcylcbiAgICAgIH1cbiAgICBdKVxuICB9O1xuICBcbiAgdGhpcy5zaG93RWRpdGluZ1BhbmVsID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBhbmVsID0gbmV3IEVkaXRpbmdQYW5lbCgpO1xuICAgIEdVSS5zaG93UGFuZWwocGFuZWwpO1xuICB9XG59O1xuXG5pbmhlcml0KF9QbHVnaW4sIFBsdWdpbik7XG5cbihmdW5jdGlvbihwbHVnaW4pe1xuICBwbHVnaW4uaW5pdCgpO1xufSkobmV3IF9QbHVnaW4pO1xuXG5cbn0se1wiLi9wYW5lbFwiOjgsXCIuL3BsdWdpbnNlcnZpY2VcIjo5fV0sNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5tb2R1bGUuZXhwb3J0cyA9IFwiPGRpdiBjbGFzcz1cXFwiZzN3LWl0ZXJuZXQtZWRpdGluZy1wYW5lbFxcXCI+XFxuICA8dGVtcGxhdGUgdi1mb3I9XFxcInRvb2xiYXIgaW4gZWRpdG9yc3Rvb2xiYXJzXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwicGFuZWwgcGFuZWwtcHJpbWFyeVxcXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwicGFuZWwtaGVhZGluZ1xcXCI+XFxuICAgICAgICA8aDMgY2xhc3M9XFxcInBhbmVsLXRpdGxlXFxcIj57eyB0b29sYmFyLm5hbWUgfX08L2gzPlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInBhbmVsLWJvZHlcXFwiPlxcbiAgICAgICAgPHRlbXBsYXRlIHYtZm9yPVxcXCJ0b29sIGluIHRvb2xiYXIudG9vbHNcXFwiPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJlZGl0YnRuXFxcIiA6Y2xhc3M9XFxcInsnZW5hYmxlZCcgOiAoc3RhdGUuZWRpdGluZy5vbiAmJiBlZGl0aW5ndG9vbGJ0bkVuYWJsZWQodG9vbCkpLCAndG9nZ2xlZCcgOiBlZGl0aW5ndG9vbGJ0blRvZ2dsZWQodG9vbGJhci5sYXllcmNvZGUsdG9vbC50b29sdHlwZSl9XFxcIj5cXG4gICAgICAgICAgICA8aW1nIGhlaWdodD1cXFwiMzBweFxcXCIgd2lkdGg9XFxcIjMwcHhcXFwiIEBjbGljaz1cXFwidG9nZ2xlRWRpdFRvb2wodG9vbGJhci5sYXllcmNvZGUsdG9vbC50b29sdHlwZSlcXFwiIDphbHQub25jZT1cXFwidG9vbC50aXRsZVxcXCIgOnRpdGxlLm9uY2U9XFxcInRvb2wudGl0bGVcXFwiIDpzcmMub25jZT1cXFwicmVzb3VyY2VzdXJsKydpbWFnZXMvJyt0b29sLmljb25cXFwiLz5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L3RlbXBsYXRlPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvdGVtcGxhdGU+XFxuICA8ZGl2PlxcbiAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLXByaW1hcnlcXFwiIHYtZGlzYWJsZWQ9XFxcImVkaXRpbmdidG5FbmFibGVkXFxcIiA6Y2xhc3M9XFxcInsnYnRuLXN1Y2Nlc3MnIDogc3RhdGUuZWRpdGluZ09ufVxcXCIgQGNsaWNrPVxcXCJ0b2dnbGVFZGl0aW5nXFxcIj57eyBlZGl0aW5nYnRubGFiZWwgfX08L2J1dHRvbj5cXG4gICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kYW5nZXJcXFwiIHYtZGlzYWJsZWQ9XFxcIiFzdGF0ZS5oYXNFZGl0c1xcXCIgQGNsaWNrPVxcXCJzYXZlRWRpdHNcXFwiPnt7IHNhdmVidG5sYWJlbCB9fTwvYnV0dG9uPlxcbiAgICA8aW1nIHYtc2hvdz1cXFwic3RhdGUucmV0cmlldmluZ0RhdGFcXFwiIDpzcmM9XFxcInJlc291cmNlc3VybCArJ2ltYWdlcy9sb2FkZXIuc3ZnJ1xcXCI+XFxuICA8L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcIm1lc3NhZ2VcXFwiPlxcbiAgICB7e3sgbWVzc2FnZSB9fX1cXG4gIDwvZGl2PlxcbjwvZGl2PlxcblwiO1xuXG59LHt9XSw4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbnZhciByZXNvbHZlZFZhbHVlID0gZzN3c2RrLmNvcmUudXRpbHMucmVzb2x2ZTtcbnZhciBpbmhlcml0ID0gZzN3c2RrLmNvcmUudXRpbHMuaW5oZXJpdDtcbnZhciBHVUkgPSBnM3dzZGsuZ3VpLkdVSTtcbnZhciBQYW5lbCA9ICBnM3dzZGsuZ3VpLlBhbmVsO1xuXG52YXIgU2VydmljZSA9IHJlcXVpcmUoJy4vcGx1Z2luc2VydmljZScpO1xuXG52YXIgUGFuZWxDb21wb25lbnQgPSBWdWUuZXh0ZW5kKHtcbiAgdGVtcGxhdGU6IHJlcXVpcmUoJy4vcGFuZWwuaHRtbCcpLFxuICBkYXRhOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9sbyBzdGF0ZSDDqCBxdWVsbG8gZGVsIHNlcnZpemlvIGluIHF1YW50byDDqCBsdWkgY2hlIHZhIGEgbW9kaWZpY2FyZSBvcGVyYXJlIHN1aSBkYXRpXG4gICAgICBzdGF0ZTogU2VydmljZS5zdGF0ZSxcbiAgICAgIHJlc291cmNlc3VybDogR1VJLmdldFJlc291cmNlc1VybCgpLFxuICAgICAgZWRpdG9yc3Rvb2xiYXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiBcIkFjY2Vzc2lcIixcbiAgICAgICAgICBsYXllcmNvZGU6IFNlcnZpY2UubGF5ZXJDb2Rlcy5BQ0NFU1NJLFxuICAgICAgICAgIHRvb2xzOltcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiQWdnaXVuZ2kgYWNjZXNzb1wiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2FkZGZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldEFkZFBvaW50LnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIlNwb3N0YSBhY2Nlc3NvXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnbW92ZWZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldE1vdmVQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJSaW11b3ZpIGFjY2Vzc29cIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdkZWxldGVmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXREZWxldGVQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJFZGl0YSBhdHRyaWJ1dGlcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdlZGl0YXR0cmlidXRlcycsXG4gICAgICAgICAgICAgIGljb246ICdlZGl0QXR0cmlidXRlcy5wbmcnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogXCJHaXVuemlvbmkgc3RyYWRhbGlcIixcbiAgICAgICAgICBsYXllcmNvZGU6IFNlcnZpY2UubGF5ZXJDb2Rlcy5HSVVOWklPTkksXG4gICAgICAgICAgdG9vbHM6W1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJBZ2dpdW5naSBnaXVuemlvbmVcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdhZGRmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRBZGRQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJTcG9zdGEgZ2l1bnppb25lXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnbW92ZWZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldE1vdmVQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJSaW11b3ZpIGdpdW56aW9uZVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2RlbGV0ZWZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldERlbGV0ZVBvaW50LnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkVkaXRhIGF0dHJpYnV0aVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2VkaXRhdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2VkaXRBdHRyaWJ1dGVzLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiBcIkVsZW1lbnRpIHN0cmFkYWxpXCIsXG4gICAgICAgICAgbGF5ZXJjb2RlOiBTZXJ2aWNlLmxheWVyQ29kZXMuU1RSQURFLFxuICAgICAgICAgIHRvb2xzOltcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiQWdnaXVuZ2kgc3RyYWRhXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnYWRkZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0QWRkTGluZS5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJTcG9zdGEgdmVydGljZSBzdHJhZGFcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdtb2RpZnl2ZXJ0ZXgnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldE1vdmVWZXJ0ZXgucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiVGFnbGlhIHN1IGdpdW56aW9uZVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2N1dGxpbmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldEN1dE9uVmVydGV4LnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIlNwb3N0YSBzdHJhZGFcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdtb3ZlZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0TW92ZUxpbmUucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiUmltdW92aSBzdHJhZGFcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdkZWxldGVmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXREZWxldGVMaW5lLnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkVkaXRhIGF0dHJpYnV0aVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2VkaXRhdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2VkaXRBdHRyaWJ1dGVzLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICBzYXZlYnRubGFiZWw6IFwiU2FsdmFcIlxuICAgIH1cbiAgfSxcbiAgbWV0aG9kczoge1xuICAgIHRvZ2dsZUVkaXRpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgLy9zaSBoYSBxdWFuZG8gdmllbmUgYXZ2aWF0YSBvIHRlcm1pbmF0YSB1bmEgc2Vzc2lvbmUgZGkgZWRpdGluZ1xuICAgICAgU2VydmljZS50b2dnbGVFZGl0aW5nKCk7XG4gICAgfSxcbiAgICBzYXZlRWRpdHM6IGZ1bmN0aW9uKCkge1xuICAgICAgLy9jaGFpYW1hdGEgcXVhbmRvIHNpIHByZW1lIHN1IHNhbHZhIGVkaXRzXG4gICAgICBTZXJ2aWNlLnNhdmVFZGl0cygpO1xuICAgIH0sXG4gICAgdG9nZ2xlRWRpdFRvb2w6IGZ1bmN0aW9uKGxheWVyQ29kZSwgdG9vbFR5cGUpIHtcbiAgICAgIC8vY2hpYW1hdG8gcXVhbmRvIHNpIGNsaWNjYSBzdSB1biB0b29sIGRlbGwnZWRpdG9yXG4gICAgICBpZiAodG9vbFR5cGUgPT0gJycpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuc3RhdGUuZWRpdGluZy5vbikge1xuICAgICAgICBTZXJ2aWNlLnRvZ2dsZUVkaXRUb29sKGxheWVyQ29kZSwgdG9vbFR5cGUpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZWRpdGluZ3Rvb2xidG5Ub2dnbGVkOiBmdW5jdGlvbihsYXllckNvZGUsIHRvb2xUeXBlKSB7XG4gICAgICByZXR1cm4gKHRoaXMuc3RhdGUuZWRpdGluZy5sYXllckNvZGUgPT0gbGF5ZXJDb2RlICYmIHRoaXMuc3RhdGUuZWRpdGluZy50b29sVHlwZSA9PSB0b29sVHlwZSk7XG4gICAgfSxcbiAgICBlZGl0aW5ndG9vbGJ0bkVuYWJsZWQ6IGZ1bmN0aW9uKHRvb2wpIHtcbiAgICAgIHJldHVybiB0b29sLnRvb2x0eXBlICE9ICcnO1xuICAgIH1cbiAgfSxcbiAgY29tcHV0ZWQ6IHtcbiAgICBlZGl0aW5nYnRubGFiZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuZWRpdGluZy5vbiA/IFwiVGVybWluYSBlZGl0aW5nXCIgOiBcIkF2dmlhIGVkaXRpbmdcIjtcbiAgICB9LFxuICAgIGVkaXRpbmdidG5FbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAodGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgfHwgdGhpcy5zdGF0ZS5lZGl0aW5nLm9uKSA/IFwiXCIgOiBcImRpc2FibGVkXCI7XG4gICAgfSxcbiAgICBtZXNzYWdlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtZXNzYWdlID0gXCJcIjtcbiAgICAgIGlmICghdGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQpIHtcbiAgICAgICAgbWVzc2FnZSA9ICc8c3BhbiBzdHlsZT1cImNvbG9yOiByZWRcIj5BdW1lbnRhcmUgaWwgbGl2ZWxsbyBkaSB6b29tIHBlciBhYmlsaXRhcmUgbFxcJ2VkaXRpbmcnO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAubjtcbiAgICAgICAgdmFyIHRvdGFsID0gdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLnRvdGFsO1xuICAgICAgICB2YXIgc3RlcG1lc3NhZ2UgPSB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbHN0ZXAubWVzc2FnZTtcbiAgICAgICAgbWVzc2FnZSA9ICc8ZGl2IHN0eWxlPVwibWFyZ2luLXRvcDoyMHB4XCI+R1VJREEgU1RSVU1FTlRPOjwvZGl2PicgK1xuICAgICAgICAgICc8ZGl2PjxzcGFuPlsnK24rJy8nK3RvdGFsKyddIDwvc3Bhbj48c3BhbiBzdHlsZT1cImNvbG9yOiB5ZWxsb3dcIj4nK3N0ZXBtZXNzYWdlKyc8L3NwYW4+PC9kaXY+JztcbiAgICAgIH1cbiAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cbiAgfVxufSk7XG5cbmZ1bmN0aW9uIEVkaXRvclBhbmVsKCkge1xuICAvLyBwcm9wcmlldMOgIG5lY2Vzc2FyaWUuIEluIGZ1dHVybyBsZSBtZXR0ZXJtbyBpbiB1bmEgY2xhc3NlIFBhbmVsIGRhIGN1aSBkZXJpdmVyYW5ubyB0dXR0aSBpIHBhbm5lbGxpIGNoZSB2b2dsaW9ubyBlc3NlcmUgbW9zdHJhdGkgbmVsbGEgc2lkZWJhclxuICB0aGlzLmlkID0gXCJpdGVybmV0LWVkaXRpbmctcGFuZWxcIjtcbiAgdGhpcy5uYW1lID0gXCJHZXN0aW9uZSBkYXRpIElURVJORVRcIjtcbiAgdGhpcy5pbnRlcm5hbFBhbmVsID0gbmV3IFBhbmVsQ29tcG9uZW50KCk7XG59XG5cbmluaGVyaXQoRWRpdG9yUGFuZWwsIFBhbmVsKTtcblxudmFyIHByb3RvID0gUGFuZWwucHJvdG90eXBlO1xuXG4vLyB2aWVuZSByaWNoaWFtYXRvIGRhbGxhIHRvb2xiYXIgcXVhbmRvIGlsIHBsdWdpbiBjaGllZGUgZGkgbW9zdHJhcmVcbi8vIHVuIHByb3ByaW8gcGFubmVsbG8gbmVsbGEgR1VJIChHVUkuc2hvd1BhbmVsKVxucHJvdG8ub25TaG93ID0gZnVuY3Rpb24oY29udGFpbmVyKSB7XG4gIGNvbnNvbGUubG9nKCdjaWFvJyk7XG4gIHZhciBwYW5lbCA9IHRoaXMuaW50ZXJuYWxQYW5lbDtcbiAgcGFuZWwuJG1vdW50KCkuJGFwcGVuZFRvKGNvbnRhaW5lcik7XG4gIHJldHVybiByZXNvbHZlZFZhbHVlKHRydWUpO1xufTtcblxuLy8gcmljaGlhbWF0byBxdWFuZG8gbGEgR1VJIGNoaWVkZSBkaSBjaGl1ZGVyZSBpbCBwYW5uZWxsby4gU2Ugcml0b3JuYSBmYWxzZSBpbCBwYW5uZWxsbyBub24gdmllbmUgY2hpdXNvXG5wcm90by5vbkNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICBTZXJ2aWNlLnN0b3AoKVxuICAudGhlbihmdW5jdGlvbigpIHtcbiAgICBzZWxmLmludGVybmFsUGFuZWwuJGRlc3Ryb3kodHJ1ZSk7XG4gICAgc2VsZi5pbnRlcm5hbFBhbmVsID0gbnVsbDtcbiAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gIH0pXG4gIC5mYWlsKGZ1bmN0aW9uKCkge1xuICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICB9KTtcbiAgXG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVkaXRvclBhbmVsO1xuXG59LHtcIi4vcGFuZWwuaHRtbFwiOjcsXCIuL3BsdWdpbnNlcnZpY2VcIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgcmVzb2x2ZWRWYWx1ZSA9IGczd3Nkay5jb3JlLnV0aWxzLnJlc29sdmU7XG52YXIgcmVqZWN0ZWRWYWx1ZSA9IGczd3Nkay5jb3JlLnV0aWxzLnJlamVjdDtcbnZhciBHM1dPYmplY3QgPSBnM3dzZGsuY29yZS5HM1dPYmplY3Q7XG52YXIgR1VJID0gZzN3c2RrLmd1aS5HVUk7XG52YXIgVmVjdG9yTGF5ZXIgPSBnM3dzZGsuY29yZS5WZWN0b3JMYXllcjtcbnZhciBWZWN0b3JMb2FkZXJMYXllciA9IGczd3Nkay5jb3JlLlZlY3RvckxheWVyTG9hZGVyO1xuXG52YXIgRm9ybUNsYXNzID0gcmVxdWlyZSgnLi9lZGl0b3JzL2F0dHJpYnV0ZXNmb3JtJyk7XG5cbi8vUXVpIGNpIHNvbm8gZ2xpIGVkaXRvciAoY2xhc3NpKSB1c2F0aSBkYWkgdmFyaSBsYXllclxudmFyIEFjY2Vzc2lFZGl0b3IgPSByZXF1aXJlKCcuL2VkaXRvcnMvYWNjZXNzaWVkaXRvcicpO1xudmFyIEdpdW56aW9uaUVkaXRvciA9IHJlcXVpcmUoJy4vZWRpdG9ycy9naXVuemlvbmllZGl0b3InKTtcbnZhciBTdHJhZGVFZGl0b3IgPSByZXF1aXJlKCcuL2VkaXRvcnMvc3RyYWRlZWRpdG9yJyk7XG5cbi8vb2dnZXR0byBjaGUgZGVmaW5pc2NlIGdsaSBzdGVwcyBtZXNzYWdlcyBjaGUgdW4gdG9vbCBkZXZlIGZhcmVcbnZhciB0b29sU3RlcHNNZXNzYWdlcyA9IHtcbiAgJ2N1dGxpbmUnOiBbXG4gICAgXCJTZWxlemlvbmEgbGEgc3RyYWRhIGRhIHRhZ2xpYXJlXCIsXG4gICAgXCJTZWxlemlvbmEgbGEgZ2l1bnppb25lIGRpIHRhZ2xpb1wiLFxuICAgIFwiU2VsZXppb25hIGxhIHBvcml6aW9uZSBkaSBzdHJhZGEgb3JpZ2luYWxlIGRhIG1hbnRlbmVyZVwiXG4gIF1cbn07XG5cbmZ1bmN0aW9uIEl0ZXJuZXRTZXJ2aWNlKCkge1xuXG4gIHZhciBzZWxmID0gdGhpcztcbiAgLy9xdWkgdmFkbyAgYSBzZXR0YXJlIGlsIG1hcHNlcnZpY2VcbiAgdGhpcy5fbWFwU2VydmljZSA9IG51bGw7XG4gIHRoaXMuX3J1bm5pbmdFZGl0b3IgPSBudWxsO1xuXG4gIC8vZGVmaW5pc2NvIGkgY29kaWNpIGxheWVyXG4gIHZhciBsYXllckNvZGVzID0gdGhpcy5sYXllckNvZGVzID0ge1xuICAgIFNUUkFERTogJ3N0cmFkZScsXG4gICAgR0lVTlpJT05JOiAnZ2l1bnppb25pJyxcbiAgICBBQ0NFU1NJOiAnYWNjZXNzaSdcbiAgfTtcbiAgLy8gY2xhc3NpIGVkaXRvclxuICB0aGlzLl9lZGl0b3JDbGFzcyA9IHt9O1xuICB0aGlzLl9lZGl0b3JDbGFzc1tsYXllckNvZGVzLkFDQ0VTU0ldID0gQWNjZXNzaUVkaXRvcjtcbiAgdGhpcy5fZWRpdG9yQ2xhc3NbbGF5ZXJDb2Rlcy5HSVVOWklPTkldID0gR2l1bnppb25pRWRpdG9yO1xuICB0aGlzLl9lZGl0b3JDbGFzc1tsYXllckNvZGVzLlNUUkFERV0gPSBTdHJhZGVFZGl0b3I7XG4gIC8vZGZpbmlzY28gbGF5ZXIgZGVsIHBsdWdpbiBjb21lIG9nZ2V0dG9cbiAgdGhpcy5fbGF5ZXJzID0ge307XG4gIHRoaXMuX2xheWVyc1tsYXllckNvZGVzLkFDQ0VTU0ldID0ge1xuICAgIGxheWVyQ29kZTogbGF5ZXJDb2Rlcy5BQ0NFU1NJLFxuICAgIHZlY3RvcjogbnVsbCxcbiAgICBlZGl0b3I6IG51bGwsXG4gICAgLy9kZWZpbmlzY28gbG8gc3RpbGVcbiAgICBzdHlsZTogZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICB2YXIgY29sb3IgPSAnI2Q5YjU4MSc7XG4gICAgICBzd2l0Y2ggKGZlYXR1cmUuZ2V0KCd0aXBfYWNjJykpe1xuICAgICAgICBjYXNlIFwiMDEwMVwiOlxuICAgICAgICAgIGNvbG9yID0gJyNkOWI1ODEnO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiMDEwMlwiOlxuICAgICAgICAgIGNvbG9yID0gJyNkOWJjMjknO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiMDUwMVwiOlxuICAgICAgICAgIGNvbG9yID0gJyM2OGFhZDknO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvbG9yID0gJyNkOWI1ODEnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtcbiAgICAgICAgbmV3IG9sLnN0eWxlLlN0eWxlKHtcbiAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XG4gICAgICAgICAgICByYWRpdXM6IDUsXG4gICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XG4gICAgICAgICAgICAgIGNvbG9yOiBjb2xvclxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgXVxuICAgIH1cbiAgfTtcbiAgdGhpcy5fbGF5ZXJzW2xheWVyQ29kZXMuR0lVTlpJT05JXSA9IHtcbiAgICBsYXllckNvZGU6IGxheWVyQ29kZXMuR0lVTlpJT05JLFxuICAgIHZlY3RvcjogbnVsbCxcbiAgICBlZGl0b3I6IG51bGwsXG4gICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XG4gICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XG4gICAgICAgIHJhZGl1czogNSxcbiAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xuICAgICAgICAgIGNvbG9yOiAnIzAwMDBmZidcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfTtcbiAgdGhpcy5fbGF5ZXJzW2xheWVyQ29kZXMuU1RSQURFXSA9IHtcbiAgICBsYXllckNvZGU6IGxheWVyQ29kZXMuU1RSQURFLFxuICAgIHZlY3RvcjogbnVsbCxcbiAgICBlZGl0b3I6IG51bGwsXG4gICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XG4gICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xuICAgICAgICB3aWR0aDogMyxcbiAgICAgICAgY29sb3I6ICcjZmY3ZDJkJ1xuICAgICAgfSlcbiAgICB9KVxuICB9O1xuXG4gIHRoaXMuX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuXG4gIHRoaXMuX2N1cnJlbnRFZGl0aW5nTGF5ZXIgPSBudWxsO1xuXG4gIHRoaXMuX2xvYWRlZEV4dGVudCA9IG51bGw7XG5cbiAgdGhpcy5zdGF0ZSA9IHtcbiAgICBlZGl0aW5nOiB7XG4gICAgICBvbjogZmFsc2UsXG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIGxheWVyQ29kZTogbnVsbCxcbiAgICAgIHRvb2xUeXBlOiBudWxsLFxuICAgICAgc3RhcnRpbmdFZGl0aW5nVG9vbDogZmFsc2UsXG4gICAgICB0b29sc3RlcDoge1xuICAgICAgICBuOiBudWxsLFxuICAgICAgICB0b3RhbDogbnVsbCxcbiAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgfVxuICAgIH0sXG4gICAgcmV0cmlldmluZ0RhdGE6IGZhbHNlLFxuICAgIGhhc0VkaXRzOiBmYWxzZVxuICB9O1xuXG4gIC8vZGVmaW5pc2NvIGlsIGxvYWRlciBkZWwgcGx1Z2luXG4gIHRoaXMuX2xvYWRlciA9IG5ldyBWZWN0b3JMb2FkZXJMYXllcjtcbiAgLy8gaW5pemlhbGl6emF6aW9uZSBkZWwgcGx1Z2luXG4gIC8vIGNoaWFtdG8gZGFsbCAkc2NyaXB0KHVybCkgZGVsIHBsdWdpbiByZWdpc3RyeVxuICAvLyBpbml6aWFsaXp6YXppb25lIGRlbCBwbHVnaW5cbiAgLy8gY2hpYW10byBkYWxsICRzY3JpcHQodXJsKSBkZWwgcGx1Z2luIHJlZ2lzdHJ5XG4gIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKGNvbmZpZykge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIC8vIHNldHRvIGlsIG1hcHNlcnZpY2UgY2hlIG1pIHBlcm1ldHRlIGRpIGluZXJhZ2lyZSBjb24gbGEgbWFwcGFcbiAgICB0aGlzLl9tYXBTZXJ2aWNlID0gR1VJLmdldENvbXBvbmVudCgnbWFwJykuZ2V0U2VydmljZSgpO1xuICAgIC8vaW5pemlhbGl6em8gaWwgbG9hZGVyXG4gICAgdmFyIG9wdGlvbnNfbG9hZGVyID0ge1xuICAgICAgJ2xheWVycyc6IHRoaXMuX2xheWVycyxcbiAgICAgICdiYXNldXJsJzogdGhpcy5jb25maWcuYmFzZXVybCxcbiAgICAgICdtYXBTZXJ2aWNlJzogdGhpcy5fbWFwU2VydmljZVxuICAgIH07XG4gICAgLy9pbml6aWFsaXp6byBpbCBsb2FkZXJcbiAgICB0aGlzLl9sb2FkZXIuaW5pdChvcHRpb25zX2xvYWRlcik7XG4gICAgLy9jYXNvIGRpIHJldHJpZXcgZGF0YVxuICAgIHRoaXMuX2xvYWRlci5vbigncmV0cmlld3ZlY3RvcmxheWVycycsIGZ1bmN0aW9uKGJvb2wsIHZlY3RvckxheWVycykge1xuICAgICAgXy5mb3JFYWNoKHZlY3RvckxheWVycywgZnVuY3Rpb24gKHZlY3RvckxheWVyLCBsYXllckNvZGUpIHtcbiAgICAgICAgaWYgKGJvb2wpIHtcbiAgICAgICAgICBzZWxmLl9zZXRVcFZlY3RvckxheWVyKGxheWVyQ29kZSwgdmVjdG9yTGF5ZXIpO1xuICAgICAgICAgIHNlbGYuX3NldFVwRWRpdG9yKGxheWVyQ29kZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2V0dG8gYSB0cnVlIGluIHF1ZXN0byBtb2RvIGNhcGlzY28gY2hlIGkgbGF5ZXJ2ZXR0b3JpYWxpIHNvbm8gc3RhdGkgcmVjdXBlcmF0aVxuICAgICAgICAvLyBkYWwgc2VydmVyIGUgY2hlIHF1aW5kaSBpbml6byBhIGZhcmUgaWwgbG9hZGluZyBkZWkgZGF0aSB2ZXJpIGUgcHJvcHJpXG4gICAgICAgIHNlbGYuc3RhdGUucmV0cmlldmluZ0RhdGEgPSBib29sO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5fbG9hZGVyLm9uKCdyZXRyaWV3dmVjdG9sYXllcnNkYXRhJywgZnVuY3Rpb24oYm9vbCkge1xuICAgICAgLy8gcXVlc3RhIG1pIHNlcnZlciBwZXIgc3BlbmdlcmUgYWxsYSBmaW5lICBpbCBsb2FkaW5nIGdpZlxuICAgICAgc2VsZi5zdGF0ZS5yZXRyaWV2aW5nRGF0YSA9IGJvb2w7XG4gICAgfSk7XG4gICAgLy9ldmVudG8gcXVhbmRvIHJpY2V2byBkYWwgbG9hZGVyIGwnYXJyYXkgZGkgZmVhdHVyZXMgbG9ja2VkXG4gICAgdGhpcy5fbG9hZGVyLm9uKCdmZWF0dXJlbG9ja3MnLCBmdW5jdGlvbihsYXllckNvZGUsIGZlYXR1cmVsb2Nrcykge1xuICAgICAgLy9hc3NlZ25vIGFsbCdlZGl0b3IgbCdhcnJheSBkZWxsZSBmZWF0dXJlIGxvY2tlZFxuICAgICAgc2VsZi5fbGF5ZXJzW2xheWVyQ29kZV0uZWRpdG9yLnNldEZlYXR1cmVMb2NrcyhmZWF0dXJlbG9ja3MpO1xuICAgIH0pO1xuXG4gICAgLy8gZGlzYWJpbGl0byBsJ2V2ZW50dWFsZSB0b29sIGF0dGl2byBzZSB2aWVuZSBhdHRpdmF0YVxuICAgIC8vIHVuJ2ludGVyYXppb25lIGRpIHRpcG8gcG9pbnRlckludGVyYWN0aW9uU2V0IHN1bGxhIG1hcHBhXG4gICAgdGhpcy5fbWFwU2VydmljZS5vbigncG9pbnRlckludGVyYWN0aW9uU2V0JywgZnVuY3Rpb24oaW50ZXJhY3Rpb24pIHtcbiAgICAgIHZhciBjdXJyZW50RWRpdGluZ0xheWVyID0gc2VsZi5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIpIHtcbiAgICAgICAgdmFyIGFjdGl2ZVRvb2wgPSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuaW5zdGFuY2U7XG4gICAgICAgIC8vIGRldm8gdmVyaWZpY2FyZSBjaGUgbm9uIHNpYSB1bidpbnRlcmF6aW9uZSBhdHRpdmF0YSBkYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyBkZWwgcGx1Z2luXG4gICAgICAgIGlmIChhY3RpdmVUb29sICYmICFhY3RpdmVUb29sLm93bnNJbnRlcmFjdGlvbihpbnRlcmFjdGlvbikpIHtcbiAgICAgICAgICBzZWxmLl9zdG9wRWRpdGluZ1Rvb2woKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIC8vICBzZXR0byBlZGl0aW5nIGRlbGxvZ2V0dG8gc3RhdGUgb24gYSB0cnVlXG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgPSAgdHJ1ZTtcbiAgICAvLyBwZXIgb2duaSBsYXllciBkZWZpbml0aSBuZWwgcGx1Z2luIHNldHRvIG5hbWUgZSBpZFxuICAgIC8vIHJlY3VwZXJhdGkgZ3JhemllIGFsIG1hcHNlcnZpY2VcbiAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihMYXllciwgbGF5ZXJDb2RlKSB7XG4gICAgICAvL3JlY3VwZXJvIGwnaWQgZGFsbGEgY29uZmlndXJhemlvbmUgZGVsIHBsdWdpblxuICAgICAgdmFyIGxheWVySWQgPSBjb25maWcubGF5ZXJzW2xheWVyQ29kZV0uaWQ7XG4gICAgICAvLyByZWN1cGVyYSBpbCBsYXllciBkYWwgbWFwc2VydmljZVxuICAgICAgdmFyIGxheWVyID0gc2VsZi5fbWFwU2VydmljZS5nZXRQcm9qZWN0KCkuZ2V0TGF5ZXJCeUlkKGxheWVySWQpO1xuICAgICAgTGF5ZXIubmFtZSA9IGxheWVyLmdldE9yaWdOYW1lKCk7XG4gICAgICBMYXllci5pZCA9IGxheWVySWQ7XG4gICAgfSk7XG5cbiAgfTtcbiAgLy8gZmluZSBkZWwgbWV0b2RvIElOSVRcblxuICAvL3N0b3BcbiAgdGhpcy5zdG9wID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgaWYgKHRoaXMuc3RhdGUuZWRpdGluZy5vbikge1xuICAgICAgdGhpcy5fY2FuY2VsT3JTYXZlKClcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2VsZi5fc3RvcEVkaXRpbmcoKTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICB9KVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcblxuICAvLyBhdnZpbyBvIHRlcm1pbm8gbGEgc2Vzc2lvbmUgZGkgZWRpdGluZyBnZW5lcmFsZVxuICB0aGlzLnRvZ2dsZUVkaXRpbmcgPSBmdW5jdGlvbigpe1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgJiYgIXRoaXMuc3RhdGUuZWRpdGluZy5vbil7XG4gICAgICB0aGlzLl9zdGFydEVkaXRpbmcoKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLm9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdG9wKCk7XG4gICAgfVxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG5cbiAgdGhpcy5zYXZlRWRpdHMgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuX2NhbmNlbE9yU2F2ZSgyKTtcbiAgfTtcblxuICAvLyBhdnZpYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyB0cmEgcXVlbGxpIHN1cHBvcnRhdGkgZGEgRWRpdG9yIChhZGRmZWF0dXJlLCBlY2MuKVxuICAvLyBmdW56aW9uZSBkZWxsJ2VsZW1lbnRvIHBhbmVsIHZ1ZVxuICB0aGlzLnRvZ2dsZUVkaXRUb29sID0gZnVuY3Rpb24obGF5ZXJDb2RlLCB0b29sVHlwZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvL3ByZW5kbyBpbCBsYXllciBpbiBiYXNlIGFsIGNvZGljZSBwYXNzYXRvIGRhbGwgY29tcG9uZW50ZSB2dWVcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXTtcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIC8vcmVjdXByZXJvIGlsIGN1cnJlbnQgbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgdmFyIGN1cnJlbnRFZGl0aW5nTGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgICAvLyBzZSBzaSBzdGEgdXNhbmRvIHVuIHRvb2wgY2hlIHByZXZlZGUgbG8gc3Rlc3NvIGxheWVyIGluIGVkaXRhemlvbmVcbiAgICAgIGlmIChjdXJyZW50RWRpdGluZ0xheWVyICYmIGxheWVyQ29kZSA9PSBjdXJyZW50RWRpdGluZ0xheWVyLmxheWVyQ29kZSkge1xuICAgICAgICAvLyBlIGxvIHN0ZXNzbyB0b29sIGFsbG9yYSBkaXNhdHRpdm8gaWwgdG9vbCAoaW4gcXVhbnRvIMOoXG4gICAgICAgIC8vIHByZW11dG8gc3VsbG8gc3Rlc3NvIGJvdHRvbmUpXG4gICAgICAgIGlmICh0b29sVHlwZSA9PSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuZ2V0VHlwZSgpKSB7XG4gICAgICAgICAgLy8gc3Rlc3NvIHRpcG8gZGkgdG9vbCBxdWluZGkgc2kgw6ggdmVyaWZpY2F0byB1biB0b2dnbGUgbmVsIGJvdHRvbmVcbiAgICAgICAgICAvLyBhbGxvcmEgc3RpcHBvIGwnZWRpdGluZyBUb29sXG4gICAgICAgICAgdGhpcy5fc3RvcEVkaXRpbmdUb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWx0cmltZW50aSBhdHRpdm8gaWwgdG9vbCByaWNoaWVzdG9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy9zdG9wcG8gcHJldmVudGl2YW1lbnRlIGwnZWRpdGluZyB0b29sIGF0dGl2b1xuICAgICAgICAgIHRoaXMuX3N0b3BFZGl0aW5nVG9vbCgpO1xuICAgICAgICAgIC8vZmFjY2lvIHBhcnRpcmUgbCdlZGl0bmcgdG9vbCBwYXNzYW5kbyBjdXJyZW50IEVkaXRpbmcgTGF5ZXIgZSBpbCB0aXBvIGRpIHRvb2xcbiAgICAgICAgICB0aGlzLl9zdGFydEVkaXRpbmdUb29sKGN1cnJlbnRFZGl0aW5nTGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gYWx0cmltZW50aSBjYXNvIGluIGN1aSBub24gw6ggc3RhdG8gc2V0dGF0byBpbCBjdXJyZW50IGVkaXRpbmcgbGF5ZXIgb1xuICAgICAgICAvLyBpbCBsYXllciBjaGUgc2kgc3RhIGNlcmNhbmRvIGRpIGVkaXRhcmUgw6ggZGl2ZXJzbyBkYSBxdWVsbG8gaW4gZWRpdGluZyBpbiBwcmVjZWRlbnphXG4gICAgICAgIC8vIG5lbCBjYXNvIHNpYSBnacOgICBhdHRpdm8gdW4gZWRpdG9yIHZlcmlmaWNvIGRpIHBvdGVybG8gc3RvcHBhcmVcbiAgICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIgJiYgY3VycmVudEVkaXRpbmdMYXllci5lZGl0b3IuaXNTdGFydGVkKCkpIHtcbiAgICAgICAgICAvLyBzZSBsYSB0ZXJtaW5hemlvbmUgZGVsbCdlZGl0aW5nIHNhcsOgICBhbmRhdGEgYSBidW9uIGZpbmUsIHNldHRvIGlsIHRvb2xcbiAgICAgICAgICAvLyBwcm92byBhIHN0b3BwYXJlXG4gICAgICAgICAgdGhpcy5fY2FuY2VsT3JTYXZlKDIpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX3N0b3BFZGl0b3IoKSkge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Nvbm8gcXVpIGRvcG8gaW52aW8gZGVpIGRhdGknKTtcbiAgICAgICAgICAgICAgICAgIHNlbGYuX3N0YXJ0RWRpdGluZ1Rvb2wobGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvL25lbCBjYXNvIHNpYSBsYSBwcmltYSB2b2x0YSBjaGUgaW50ZXJhZ2lzY28gY29uIHVuIHRvb2xcbiAgICAgICAgICAvLyBlIHF1aW5kaSBub24gw6ggc3RhdG8gc2V0dGF0byBuZXNzdW4gbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgICAgIHRoaXMuX3N0YXJ0RWRpdGluZ1Rvb2wobGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvL2Z1bnppb25lIGNoZSByZXN0aXR1aXNjZSBsJ2FycmF5IGRlaSBjb2RpY2kgZGVpIGxheWVyc1xuICB0aGlzLmdldExheWVyQ29kZXMgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiBfLnZhbHVlcyh0aGlzLmxheWVyQ29kZXMpO1xuICB9O1xuXG4gIC8qIE1FVE9ESSBQUklWQVRJICovXG4gIC8vIGZ1bnppb25lIHBlciBzZXR0YXJlIGlsIHZlY3RvcmxheWVyIGFsbGEgcHJvcmlldMOgIHZlY3RvciBkZWwgbGF5ZXJcbiAgdGhpcy5fc2V0VXBWZWN0b3JMYXllciA9IGZ1bmN0aW9uKGxheWVyQ29kZSwgdmVjdG9yTGF5ZXIpIHtcbiAgICB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXS52ZWN0b3IgPSB2ZWN0b3JMYXllcjtcbiAgfTtcbiAgLy9mdW56aW9uZSBjaGUgcGVybWV0dGUgZGkgZmFyZSBpbCBzZXR1cCBkZWxsJ2VkaXRvciBlIGFzc2VnYW5ybG8gYWwgbGF5ZXJcbiAgdGhpcy5fc2V0VXBFZGl0b3IgPSBmdW5jdGlvbihsYXllckNvZGUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgLy9vcHRpb24gZWRpdG9yXG4gICAgdmFyIG9wdGlvbnNfZWRpdG9yID0ge1xuICAgICAgJ21hcFNlcnZpY2UnOiBzZWxmLl9tYXBTZXJ2aWNlLFxuICAgICAgJ2Zvcm1DbGFzcyc6IEZvcm1DbGFzc1xuICAgIH07XG5cbiAgICAvLyBwcmVuZG8gaWwgdmVjdG9yIGxheWVyIGRlbCBsYXllclxuICAgIHZhciB2ZWN0b3JMYXllciA9IHRoaXMuX2xheWVyc1tsYXllckNvZGVdLnZlY3RvcjtcbiAgICAvL0dFU1RJT05FIEUgSU5JWklBTElaWkFaSU9ORSBERUxMJ0VESVRPUiBSRUxBVElWTyBBTCBMQVlFUiBWRVRUT1JJQUxFXG4gICAgLy9jcmVvIGwnaXN0YW56YSBkZWxsJ2VkaXRvciBjaGUgZ2VzdGlyw6AgaWwgbGF5ZXJcbiAgICB2YXIgZWRpdG9yID0gbmV3IHNlbGYuX2VkaXRvckNsYXNzW2xheWVyQ29kZV0ob3B0aW9uc19lZGl0b3IpO1xuICAgIC8vc2V0dG8gaWwgbGF5ZXIgdmV0dG9yaWFsZSBhc3NvY2lhdG8gYWxsJ2VkaXRvclxuICAgIC8vIGUgaSB0aXBpIGRpIHRvb2xzIGFzc29jaWF0aSBhZCBlc3NvXG4gICAgZWRpdG9yLnNldFZlY3RvckxheWVyKHZlY3RvckxheWVyKTtcbiAgICAvL2VtZXR0ZSBldmVudG8gY2hlIMOoIHN0YXRhIGdlbmVyYXRhIHVuYSBtb2RpZmljYSBsYSBsYXllclxuICAgIGVkaXRvci5vbihcImRpcnR5XCIsIGZ1bmN0aW9uIChkaXJ0eSkge1xuICAgICAgc2VsZi5zdGF0ZS5oYXNFZGl0cyA9IGRpcnR5O1xuICAgIH0pO1xuICAgIC8vYXNzZWdubyBsJ2lzdGFuemEgZWRpdG9yIGFsIGxheWVyIHRyYW1pdGUgbGEgcHJvcHJpZXTDoCBlZGl0b3JcbiAgICB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXS5lZGl0b3IgPSBlZGl0b3I7XG4gICAgLy8vLyBGSU5FIEdFU1RJT05FIEVESVRPUlxuICB9O1xuICAvL2ZhIHBhcnRpcmUgbCdlZGl0aW5nXG4gIHRoaXMuX3N0YXJ0RWRpdGluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLl9sb2FkZXIubG9hZExheWVycygpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAvLyBzZSB0dXR0byAgw6ggYW5kYXRvIGEgYnVvbiBmaW5lIGFnZ2l1bmdvIGkgVmVjdG9yTGF5ZXIgYWxsYSBtYXBwYVxuICAgICAgICAgIC8vY29uc29sZS5sb2coJ2FuZGF0byB0dXR0byBiZW5lLiBTZXR0byBhIHN0YXRlLmVkaXRpbmcub249VHJ1ZScpO1xuICAgICAgICAgIHNlbGYuX2FkZFRvTWFwKCk7XG4gICAgICAgICAgc2VsZi5zdGF0ZS5lZGl0aW5nLm9uID0gdHJ1ZTtcbiAgICAgICAgICBzZWxmLmVtaXQoXCJlZGl0aW5nc3RhcnRlZFwiKTtcbiAgICAgICAgICBpZiAoIXNlbGYuX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIC8vdmllbmUgcml0b3JuYXRhIGxhIGxpc3RlbmVyIGtleVxuICAgICAgICAgICAgc2VsZi5fbG9hZERhdGFPbk1hcFZpZXdDaGFuZ2VMaXN0ZW5lciA9IHNlbGYuX21hcFNlcnZpY2Uub25hZnRlcignc2V0TWFwVmlldycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAoc2VsZi5zdGF0ZS5lZGl0aW5nLm9uICYmIHNlbGYuc3RhdGUuZWRpdGluZy5lbmFibGVkKXtcbiAgICAgICAgICAgICAgICBzZWxmLl9sb2FkZXIubG9hZEFsbFZlY3RvcnNEYXRhKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fc3RvcEVkaXRpbmcgPSBmdW5jdGlvbihyZXNldCl7XG4gICAgLy8gc2UgcG9zc28gc3RvcHBhcmUgdHV0dGkgZ2xpIGVkaXRvci4uLlxuICAgIGlmICh0aGlzLl9zdG9wRWRpdG9yKHJlc2V0KSl7XG4gICAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihsYXllciwgbGF5ZXJDb2RlKXtcbiAgICAgICAgdmFyIHZlY3RvciA9IGxheWVyLnZlY3RvcjtcbiAgICAgICAgc2VsZi5fbWFwU2VydmljZS52aWV3ZXIucmVtb3ZlTGF5ZXJCeU5hbWUodmVjdG9yLm5hbWUpO1xuICAgICAgICBsYXllci52ZWN0b3I9IG51bGw7XG4gICAgICAgIGxheWVyLmVkaXRvcj0gbnVsbDtcbiAgICAgICAgc2VsZi5fdW5sb2NrTGF5ZXIoc2VsZi5fbGF5ZXJzW2xheWVyQ29kZV0pO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl91cGRhdGVFZGl0aW5nU3RhdGUoKTtcbiAgICAgIHNlbGYuc3RhdGUuZWRpdGluZy5vbiA9IGZhbHNlO1xuICAgICAgc2VsZi5fY2xlYW5VcCgpO1xuICAgICAgc2VsZi5lbWl0KFwiZWRpdGluZ3N0b3BwZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuX2NsZWFuVXAgPSBmdW5jdGlvbigpIHtcbiAgICAvL3ZhZG8gYWQgYW5udWxhcmUgbCdlc3Rlbnppb25lIGRlbCBsb2FkZXIgcGVyIHBvdGVyIHJpY2FyaWNhcmUgaSBkYXRpIHZldHR0b3JpYWxpXG4gICAgLy9kYSByaXZlZGVyZTtcbiAgICB0aGlzLl9sb2FkZXIuY2xlYW5VcExheWVycygpO1xuXG4gIH07XG4gIC8vc2Ugbm9uIMOoIGFuY29yYSBwYXJ0aXRvIGZhY2NpbyBwYXJ0aXJlIGxvIHN0YXJ0IGVkaXRvclxuICB0aGlzLl9zdGFydEVkaXRvciA9IGZ1bmN0aW9uKGxheWVyKXtcbiAgICAvLyBhdnZpbyBsJ2VkaXRvclxuICAgIC8vIHBhc3NhbmRvbGkgaWwgc2VydmljZSBjaGUgbG8gYWNjZXR0YVxuICAgIGlmIChsYXllci5lZGl0b3Iuc3RhcnQodGhpcykpIHtcbiAgICAgIC8vIHJlZ2lzdHJvIGlsIGN1cnJlbnQgbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgdGhpcy5fc2V0Q3VycmVudEVkaXRpbmdMYXllcihsYXllcik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICAvL2Z1bnppb25lIGNoZSB2aWVuZSBjaGlhbWF0YSBhbCBjbGljayBzdSB1biB0b29sIGRlbGwnZWRpdGluZyBlIHNlXG4gIC8vbm9uIMOoIHN0YXRvIGFzc2VnbmF0byBhbmNvcmEgbmVzc3VuIGxheWVyIGNvbWUgY3VycmVudCBsYXllciBlZGl0aW5nXG4gIHRoaXMuX3N0YXJ0RWRpdGluZ1Rvb2wgPSBmdW5jdGlvbihsYXllciwgdG9vbFR5cGUsIG9wdGlvbnMpIHtcbiAgICAvL2Fzc2Vnbm8gdHJ1ZSBhbGxvIHN0YXJ0RWRpdGluZ1Rvb2wgYXR0cmlidXRvIGRlbGxsbyBzdGF0ZVxuICAgIHRoaXMuc3RhdGUuc3RhcnRpbmdFZGl0aW5nVG9vbCA9IHRydWU7XG4gICAgdmFyIGNhblN0YXJ0VG9vbCA9IHRydWU7XG4gICAgLy92ZXJpZmljbyBzZSBsJ2VkaXRvciDDqCBwYXJ0aXRvIG8gbWVub1xuICAgIGlmICghbGF5ZXIuZWRpdG9yLmlzU3RhcnRlZCgpKSB7XG4gICAgICAvL3NlIG5vbiDDqCBhbmNvcmEgcGFydGl0byBsbyBmYWNjaW8gcGFydGlyZSBlIG5lIHByZW5kbyBpbCByaXN1bHRhdG9cbiAgICAgIC8vIHRydWUgbyBmYWxzZVxuICAgICAgY2FuU3RhcnRUb29sID0gdGhpcy5fc3RhcnRFZGl0b3IobGF5ZXIpO1xuICAgIH1cbiAgICAvLyB2ZXJpZmljYSBzZSBpbCB0b29sIHB1w7IgZXNzZXJlIGF0dGl2YXRvXG4gICAgLy8gbCdlZGl0b3IgdmVyaWZpY2Egc2UgaWwgdG9vbCByaWNoaWVzdG8gw6ggY29tcGF0aWJpbGVcbiAgICAvLyBjb24gaSB0b29scyBwcmV2aXN0aSBkYWxsJ2VkaXRvci4gQ3JlYSBpc3RhbnphIGRpIHRvb2wgZSBhdnZpYSBpbCB0b29sXG4gICAgLy8gYXR0cmF2ZXJzbyBpbCBtZXRvZG8gcnVuXG4gICAgaWYgKGNhblN0YXJ0VG9vbCAmJiBsYXllci5lZGl0b3Iuc2V0VG9vbCh0b29sVHlwZSwgb3B0aW9ucykpIHtcbiAgICAgIHRoaXMuX3VwZGF0ZUVkaXRpbmdTdGF0ZSgpO1xuICAgICAgdGhpcy5zdGF0ZS5zdGFydGluZ0VkaXRpbmdUb29sID0gZmFsc2U7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZS5zdGFydGluZ0VkaXRpbmdUb29sID0gZmFsc2U7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHRoaXMuX3N0b3BFZGl0b3IgPSBmdW5jdGlvbihyZXNldCl7XG4gICAgdmFyIHJldCA9IHRydWU7XG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIGlmIChsYXllcikge1xuICAgICAgcmV0ID0gbGF5ZXIuZWRpdG9yLnN0b3AocmVzZXQpO1xuICAgICAgaWYgKHJldCl7XG4gICAgICAgIHRoaXMuX3NldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIHNpIG9jY3VwYSBkaSBpbnRlcnJvbWVwZXJlIGwnZWR0aW5nIHRvb2xcbiAgdGhpcy5fc3RvcEVkaXRpbmdUb29sID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJldCA9IHRydWU7XG4gICAgLy8gcmVjdXBlcmUgaWwgbGF5ZXIgaW4gY3VycmVudCBlZGl0aW5nXG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIC8vIHNlIGVzaXN0ZSBlZCBlcmEgc3RhdG8gc2V0dGF0b1xuICAgIGlmIChsYXllcikge1xuICAgICAgLy8gc2UgYW5kYXRvIGJlbmUgcml0b3JuYSB0cnVlXG4gICAgICByZXQgPSBsYXllci5lZGl0b3Iuc3RvcFRvb2woKTtcbiAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlRWRpdGluZ1N0YXRlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBhY2NldHRhIGNvbWUgcGFyYW1ldHJvIGlsIHRpcG8gZGlcbiAgLy8gb3BlcmF6aW9uZSBkYSBmYXJlIGEgc2Vjb25kYSBkaWNvc2Egw6ggYXZ2ZW51dG9cbiAgdGhpcy5fY2FuY2VsT3JTYXZlID0gZnVuY3Rpb24odHlwZSl7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIC8vIHBlciBzaWN1cmV6emEgdGVuZ28gdHV0dG8gZGVudHJvIHVuIGdyb3NzbyB0cnkvY2F0Y2gsXG4gICAgLy8gcGVyIG5vbiByaXNjaGlhcmUgZGkgcHJvdm9jYXJlIGluY29uc2lzdGVuemUgbmVpIGRhdGkgZHVyYW50ZSBpbCBzYWx2YXRhZ2dpb1xuICAgIHRyeSB7XG4gICAgICB2YXIgX2Fza1R5cGUgPSAxO1xuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgX2Fza1R5cGUgPSB0eXBlXG4gICAgICB9XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgY2hvaWNlID0gXCJjYW5jZWxcIjtcbiAgICAgIHZhciBkaXJ0eUVkaXRvcnMgPSB7fTtcbiAgICAgIC8vIHZlcmlmaWNvIHBlciBvZ25pIGxheWVyIHNlIGwnZWRpdG8gYXNzb2NpYXRvIMOoIERpcnR5XG4gICAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihsYXllciwgbGF5ZXJDb2RlKSB7XG4gICAgICAgIGlmIChsYXllci5lZGl0b3IuaXNEaXJ0eSgpKSB7XG4gICAgICAgICAgZGlydHlFZGl0b3JzW2xheWVyQ29kZV0gPSBsYXllci5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gdmVyaWZpY28gc2UgY2kgc29ubyBvIG1lbm8gZWRpdG9yIHNwb3JjaGlcbiAgICAgIGlmKF8ua2V5cyhkaXJ0eUVkaXRvcnMpLmxlbmd0aCkge1xuICAgICAgICBjb25zb2xlLmxvZygnYXNrVHlwZTogJyxfYXNrVHlwZSk7XG4gICAgICAgIHRoaXMuX2Fza0NhbmNlbE9yU2F2ZShfYXNrVHlwZSkuXG4gICAgICAgIHRoZW4oZnVuY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgICAgLy8gcml0b3JuYSBpbCB0aXBvIGRpIGF6aW9uZSBkYSBmYXJlXG4gICAgICAgICAgLy8gc2F2ZSwgY2FuY2VsLCBub3NhdmVcbiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnc2F2ZScpIHtcbiAgICAgICAgICAgIC8vIHBhc3NvIGdsaSBlZGl0b3Igc3BvY2hpIGFsbGEgZnVuemlvbmUgX3NhdmVFZGl0c1xuICAgICAgICAgICAgc2VsZi5fc2F2ZUVkaXRzKGRpcnR5RWRpdG9ycykuXG4gICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT0gJ25vc2F2ZScpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PSAnY2FuY2VsJykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgIH1cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xuICB9O1xuICAvLyBmdW56aW9uZSBjaGUgaW4gYmFzZSBhbCB0aXBvIGRpIGFza1R5cGVcbiAgLy8gdmlzdWFsaXp6YSBpbCBtb2RhbGUgYSBjdWkgcmlzcG9uZGVyZSwgc2FsdmEgZXRjIC4uXG4gIHRoaXMuX2Fza0NhbmNlbE9yU2F2ZSA9IGZ1bmN0aW9uKHR5cGUpe1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICB2YXIgYnV0dG9uVHlwZXMgPSB7XG4gICAgICBTQVZFOiB7XG4gICAgICAgIGxhYmVsOiBcIlNhbHZhXCIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJidG4tc3VjY2Vzc1wiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdzYXZlJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBOT1NBVkU6IHtcbiAgICAgICAgbGFiZWw6IFwiVGVybWluYSBzZW56YSBzYWx2YXJlXCIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJidG4tZGFuZ2VyXCIsXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ25vc2F2ZScpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgQ0FOQ0VMOiB7XG4gICAgICAgIGxhYmVsOiBcIkFubnVsbGFcIixcbiAgICAgICAgY2xhc3NOYW1lOiBcImJ0bi1wcmltYXJ5XCIsXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ2NhbmNlbCcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBzd2l0Y2ggKHR5cGUpe1xuICAgICAgY2FzZSAxOlxuICAgICAgICBidXR0b25zID0ge1xuICAgICAgICAgIHNhdmU6IGJ1dHRvblR5cGVzLlNBVkUsXG4gICAgICAgICAgbm9zYXZlOiBidXR0b25UeXBlcy5OT1NBVkUsXG4gICAgICAgICAgY2FuY2VsOiBidXR0b25UeXBlcy5DQU5DRUxcbiAgICAgICAgfTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGJ1dHRvbnMgPSB7XG4gICAgICAgICAgc2F2ZTogYnV0dG9uVHlwZXMuU0FWRSxcbiAgICAgICAgICBjYW5jZWw6IGJ1dHRvblR5cGVzLkNBTkNFTFxuICAgICAgICB9O1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgR1VJLmRpYWxvZy5kaWFsb2coe1xuICAgICAgbWVzc2FnZTogXCJWdW9pIHNhbHZhcmUgZGVmaW5pdGl2YW1lbnRlIGxlIG1vZGlmaWNoZT9cIixcbiAgICAgIHRpdGxlOiBcIlNhbHZhdGFnZ2lvIG1vZGlmaWNhXCIsXG4gICAgICBidXR0b25zOiBidXR0b25zXG4gICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIHNhbHZhIGkgZGF0aSByZWxhdGl2aSBhbCBsYXllciB2ZXR0b3JpYWxlXG4gIC8vIGRlbCBkaXJ0eUVkaXRvclxuICB0aGlzLl9zYXZlRWRpdHMgPSBmdW5jdGlvbihkaXJ0eUVkaXRvcnMpe1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICB0aGlzLl9zZW5kRWRpdHMoZGlydHlFZGl0b3JzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgR1VJLm5vdGlmeS5zdWNjZXNzKFwiSSBkYXRpIHNvbm8gc3RhdGkgc2FsdmF0aSBjb3JyZXR0YW1lbnRlXCIpO1xuICAgICAgICAgIHNlbGYuX2NvbW1pdEVkaXRzKGRpcnR5RWRpdG9ycywgcmVzcG9uc2UpO1xuICAgICAgICAgIHNlbGYuX21hcFNlcnZpY2UucmVmcmVzaE1hcCgpO1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3JzKXtcbiAgICAgICAgICBHVUkubm90aWZ5LmVycm9yKFwiRXJyb3JlIG5lbCBzYWx2YXRhZ2dpbyBzdWwgc2VydmVyXCIpO1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIHByZW5kZSBjb21lIGluZ3Jlc3NvIGdsaSBlZGl0b3Igc3BvcmNoaVxuICB0aGlzLl9zZW5kRWRpdHMgPSBmdW5jdGlvbihkaXJ0eUVkaXRvcnMpIHtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgdmFyIGVkaXRzVG9QdXNoID0gXy5tYXAoZGlydHlFZGl0b3JzLCBmdW5jdGlvbihlZGl0b3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxheWVybmFtZTogZWRpdG9yLmdldFZlY3RvckxheWVyKCkubmFtZSxcbiAgICAgICAgZWRpdHM6IGVkaXRvci5nZXRFZGl0ZWRGZWF0dXJlcygpXG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gZXNlZ3VlIGlsIHBvc3QgZGVpIGRhdGlcbiAgICB0aGlzLl9wb3N0RGF0YShlZGl0c1RvUHVzaClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmV0dXJuZWQpe1xuICAgICAgICAgIGlmIChyZXR1cm5lZC5yZXN1bHQpe1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXR1cm5lZC5yZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJldHVybmVkLnJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKHJldHVybmVkKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmV0dXJuZWQucmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xuICB9O1xuXG4gIHRoaXMuX2NvbW1pdEVkaXRzID0gZnVuY3Rpb24oZWRpdG9ycyxyZXNwb25zZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIF8uZm9yRWFjaChlZGl0b3JzLGZ1bmN0aW9uKGVkaXRvcil7XG4gICAgICB2YXIgbmV3QXR0cmlidXRlc0Zyb21TZXJ2ZXIgPSBudWxsO1xuICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLm5ldyl7XG4gICAgICAgIF8uZm9yRWFjaChyZXNwb25zZS5uZXcsZnVuY3Rpb24odXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzKXtcbiAgICAgICAgICB2YXIgb2xkZmlkID0gdXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzLmNsaWVudGlkO1xuICAgICAgICAgIHZhciBmaWQgPSB1cGRhdGVkRmVhdHVyZUF0dHJpYnV0ZXMuaWQ7XG4gICAgICAgICAgZWRpdG9yLmdldEVkaXRWZWN0b3JMYXllcigpLnNldEZlYXR1cmVEYXRhKG9sZGZpZCxmaWQsbnVsbCx1cGRhdGVkRmVhdHVyZUF0dHJpYnV0ZXMpO1xuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgZWRpdG9yLmNvbW1pdCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIHRoaXMuX3VuZG9FZGl0cyA9IGZ1bmN0aW9uKGRpcnR5RWRpdG9ycyl7XG4gICAgdmFyIGN1cnJlbnRFZGl0aW5nTGF5ZXJDb2RlID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpLmxheWVyQ29kZTtcbiAgICB2YXIgZWRpdG9yID0gZGlydHlFZGl0b3JzW2N1cnJlbnRFZGl0aW5nTGF5ZXJDb2RlXTtcbiAgICB0aGlzLl9zdG9wRWRpdGluZyh0cnVlKTtcbiAgfTtcbiAgLy8gZXNlZ3VlIGwndXBkYXRlIGRlbGxvIHN0YXRlIG5lbCBjYXNvIGFkIGVzZW1waW8gZGkgdW4gdG9nZ2xlIGRlbCBib3R0b25lIHRvb2xcbiAgdGhpcy5fdXBkYXRlRWRpdGluZ1N0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gcHJlbmRlIGlsIGxheWVyIGluIEVkaXRpbmdcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgaWYgKGxheWVyKSB7XG4gICAgICB0aGlzLnN0YXRlLmVkaXRpbmcubGF5ZXJDb2RlID0gbGF5ZXIubGF5ZXJDb2RlO1xuICAgICAgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xUeXBlID0gbGF5ZXIuZWRpdG9yLmdldEFjdGl2ZVRvb2woKS5nZXRUeXBlKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmxheWVyQ29kZSA9IG51bGw7XG4gICAgICB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbFR5cGUgPSBudWxsO1xuICAgIH1cbiAgICB0aGlzLl91cGRhdGVUb29sU3RlcHNTdGF0ZSgpO1xuICB9O1xuXG4gIHRoaXMuX3VwZGF0ZVRvb2xTdGVwc1N0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBsYXllciA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICB2YXIgYWN0aXZlVG9vbDtcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIGFjdGl2ZVRvb2wgPSBsYXllci5lZGl0b3IuZ2V0QWN0aXZlVG9vbCgpO1xuICAgIH1cbiAgICBpZiAoYWN0aXZlVG9vbCAmJiBhY3RpdmVUb29sLmdldFRvb2woKSkge1xuICAgICAgdmFyIHRvb2xJbnN0YW5jZSA9IGFjdGl2ZVRvb2wuZ2V0VG9vbCgpO1xuICAgICAgaWYgKHRvb2xJbnN0YW5jZS5zdGVwcyl7XG4gICAgICAgIHRoaXMuX3NldFRvb2xTdGVwU3RhdGUoYWN0aXZlVG9vbCk7XG4gICAgICAgIHRvb2xJbnN0YW5jZS5zdGVwcy5vbignc3RlcCcsIGZ1bmN0aW9uKGluZGV4LHN0ZXApIHtcbiAgICAgICAgICBzZWxmLl9zZXRUb29sU3RlcFN0YXRlKGFjdGl2ZVRvb2wpO1xuICAgICAgICB9KTtcbiAgICAgICAgdG9vbEluc3RhbmNlLnN0ZXBzLm9uKCdjb21wbGV0ZScsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgc2VsZi5fc2V0VG9vbFN0ZXBTdGF0ZSgpO1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHNlbGYuX3NldFRvb2xTdGVwU3RhdGUoKTtcbiAgICB9XG4gIH07XG5cbiAgdGhpcy5fc2V0VG9vbFN0ZXBTdGF0ZSA9IGZ1bmN0aW9uKGFjdGl2ZVRvb2wpe1xuICAgIHZhciBpbmRleCwgdG90YWwsIG1lc3NhZ2U7XG4gICAgaWYgKF8uaXNVbmRlZmluZWQoYWN0aXZlVG9vbCkpe1xuICAgICAgaW5kZXggPSBudWxsO1xuICAgICAgdG90YWwgPSBudWxsO1xuICAgICAgbWVzc2FnZSA9IG51bGw7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdmFyIHRvb2wgPSBhY3RpdmVUb29sLmdldFRvb2woKTtcbiAgICAgIHZhciBtZXNzYWdlcyA9IHRvb2xTdGVwc01lc3NhZ2VzW2FjdGl2ZVRvb2wuZ2V0VHlwZSgpXTtcbiAgICAgIGluZGV4ID0gdG9vbC5zdGVwcy5jdXJyZW50U3RlcEluZGV4KCk7XG4gICAgICB0b3RhbCA9IHRvb2wuc3RlcHMudG90YWxTdGVwcygpO1xuICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VzW2luZGV4XTtcbiAgICAgIGlmIChfLmlzVW5kZWZpbmVkKG1lc3NhZ2UpKSB7XG4gICAgICAgIGluZGV4ID0gbnVsbDtcbiAgICAgICAgdG90YWwgPSBudWxsO1xuICAgICAgICBtZXNzYWdlID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm4gPSBpbmRleCArIDE7XG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLnRvdGFsID0gdG90YWw7XG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICB9O1xuXG4gIHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLl9jdXJyZW50RWRpdGluZ0xheWVyO1xuICB9O1xuXG4gIHRoaXMuX3NldEN1cnJlbnRFZGl0aW5nTGF5ZXIgPSBmdW5jdGlvbihsYXllcil7XG4gICAgaWYgKCFsYXllcil7XG4gICAgICB0aGlzLl9jdXJyZW50RWRpdGluZ0xheWVyID0gbnVsbDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9jdXJyZW50RWRpdGluZ0xheWVyID0gbGF5ZXI7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuX2FkZFRvTWFwID0gZnVuY3Rpb24oKSB7XG4gICAgLy9yZWN1cGVybyBsJ2VsZW1lbnRvIG1hcCBvbDNcbiAgICB2YXIgbWFwID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwO1xuICAgIHZhciBsYXllckNvZGVzID0gdGhpcy5nZXRMYXllckNvZGVzKCk7XG4gICAgLy9vZ25pIGxheWVyIGxvIGFnZ2l1bmdvIGFsbGEgbWFwcGFcbiAgICAvL2NvbiBpbCBtZXRvZG8gYWRkVG9NYXAgZGkgdmVjdG9yTGF5ZXJcbiAgICBfLmZvckVhY2gobGF5ZXJDb2RlcywgZnVuY3Rpb24obGF5ZXJDb2RlKSB7XG4gICAgICBzZWxmLl9sYXllcnNbbGF5ZXJDb2RlXS52ZWN0b3IuYWRkVG9NYXAobWFwKTtcbiAgICB9KVxuICB9O1xuXG4gIHRoaXMuX3Bvc3REYXRhID0gZnVuY3Rpb24oZWRpdHNUb1B1c2gpIHtcbiAgICAvLyBtYW5kbyB1biBvZ2dldHRvIGNvbWUgbmVsIGNhc28gZGVsIGJhdGNoLFxuICAgIC8vIG1hIGluIHF1ZXN0byBjYXNvIGRldm8gcHJlbmRlcmUgc29sbyBpbCBwcmltbywgZSB1bmljbywgZWxlbWVudG9cbiAgICBpZiAoZWRpdHNUb1B1c2gubGVuZ3RoID4gMSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Bvc3RCYXRjaERhdGEoZWRpdHNUb1B1c2gpO1xuICAgIH1cbiAgICB2YXIgbGF5ZXJOYW1lID0gZWRpdHNUb1B1c2hbMF0ubGF5ZXJuYW1lO1xuICAgIHZhciBlZGl0cyA9IGVkaXRzVG9QdXNoWzBdLmVkaXRzO1xuICAgIGNvbnNvbGUubG9nKGVkaXRzKTtcbiAgICB2YXIganNvbkRhdGEgPSBKU09OLnN0cmluZ2lmeShlZGl0cyk7XG4gICAgcmV0dXJuICQucG9zdCh7XG4gICAgICB1cmw6IHRoaXMuY29uZmlnLmJhc2V1cmwrbGF5ZXJOYW1lK1wiL1wiLFxuICAgICAgZGF0YToganNvbkRhdGEsXG4gICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLl9wb3N0QmF0Y2hEYXRhID0gZnVuY3Rpb24obXVsdGlFZGl0c1RvUHVzaCl7XG4gICAgdmFyIGVkaXRzID0ge307XG4gICAgXy5mb3JFYWNoKG11bHRpRWRpdHNUb1B1c2gsZnVuY3Rpb24oZWRpdHNUb1B1c2gpe1xuICAgICAgZWRpdHNbZWRpdHNUb1B1c2gubGF5ZXJuYW1lXSA9IGVkaXRzVG9QdXNoLmVkaXRzO1xuICAgIH0pO1xuICAgIHZhciBqc29uRGF0YSA9IEpTT04uc3RyaW5naWZ5KGVkaXRzKTtcbiAgICByZXR1cm4gJC5wb3N0KHtcbiAgICAgIHVybDogdGhpcy5jb25maWcuYmFzZXVybCxcbiAgICAgIGRhdGE6IGpzb25EYXRhLFxuICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fdW5sb2NrID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgbGF5ZXJDb2RlcyA9IHRoaXMuZ2V0TGF5ZXJDb2RlcygpO1xuICAgIC8vIGVzZWd1byBsZSByaWNoaWVzdGUgZGVsbGUgY29uZmlndXJhemlvbmkgZSBtaSB0ZW5nbyBsZSBwcm9tZXNzZVxuICAgIHZhciB1bmxvY2tSZXF1ZXN0cyA9IF8ubWFwKGxheWVyQ29kZXMsZnVuY3Rpb24obGF5ZXJDb2RlKXtcbiAgICAgIHJldHVybiBzZWxmLl91bmxvY2tMYXllcihzZWxmLl9sYXllcnNbbGF5ZXJDb2RlXSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fdW5sb2NrTGF5ZXIgPSBmdW5jdGlvbihsYXllckNvbmZpZyl7XG4gICAgJC5nZXQodGhpcy5jb25maWcuYmFzZXVybCtsYXllckNvbmZpZy5uYW1lK1wiLz91bmxvY2tcIik7XG4gIH07XG4gIC8vZ2V0IGxvYWRlciBzZXJ2aWNlXG4gIHRoaXMuZ2V0TG9hZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xvYWRlcjtcbiAgfVxufVxuaW5oZXJpdChJdGVybmV0U2VydmljZSxHM1dPYmplY3QpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBJdGVybmV0U2VydmljZTtcbn0se1wiLi9lZGl0b3JzL2FjY2Vzc2llZGl0b3JcIjoxLFwiLi9lZGl0b3JzL2F0dHJpYnV0ZXNmb3JtXCI6MixcIi4vZWRpdG9ycy9naXVuemlvbmllZGl0b3JcIjozLFwiLi9lZGl0b3JzL3N0cmFkZWVkaXRvclwiOjV9XX0se30sWzZdKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
