!function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return o(i?i:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){function n(t){r(this,t)}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=t("./iterneteditor");o(n,s),e.exports=n},{"./iterneteditor":4}],2:[function(t,e,i){function n(t){r(this,t),this._formPanel=d}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.core.ProjectsRegistry,a=g3wsdk.gui.FormPanel,l=g3wsdk.gui.Form,d=a.extend({});o(n,l);var c=n.prototype;c._isVisible=function(t){var e=!0;switch(t.name){case"cod_acc_est":var i=this._getField("tip_acc");"0101"==i.value&&(e=!1);break;case"cod_acc_int":var i=this._getField("tip_acc");"0101"!=i.value&&"0501"!=i.value||(e=!1)}return e},c._isEditable=function(t){return!("tip_acc"==t.name&&!this._isNew())&&l.prototype._isEditable.call(this,t)},c._shouldShowRelation=function(t){if("numero_civico"==t.name){var e=this._getField("tip_acc");if("0102"==e.value)return!1}return!0},c._pickLayer=function(t){var e=this,i=t.input.options.layerid;l.prototype._pickLayer.call(this,t).then(function(n){var o,r;switch(t.name){case"cod_ele":o=e._getRelationField("cod_top","numero_civico");break;case"cod_top":o=e._getField("cod_ele")}if(o){var a=s.getCurrentProject();r=a.getLayerAttributeLabel(i,o.input.options.field),o&&n[r]&&(o.value=n[r])}})},e.exports=n},{}],3:[function(t,e,i){function n(t){r(this,t),this._service=null,this._stradeEditor=null,this._giunzioneGeomListener=null,this._setupMoveGiunzioniListener=function(){var t=this;this.on("movestart",function(e){t._startMovingGiunzione(e)})},this._stradeToUpdate=[],this._startMovingGiunzione=function(t){var e=this,i=(this.getVectorLayer(),this._stradeEditor),n=t,o=n.get("cod_gnz");this._stradeToUpdate=[];var r=i.getVectorLayer().getSource().getFeatures();_.forEach(r,function(t){var i=t.get("nod_ini"),r=t.get("nod_fin"),s=i==o,a=r==o;if(s||a){var l=!!s;e._stradeToUpdate.push(t),e._startGiunzioniStradeTopologicalEditing(n,t,l)}}),this.once("moveend",function(t){e._stradeToUpdate.length&&(i.isStarted()||i.start(this._service),_.forEach(e._stradeToUpdate,function(t){i.updateFeature(t)}))})},this._startGiunzioniStradeTopologicalEditing=function(t,e,i){var n=e.getGeometry(),o=e.getGeometry().getCoordinates(),r=i?0:o.length-1,s=t.getGeometry(),a=s.on("change",function(t){o[r]=t.target.getCoordinates(),n.setCoordinates(o)});this._giunzioneGeomListener=a},this._setupDeleteGiunzioniListener=function(){var t=this._stradeEditor;this.onbeforeasync("deleteFeature",function(e,i,n){var o=!1,r=t.getVectorLayer();_.forEach(r.getFeatures(),function(t){var i=e.get("cod_gnz"),n=t.get("nod_ini"),r=t.get("nod_fin"),s=n==i,a=r==i;(s||a)&&(o=!0)}),o&&GUI.notify.error("Non è possibile rimuovere la giunzioni perché risulta connessa ad una o più strade"),n(!o)})}}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=t("./iterneteditor");o(n,s),e.exports=n;var a=n.prototype;a.start=function(t){return this._service=t,this._stradeEditor=t._layers[t.layerCodes.STRADE].editor,this._setupMoveGiunzioniListener(),this._setupDeleteGiunzioniListener(),s.prototype.start.call(this)},a.stop=function(){var t=!1;return s.prototype.stop.call(this)&&(t=!0,ol.Observable.unByKey(this._giunzioneGeomListener)),t},a.setTool=function(t){var e;return"addfeature"==t&&(e={snap:{vectorLayer:this._stradeEditor.getVectorLayer()}}),s.prototype.setTool.call(this,t,e)}},{"./iterneteditor":4}],4:[function(t,e,i){function n(t){r(this,t)}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.core.Editor;g3wsdk.gui.GUI,t("./attributesform");o(n,s),e.exports=n},{"./attributesform":2}],5:[function(t,e,i){function n(t){r(this,t),this._service=null,this._giunzioniEditor=null,this._mapService=s.getComponent("map").getService(),this._stradeSnaps=null,this._stradeSnapsCollection=function(){var t=[];this.length=0,this.push=function(e){var i=!1;return this.canSnap(e)&&(t.push(e),this.length+=1,i=!0),i},this.getLast=function(){return t[t.length-1]},this.getFirst=function(){return t[0]},this.clear=function(){t.splice(0,t.length),this.length=0},this.getSnaps=function(){return t},this.canSnap=function(t){if(this.isAlreadySnapped(t))return!1;var e=t.get("cod_gnz");return!_.isNil(e)&&""!=e},this.isAlreadySnapped=function(t){return _.includes(this.snaps,t)}},this._updateStradaAttributes=function(t){var e=this._stradeSnaps;t.set("nod_ini",e.getSnaps()[0].get("cod_gnz")),t.set("nod_fin",e.getSnaps()[1].get("cod_gnz"))},this._loadMissingGiunzioniInView=function(){var t=this.getVectorLayer(),e=this._giunzioniEditor.getVectorLayer(),i=t.getSource(),n=ol.extent.buffer(i.getExtent(),1);this._service._loadVectorData(e,n)},this._drawRemoveLastPoint=_.bind(function(t){var e=this,i=this.getActiveTool().getType();"addfeature"==i&&46==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.getActiveTool().getTool().removeLastPoint())},this),this._setupDrawStradeConstraints=function(){var t=this;this._mapService.viewer.map.getTargetElement().id,this._mapService.viewer.map;this.onbefore("addFeature",function(e){var i=t._stradeSnaps;return 2==i.length&&(t._updateStradaAttributes(e),i.clear(),!0)},0)},this._getCheckSnapsCondition=function(){var t=this;return function(e){var i=t._stradeSnaps;return 2==i.length||(s.notify.error("L'ultimo vertice deve corrispondere con una giunzione"),!1)}},this._getStradaIsBeingSnappedCondition=function(){var t=this,e=this._mapService.viewer.map,i=this._giunzioniEditor.getVectorLayer();return function(n){var o=t._stradeSnaps,r=e.getCoordinateFromPixel(n.pixel),a=i.getSource(),l=ol.extent.buffer([r[0],r[1],r[0],r[1]],1),d=a.getFeaturesInExtent(l)[0];if(2==o.length&&(!d||d!=o.getSnaps()[1])){return s.notify.error("Una strada non può avere vertici intermedi in corrispondenza di giunzioni.<br> Premere <b>CANC</b> per rimuovere l'ultimo vertice."),!1}return d&&o.length<2&&o.push(d),0!=o.length||(s.notify.error("Il primo vertice deve corrispondere con una giunzione"),!1)}},this._modifyRemovePoint=_.bind(function(t){var e=this,i=this.getActiveTool().getType();"modifyvertex"==i&&46==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.getActiveTool().getTool().removePoint())},this),this._setupModifyVertexStradeConstraints=function(){var t=this;this._mapService.viewer.map;this.onbefore("modifyFeature",function(e){var i=t._stradeSnaps,n=t._checkStradaIsCorrectlySnapped(e.getGeometry());return n&&(t._updateStradaAttributes(e),i.clear()),n})},this._checkStradaIsCorrectlySnapped=function(t){var e=!0,i=(this._mapService.viewer.map,this._giunzioniEditor.getVectorLayer());this._stradeSnaps.clear();var n=this._stradeSnaps,o=t.getCoordinates(),r=!1,a=!1;return _.forEach(o,function(t,e){var s=i.getSource(),l=ol.extent.buffer([t[0],t[1],t[0],t[1]],.1),d=s.getFeaturesInExtent(l)[0];d&&(0==e&&n.push(d)?r=!0:e==o.length-1&&n.push(d)&&(a=!0))}),n.length>2&&(s.notify.error("Una strada non può avere vertici intermedi in corrispondenza di giunzioni"),e=!1),r||(s.notify.error("Il primo vertice deve corrispondere con una giunzione"),e=!1),a||(s.notify.error("L'ultimo vertice deve corrispondere con una giunzione"),e=!1),e},this._setupStradeCutterPostSelection=function(){var t=this;this.onbeforeasync("cutLine",function(e,i,n){if("MODONCUT"==i){var o=e.added[0],r=t._getFirstLastSnappedGiunzioni(o.getGeometry());o.set("nod_ini",r[0].get("cod_gnz")),o.set("nod_fin",r[1].get("cod_gnz"));var s=e.updated,a=t._getFirstLastSnappedGiunzioni(s.getGeometry());s.set("nod_ini",a[0].get("cod_gnz")),s.set("nod_fin",a[1].get("cod_gnz")),t._openEditorForm("new",o,n)}else n(!0)})},this._getFirstLastSnappedGiunzioni=function(t){var e=t.getCoordinates(),i=this._giunzioniEditor.getVectorLayer(),n=null,o=null;return _.forEach(e,function(t,r){var s=i.getSource(),a=ol.extent.buffer([t[0],t[1],t[0],t[1]],.1),l=s.getFeaturesInExtent(a)[0];l&&(0==r?n=l:r==e.length-1&&(o=l))}),[n,o]}}var o=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,s=g3wsdk.gui.GUI,a=t("./iterneteditor");o(n,a),e.exports=n;var l=n.prototype;l.start=function(t){return this._service=t,this._giunzioniEditor=t._layers[t.layerCodes.GIUNZIONI].editor,this._loadMissingGiunzioniInView(),this._setupDrawStradeConstraints(),this._setupModifyVertexStradeConstraints(),this._setupStradeCutterPostSelection(),a.prototype.start.call(this)},l.setTool=function(t){var e,i=this._giunzioniEditor.getVectorLayer();"addfeature"==t&&(e={snap:{vectorLayer:i},finishCondition:this._getCheckSnapsCondition(),condition:this._getStradaIsBeingSnappedCondition()}),"modifyvertex"==t&&(e={snap:{vectorLayer:i},deleteCondition:_.constant(!1)}),"cutline"==t&&(e={pointLayer:i.getMapLayer()});var n=a.prototype.setTool.call(this,t,e);return n&&(this._stradeSnaps=new this._stradeSnapsCollection,$("body").keyup(this._drawRemoveLastPoint),$("body").keyup(this._modifyRemovePoint)),n},l.stopTool=function(){var t=!1;return t=a.prototype.stopTool.call(this),t&&(this._stradeSnaps=null,$("body").off("keyup",this._drawRemoveLastPoint),$("body").off("keyup",this._modifyRemovePoint)),t}},{"./iterneteditor":4}],6:[function(t,e,i){var n=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,r=g3wsdk.core.Plugin,s=g3wsdk.gui.GUI,a=t("./pluginservice"),l=t("./panel"),d=function(){o(this),this.name="iternet",this.config=null,this.service=null,this.init=function(){this.setPluginService(a),this.config=this.getPluginConfig(),this.registerPlugin(this.config.gid)&&(s.ready?this.setupGui():s.on("ready",_.bind(this.setupGui,this)),this.service.init(this.config))},this.setupGui=function(){var t=this,e=s.getComponent("tools"),i=e.getService();i.addTools(0,"ITERNET",[{name:"Editing dati",action:_.bind(t.showEditingPanel,this)}])},this.showEditingPanel=function(){var t=new l;s.showPanel(t)}};n(d,r),function(t){t.init()}(new d)},{"./panel":8,"./pluginservice":9}],7:[function(t,e,i){e.exports='<div class="g3w-iternet-editing-panel">\n  <template v-for="toolbar in editorstoolbars">\n    <div class="panel panel-primary">\n      <div class="panel-heading">\n        <h3 class="panel-title">{{ toolbar.name }}</h3>\n      </div>\n      <div class="panel-body">\n        <template v-for="tool in toolbar.tools">\n          <div class="editbtn" :class="{\'enabled\' : (state.editing.on && editingtoolbtnEnabled(tool)), \'toggled\' : editingtoolbtnToggled(toolbar.layercode,tool.tooltype)}">\n            <img height="30px" width="30px" @click="toggleEditTool(toolbar.layercode,tool.tooltype)" :alt.once="tool.title" :title.once="tool.title" :src.once="resourcesurl+\'images/\'+tool.icon"/>\n          </div>\n        </template>\n      </div>\n    </div>\n  </template>\n  <div>\n    <button class="btn btn-primary" v-disabled="editingbtnEnabled" :class="{\'btn-success\' : state.editingOn}" @click="toggleEditing">{{ editingbtnlabel }}</button>\n    <button class="btn btn-danger" v-disabled="!state.hasEdits" @click="saveEdits">{{ savebtnlabel }}</button>\n    <img v-show="state.retrievingData" :src="resourcesurl +\'images/loader.svg\'">\n  </div>\n  <div class="message">\n    {{{ message }}}\n  </div>\n</div>\n'},{}],8:[function(t,e,i){function n(){this.id="iternet-editing-panel",this.name="Gestione dati ITERNET",this.internalPanel=new d}var o=g3wsdk.core.utils.resolve,r=g3wsdk.core.utils.inherit,s=g3wsdk.gui.GUI,a=g3wsdk.gui.Panel,l=t("./pluginservice"),d=Vue.extend({template:t("./panel.html"),data:function(){return{state:l.state,resourcesurl:s.getResourcesUrl(),editorstoolbars:[{name:"Accessi",layercode:l.layerCodes.ACCESSI,tools:[{title:"Aggiungi accesso",tooltype:"addfeature",icon:"iternetAddPoint.png"},{title:"Sposta accesso",tooltype:"movefeature",icon:"iternetMovePoint.png"},{title:"Rimuovi accesso",tooltype:"deletefeature",icon:"iternetDeletePoint.png"},{title:"Edita attributi",tooltype:"editattributes",icon:"editAttributes.png"}]},{name:"Giunzioni stradali",layercode:l.layerCodes.GIUNZIONI,tools:[{title:"Aggiungi giunzione",tooltype:"addfeature",icon:"iternetAddPoint.png"},{title:"Sposta giunzione",tooltype:"movefeature",icon:"iternetMovePoint.png"},{title:"Rimuovi giunzione",tooltype:"deletefeature",icon:"iternetDeletePoint.png"},{title:"Edita attributi",tooltype:"editattributes",icon:"editAttributes.png"}]},{name:"Elementi stradali",layercode:l.layerCodes.STRADE,tools:[{title:"Aggiungi strada",tooltype:"addfeature",icon:"iternetAddLine.png"},{title:"Sposta vertice strada",tooltype:"modifyvertex",icon:"iternetMoveVertex.png"},{title:"Taglia su giunzione",tooltype:"cutline",icon:"iternetCutOnVertex.png"},{title:"Sposta strada",tooltype:"movefeature",icon:"iternetMoveLine.png"},{title:"Rimuovi strada",tooltype:"deletefeature",icon:"iternetDeleteLine.png"},{title:"Edita attributi",tooltype:"editattributes",icon:"editAttributes.png"}]}],savebtnlabel:"Salva"}},methods:{toggleEditing:function(){l.toggleEditing()},saveEdits:function(){l.saveEdits()},toggleEditTool:function(t,e){""!=e&&this.state.editing.on&&l.toggleEditTool(t,e)},editingtoolbtnToggled:function(t,e){return this.state.editing.layerCode==t&&this.state.editing.toolType==e},editingtoolbtnEnabled:function(t){return""!=t.tooltype}},computed:{editingbtnlabel:function(){return this.state.editing.on?"Termina editing":"Avvia editing"},editingbtnEnabled:function(){return this.state.editing.enabled||this.state.editing.on?"":"disabled"},message:function(){var t="";if(this.state.editing.enabled){if(this.state.editing.toolstep.message){var e=this.state.editing.toolstep.n,i=this.state.editing.toolstep.total,n=this.state.editing.toolstep.message;t='<div style="margin-top:20px">GUIDA STRUMENTO:</div><div><span>['+e+"/"+i+'] </span><span style="color: yellow">'+n+"</span></div>"}}else t='<span style="color: red">Aumentare il livello di zoom per abilitare l\'editing';return t}}});r(n,a);var c=a.prototype;c.onShow=function(t){console.log("ciao");var e=this.internalPanel;return e.$mount().$appendTo(t),o(!0)},c.onClose=function(){var t=this,e=$.Deferred();return l.stop().then(function(){t.internalPanel.$destroy(!0),t.internalPanel=null,e.resolve()}).fail(function(){e.reject()}),e.promise()},e.exports=n},{"./panel.html":7,"./pluginservice":9}],9:[function(t,e,i){function n(){var t=this;this._mapService=null,this._runningEditor=null;var e=this.layerCodes={STRADE:"strade",GIUNZIONI:"giunzioni",ACCESSI:"accessi"};this._editorClass={},this._editorClass[e.ACCESSI]=d,this._editorClass[e.GIUNZIONI]=c,this._editorClass[e.STRADE]=u,this._layers={},this._layers[e.ACCESSI]={layerCode:e.ACCESSI,vector:null,editor:null,style:function(t){var e="#d9b581";switch(t.get("tip_acc")){case"0101":e="#d9b581";break;case"0102":e="#d9bc29";break;case"0501":e="#68aad9";break;default:e="#d9b581"}return[new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:e})})})]}},this._layers[e.GIUNZIONI]={layerCode:e.GIUNZIONI,vector:null,editor:null,style:new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"#0000ff"})})})},this._layers[e.STRADE]={layerCode:e.STRADE,vector:null,editor:null,style:new ol.style.Style({stroke:new ol.style.Stroke({width:3,color:"#ff7d2d"})})},this._loadDataOnMapViewChangeListener=null,this._currentEditingLayer=null,this._loadedExtent=null,this.state={editing:{on:!1,enabled:!1,layerCode:null,toolType:null,startingEditingTool:!1,toolstep:{n:null,total:null,message:null}},retrievingData:!1,hasEdits:!1},this._loader=new a,this.init=function(t){var e=this;this.config=t,this._mapService=s.getComponent("map").getService();var i={layers:this._layers,baseurl:this.config.baseurl,mapService:this._mapService};this._loader.init(i),this._loader.on("retriewvectorlayers",function(t,i){_.forEach(i,function(i,n){t&&(e._setUpVectorLayer(n,i),e._setUpEditor(n)),e.state.retrievingData=t})}),this._loader.on("retriewvectolayersdata",function(t){e.state.retrievingData=t}),this._loader.on("featurelocks",function(t,i){e._layers[t].editor.setFeatureLocks(i)}),this._mapService.on("pointerInteractionSet",function(t){var i=e._getCurrentEditingLayer();if(i){var n=i.editor.getActiveTool().instance;n&&!n.ownsInteraction(t)&&e._stopEditingTool()}}),this.state.editing.enabled=!0,_.forEach(this._layers,function(i,n){var o=t.layers[n].id,r=e._mapService.getProject().getLayerById(o);i.name=r.getOrigName(),i.id=o})},this.stop=function(){var e=$.Deferred();return this.state.editing.on?this._cancelOrSave().then(function(){t._stopEditing(),e.resolve()}).fail(function(){e.reject()}):e.resolve(),e.promise()},this.toggleEditing=function(){var t=$.Deferred();if(this.state.editing.enabled&&!this.state.editing.on)this._startEditing();else if(this.state.editing.on)return this.stop();return t.promise()},this.saveEdits=function(){this._cancelOrSave(2)},this.toggleEditTool=function(t,e){var i=this,n=this._layers[t];if(n){var o=this._getCurrentEditingLayer();o&&t==o.layerCode?e==o.editor.getActiveTool().getType()?this._stopEditingTool():(this._stopEditingTool(),this._startEditingTool(o,e)):o&&o.editor.isStarted()?this._cancelOrSave(2).then(function(){i._stopEditor()&&(console.log("sono qui dopo invio dei dati"),i._startEditingTool(n,e))}):this._startEditingTool(n,e)}},this.getLayerCodes=function(){return _.values(this.layerCodes)},this._setUpVectorLayer=function(t,e){this._layers[t].vector=e},this._setUpEditor=function(t){var e=this,i={mapService:e._mapService,formClass:l},n=this._layers[t].vector,o=new e._editorClass[t](i);o.setVectorLayer(n),o.on("dirty",function(t){e.state.hasEdits=t}),this._layers[t].editor=o},this._startEditing=function(){var t=this;this._loader.loadLayers().then(function(e){console.log("andato tutto bene. Setto a state.editing.on=True"),t._addToMap(),t.state.editing.on=!0,t.emit("editingstarted"),t._loadDataOnMapViewChangeListener||(t._loadDataOnMapViewChangeListener=t._mapService.onafter("setMapView",function(){t.state.editing.on&&t.state.editing.enabled&&t._loader.loadAllVectorsData()}))})},this._stopEditing=function(e){this._stopEditor(e)&&(_.forEach(this._layers,function(e,i){var n=e.vector;t._mapService.viewer.removeLayerByName(n.name),e.vector=null,e.editor=null,t._unlockLayer(t._layers[i])}),this._updateEditingState(),t.state.editing.on=!1,t._cleanUp(),t.emit("editingstopped"))},this._cleanUp=function(){this._loader.cleanUpLayers()},this._startEditor=function(t){return!!t.editor.start(this)&&(this._setCurrentEditingLayer(t),!0)},this._startEditingTool=function(t,e,i){this.state.startingEditingTool=!0;var n=!0;return t.editor.isStarted()||(n=this._startEditor(t)),n&&t.editor.setTool(e,i)?(this._updateEditingState(),this.state.startingEditingTool=!1,!0):(this.state.startingEditingTool=!1,!1)},this._stopEditor=function(t){var e=!0,i=this._getCurrentEditingLayer();return i&&(e=i.editor.stop(t),e&&this._setCurrentEditingLayer()),e},this._stopEditingTool=function(){var t=!0,e=this._getCurrentEditingLayer();return e&&(t=e.editor.stopTool(),t&&this._updateEditingState()),t},this._cancelOrSave=function(t){var e=$.Deferred();try{var i=1;t&&(i=t);var n=this,o={};_.forEach(this._layers,function(t,e){t.editor.isDirty()&&(o[e]=t.editor)}),_.keys(o).length?(console.log("askType: ",i),this._askCancelOrSave(i).then(function(t){"save"===t?n._saveEdits(o).then(function(t){e.resolve()}).fail(function(t){e.reject()}):"nosave"==t?e.resolve():"cancel"==t&&e.reject()})):e.resolve()}catch(r){e.reject()}return e.promise()},this._askCancelOrSave=function(t){var e=$.Deferred(),i={SAVE:{label:"Salva",className:"btn-success",callback:function(){e.resolve("save")}},NOSAVE:{label:"Termina senza salvare",className:"btn-danger",callback:function(){e.resolve("nosave")}},CANCEL:{label:"Annulla",className:"btn-primary",callback:function(){e.resolve("cancel")}}};switch(t){case 1:buttons={save:i.SAVE,nosave:i.NOSAVE,cancel:i.CANCEL};break;case 2:buttons={save:i.SAVE,cancel:i.CANCEL}}return s.dialog.dialog({message:"Vuoi salvare definitivamente le modifiche?",title:"Salvataggio modifica",buttons:buttons}),e.promise()},this._saveEdits=function(e){var i=$.Deferred();return this._sendEdits(e).then(function(n){s.notify.success("I dati sono stati salvati correttamente"),t._commitEdits(e,n),t._mapService.refreshMap(),i.resolve()}).fail(function(t){s.notify.error("Errore nel salvataggio sul server"),i.resolve()}),i.promise()},this._sendEdits=function(t){var e=$.Deferred(),i=_.map(t,function(t){return{layername:t.getVectorLayer().name,edits:t.getEditedFeatures()}});return this._postData(i).then(function(t){t.result?e.resolve(t.response):e.reject(t.response)}).fail(function(t){e.reject(t.response)}),e.promise()},this._commitEdits=function(t,e){_.forEach(t,function(t){e&&e["new"]&&_.forEach(e["new"],function(e){var i=e.clientid,n=e.id;t.getEditVectorLayer().setFeatureData(i,n,null,e)}),t.commit()})},this._undoEdits=function(t){var e=this._getCurrentEditingLayer().layerCode;t[e];this._stopEditing(!0)},this._updateEditingState=function(){var t=this._getCurrentEditingLayer();t?(this.state.editing.layerCode=t.layerCode,this.state.editing.toolType=t.editor.getActiveTool().getType()):(this.state.editing.layerCode=null,this.state.editing.toolType=null),this._updateToolStepsState()},this._updateToolStepsState=function(){var t,e=this,i=this._getCurrentEditingLayer();if(i&&(t=i.editor.getActiveTool()),t&&t.getTool()){var n=t.getTool();n.steps&&(this._setToolStepState(t),n.steps.on("step",function(i,n){e._setToolStepState(t)}),n.steps.on("complete",function(){e._setToolStepState()}))}else e._setToolStepState()},this._setToolStepState=function(t){var e,i,n;if(_.isUndefined(t))e=null,i=null,n=null;else{var o=t.getTool(),r=g[t.getType()];e=o.steps.currentStepIndex(),i=o.steps.totalSteps(),n=r[e],_.isUndefined(n)&&(e=null,i=null,n=null)}this.state.editing.toolstep.n=e+1,this.state.editing.toolstep.total=i,this.state.editing.toolstep.message=n},this._getCurrentEditingLayer=function(){return this._currentEditingLayer},this._setCurrentEditingLayer=function(t){t?this._currentEditingLayer=t:this._currentEditingLayer=null},this._addToMap=function(){var e=this._mapService.viewer.map,i=this.getLayerCodes();_.forEach(i,function(i){t._layers[i].vector.addToMap(e)})},this._postData=function(t){if(t.length>1)return this._postBatchData(t);var e=t[0].layername,i=t[0].edits,n=JSON.stringify(i);return $.post({url:this.config.baseurl+e+"/",data:n,contentType:"application/json"})},this._postBatchData=function(t){var e={};_.forEach(t,function(t){e[t.layername]=t.edits});var i=JSON.stringify(e);return $.post({url:this.config.baseurl,data:i,contentType:"application/json"})},this._unlock=function(){var e=this.getLayerCodes();_.map(e,function(e){return t._unlockLayer(t._layers[e])})},this._unlockLayer=function(t){$.get(this.config.baseurl+t.name+"/?unlock")}}var o=g3wsdk.core.utils.inherit,r=(g3wsdk.core.utils.resolve,g3wsdk.core.utils.reject,g3wsdk.core.G3WObject),s=g3wsdk.gui.GUI,a=(g3wsdk.core.VectorLayer,g3wsdk.core.VectorLayerLoader),l=t("./editors/attributesform"),d=t("./editors/accessieditor"),c=t("./editors/giunzionieditor"),u=t("./editors/stradeeditor"),g={cutline:["Seleziona la strada da tagliare","Seleziona la giunzione di taglio","Seleziona la porizione di strada originale da mantenere"]};o(n,r),e.exports=new n},{"./editors/accessieditor":1,"./editors/attributesform":2,"./editors/giunzionieditor":3,"./editors/stradeeditor":5}]},{},[6]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1aWxkLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIkFjY2Vzc2lFZGl0b3IiLCJvcHRpb25zIiwiYmFzZSIsInRoaXMiLCJpbmhlcml0IiwiZzN3c2RrIiwiY29yZSIsInV0aWxzIiwiSXRlcm5ldEVkaXRvciIsIi4vaXRlcm5ldGVkaXRvciIsIjIiLCJJdGVybmV0Rm9ybSIsIl9mb3JtUGFuZWwiLCJJdGVybmV0Rm9ybVBhbmVsIiwiUHJvamVjdHNSZWdpc3RyeSIsIkZvcm1QYW5lbCIsImd1aSIsIkZvcm0iLCJleHRlbmQiLCJwcm90byIsInByb3RvdHlwZSIsIl9pc1Zpc2libGUiLCJmaWVsZCIsInJldCIsIm5hbWUiLCJ0aXBfYWNjIiwiX2dldEZpZWxkIiwidmFsdWUiLCJfaXNFZGl0YWJsZSIsIl9pc05ldyIsIl9zaG91bGRTaG93UmVsYXRpb24iLCJyZWxhdGlvbiIsIl9waWNrTGF5ZXIiLCJzZWxmIiwibGF5ZXJJZCIsImlucHV0IiwibGF5ZXJpZCIsInRoZW4iLCJhdHRyaWJ1dGVzIiwibGlua2VkRmllbGQiLCJsaW5rZWRGaWVsZEF0dHJpYnV0ZU5hbWUiLCJfZ2V0UmVsYXRpb25GaWVsZCIsInByb2plY3QiLCJnZXRDdXJyZW50UHJvamVjdCIsImdldExheWVyQXR0cmlidXRlTGFiZWwiLCIzIiwiR2l1bnppb25pRWRpdG9yIiwiX3NlcnZpY2UiLCJfc3RyYWRlRWRpdG9yIiwiX2dpdW56aW9uZUdlb21MaXN0ZW5lciIsIl9zZXR1cE1vdmVHaXVuemlvbmlMaXN0ZW5lciIsIm9uIiwiZmVhdHVyZSIsIl9zdGFydE1vdmluZ0dpdW56aW9uZSIsIl9zdHJhZGVUb1VwZGF0ZSIsInN0cmFkZUVkaXRvciIsImdldFZlY3RvckxheWVyIiwiZ2l1bnppb25lIiwiY29kX2dueiIsImdldCIsInN0cmFkZSIsImdldFNvdXJjZSIsImdldEZlYXR1cmVzIiwiXyIsImZvckVhY2giLCJzdHJhZGEiLCJub2RfaW5pIiwibm9kX2ZpbiIsImluaSIsImZpbiIsImluaXRpYWwiLCJwdXNoIiwiX3N0YXJ0R2l1bnppb25pU3RyYWRlVG9wb2xvZ2ljYWxFZGl0aW5nIiwib25jZSIsImlzU3RhcnRlZCIsInN0YXJ0IiwidXBkYXRlRmVhdHVyZSIsInN0cmFkYUdlb20iLCJnZXRHZW9tZXRyeSIsInN0cmFkYUNvb3JkcyIsImdldENvb3JkaW5hdGVzIiwiY29vcmRJbmRleCIsImdpdW56aW9uZUdlb20iLCJsaXN0ZW5lcktleSIsInRhcmdldCIsInNldENvb3JkaW5hdGVzIiwiX3NldHVwRGVsZXRlR2l1bnppb25pTGlzdGVuZXIiLCJvbmJlZm9yZWFzeW5jIiwiaXNOZXciLCJuZXh0Iiwic3RvcERlbGV0aW9uIiwic3RyYWRlVmVjdG9yTGF5ZXIiLCJHVUkiLCJub3RpZnkiLCJlcnJvciIsIml0ZXJuZXRTZXJ2aWNlIiwiX2xheWVycyIsImxheWVyQ29kZXMiLCJTVFJBREUiLCJlZGl0b3IiLCJzdG9wIiwib2wiLCJPYnNlcnZhYmxlIiwidW5CeUtleSIsInNldFRvb2wiLCJ0b29sVHlwZSIsInNuYXAiLCJ2ZWN0b3JMYXllciIsIjQiLCJFZGl0b3IiLCIuL2F0dHJpYnV0ZXNmb3JtIiwiNSIsIlN0cmFkZUVkaXRvciIsIl9naXVuemlvbmlFZGl0b3IiLCJfbWFwU2VydmljZSIsImdldENvbXBvbmVudCIsImdldFNlcnZpY2UiLCJfc3RyYWRlU25hcHMiLCJfc3RyYWRlU25hcHNDb2xsZWN0aW9uIiwic25hcHMiLCJwdXNoZWQiLCJjYW5TbmFwIiwiZ2V0TGFzdCIsImdldEZpcnN0IiwiY2xlYXIiLCJzcGxpY2UiLCJnZXRTbmFwcyIsImlzQWxyZWFkeVNuYXBwZWQiLCJpc05pbCIsImluY2x1ZGVzIiwiX3VwZGF0ZVN0cmFkYUF0dHJpYnV0ZXMiLCJzZXQiLCJfbG9hZE1pc3NpbmdHaXVuemlvbmlJblZpZXciLCJnaXVuemlvbmlWZWN0b3JMYXllciIsInN0cmFkZVNvdXJjZSIsImV4dGVudCIsImJ1ZmZlciIsImdldEV4dGVudCIsIl9sb2FkVmVjdG9yRGF0YSIsIl9kcmF3UmVtb3ZlTGFzdFBvaW50IiwiYmluZCIsImdldEFjdGl2ZVRvb2wiLCJnZXRUeXBlIiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiZ2V0VG9vbCIsInJlbW92ZUxhc3RQb2ludCIsIl9zZXR1cERyYXdTdHJhZGVDb25zdHJhaW50cyIsInZpZXdlciIsIm1hcCIsImdldFRhcmdldEVsZW1lbnQiLCJpZCIsIm9uYmVmb3JlIiwiX2dldENoZWNrU25hcHNDb25kaXRpb24iLCJfZ2V0U3RyYWRhSXNCZWluZ1NuYXBwZWRDb25kaXRpb24iLCJjIiwiZ2V0Q29vcmRpbmF0ZUZyb21QaXhlbCIsInBpeGVsIiwiZ2l1bnppb25pU291cmNlIiwic25hcHBlZEZlYXR1cmUiLCJnZXRGZWF0dXJlc0luRXh0ZW50IiwiX21vZGlmeVJlbW92ZVBvaW50IiwicmVtb3ZlUG9pbnQiLCJfc2V0dXBNb2RpZnlWZXJ0ZXhTdHJhZGVDb25zdHJhaW50cyIsImNvcnJlY3QiLCJfY2hlY2tTdHJhZGFJc0NvcnJlY3RseVNuYXBwZWQiLCJnZW9tZXRyeSIsImNvb3JkaW5hdGVzIiwiZmlyc3RWZXJ0ZXhTbmFwcGVkIiwibGFzdFZlcnRleFNuYXBwZWQiLCJpbmRleCIsIl9zZXR1cFN0cmFkZUN1dHRlclBvc3RTZWxlY3Rpb24iLCJkYXRhIiwibW9kVHlwZSIsIm5ld0ZlYXR1cmUiLCJhZGRlZCIsIm5ld0ZlYXR1cmVTbmFwcyIsIl9nZXRGaXJzdExhc3RTbmFwcGVkR2l1bnppb25pIiwidXBkYXRlZCIsInVwZGF0ZUZlYXR1cmVTbmFwcyIsIl9vcGVuRWRpdG9yRm9ybSIsIkdJVU5aSU9OSSIsImZpbmlzaENvbmRpdGlvbiIsImNvbmRpdGlvbiIsImRlbGV0ZUNvbmRpdGlvbiIsImNvbnN0YW50IiwicG9pbnRMYXllciIsImdldE1hcExheWVyIiwiJCIsImtleXVwIiwic3RvcFRvb2wiLCJvZmYiLCI2IiwiUGx1Z2luIiwiU2VydmljZSIsIkVkaXRpbmdQYW5lbCIsIl9QbHVnaW4iLCJjb25maWciLCJzZXJ2aWNlIiwiaW5pdCIsInNldFBsdWdpblNlcnZpY2UiLCJnZXRQbHVnaW5Db25maWciLCJyZWdpc3RlclBsdWdpbiIsImdpZCIsInJlYWR5Iiwic2V0dXBHdWkiLCJ0b29sc0NvbXBvbmVudCIsInRvb2xzU2VydmljZSIsImFkZFRvb2xzIiwiYWN0aW9uIiwic2hvd0VkaXRpbmdQYW5lbCIsInBhbmVsIiwic2hvd1BhbmVsIiwicGx1Z2luIiwiLi9wYW5lbCIsIi4vcGx1Z2luc2VydmljZSIsIjciLCI4IiwiRWRpdG9yUGFuZWwiLCJpbnRlcm5hbFBhbmVsIiwiUGFuZWxDb21wb25lbnQiLCJyZXNvbHZlZFZhbHVlIiwicmVzb2x2ZSIsIlBhbmVsIiwiVnVlIiwidGVtcGxhdGUiLCJzdGF0ZSIsInJlc291cmNlc3VybCIsImdldFJlc291cmNlc1VybCIsImVkaXRvcnN0b29sYmFycyIsImxheWVyY29kZSIsIkFDQ0VTU0kiLCJ0b29scyIsInRpdGxlIiwidG9vbHR5cGUiLCJpY29uIiwic2F2ZWJ0bmxhYmVsIiwibWV0aG9kcyIsInRvZ2dsZUVkaXRpbmciLCJzYXZlRWRpdHMiLCJ0b2dnbGVFZGl0VG9vbCIsImxheWVyQ29kZSIsImVkaXRpbmciLCJlZGl0aW5ndG9vbGJ0blRvZ2dsZWQiLCJlZGl0aW5ndG9vbGJ0bkVuYWJsZWQiLCJ0b29sIiwiY29tcHV0ZWQiLCJlZGl0aW5nYnRubGFiZWwiLCJlZGl0aW5nYnRuRW5hYmxlZCIsImVuYWJsZWQiLCJtZXNzYWdlIiwidG9vbHN0ZXAiLCJ0b3RhbCIsInN0ZXBtZXNzYWdlIiwib25TaG93IiwiY29udGFpbmVyIiwiY29uc29sZSIsImxvZyIsIiRtb3VudCIsIiRhcHBlbmRUbyIsIm9uQ2xvc2UiLCJkZWZlcnJlZCIsIkRlZmVycmVkIiwiJGRlc3Ryb3kiLCJmYWlsIiwicmVqZWN0IiwicHJvbWlzZSIsIi4vcGFuZWwuaHRtbCIsIjkiLCJJdGVybmV0U2VydmljZSIsIl9ydW5uaW5nRWRpdG9yIiwiX2VkaXRvckNsYXNzIiwidmVjdG9yIiwic3R5bGUiLCJjb2xvciIsIlN0eWxlIiwiaW1hZ2UiLCJDaXJjbGUiLCJyYWRpdXMiLCJmaWxsIiwiRmlsbCIsInN0cm9rZSIsIlN0cm9rZSIsIndpZHRoIiwiX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIiLCJfY3VycmVudEVkaXRpbmdMYXllciIsIl9sb2FkZWRFeHRlbnQiLCJzdGFydGluZ0VkaXRpbmdUb29sIiwicmV0cmlldmluZ0RhdGEiLCJoYXNFZGl0cyIsIl9sb2FkZXIiLCJWZWN0b3JMb2FkZXJMYXllciIsIm9wdGlvbnNfbG9hZGVyIiwibGF5ZXJzIiwiYmFzZXVybCIsIm1hcFNlcnZpY2UiLCJib29sIiwidmVjdG9yTGF5ZXJzIiwiX3NldFVwVmVjdG9yTGF5ZXIiLCJfc2V0VXBFZGl0b3IiLCJmZWF0dXJlbG9ja3MiLCJzZXRGZWF0dXJlTG9ja3MiLCJpbnRlcmFjdGlvbiIsImN1cnJlbnRFZGl0aW5nTGF5ZXIiLCJfZ2V0Q3VycmVudEVkaXRpbmdMYXllciIsImFjdGl2ZVRvb2wiLCJpbnN0YW5jZSIsIm93bnNJbnRlcmFjdGlvbiIsIl9zdG9wRWRpdGluZ1Rvb2wiLCJMYXllciIsImxheWVyIiwiZ2V0UHJvamVjdCIsImdldExheWVyQnlJZCIsImdldE9yaWdOYW1lIiwiX2NhbmNlbE9yU2F2ZSIsIl9zdG9wRWRpdGluZyIsIl9zdGFydEVkaXRpbmciLCJfc3RhcnRFZGl0aW5nVG9vbCIsIl9zdG9wRWRpdG9yIiwiZ2V0TGF5ZXJDb2RlcyIsInZhbHVlcyIsIm9wdGlvbnNfZWRpdG9yIiwiZm9ybUNsYXNzIiwiRm9ybUNsYXNzIiwic2V0VmVjdG9yTGF5ZXIiLCJkaXJ0eSIsImxvYWRMYXllcnMiLCJfYWRkVG9NYXAiLCJlbWl0Iiwib25hZnRlciIsImxvYWRBbGxWZWN0b3JzRGF0YSIsInJlc2V0IiwicmVtb3ZlTGF5ZXJCeU5hbWUiLCJfdW5sb2NrTGF5ZXIiLCJfdXBkYXRlRWRpdGluZ1N0YXRlIiwiX2NsZWFuVXAiLCJjbGVhblVwTGF5ZXJzIiwiX3N0YXJ0RWRpdG9yIiwiX3NldEN1cnJlbnRFZGl0aW5nTGF5ZXIiLCJjYW5TdGFydFRvb2wiLCJ0eXBlIiwiX2Fza1R5cGUiLCJkaXJ0eUVkaXRvcnMiLCJpc0RpcnR5Iiwia2V5cyIsIl9hc2tDYW5jZWxPclNhdmUiLCJfc2F2ZUVkaXRzIiwicmVzdWx0IiwiYnV0dG9uVHlwZXMiLCJTQVZFIiwibGFiZWwiLCJjbGFzc05hbWUiLCJjYWxsYmFjayIsIk5PU0FWRSIsIkNBTkNFTCIsImJ1dHRvbnMiLCJzYXZlIiwibm9zYXZlIiwiY2FuY2VsIiwiZGlhbG9nIiwiX3NlbmRFZGl0cyIsInJlc3BvbnNlIiwic3VjY2VzcyIsIl9jb21taXRFZGl0cyIsInJlZnJlc2hNYXAiLCJlcnJvcnMiLCJlZGl0c1RvUHVzaCIsImxheWVybmFtZSIsImVkaXRzIiwiZ2V0RWRpdGVkRmVhdHVyZXMiLCJfcG9zdERhdGEiLCJyZXR1cm5lZCIsImVkaXRvcnMiLCJ1cGRhdGVkRmVhdHVyZUF0dHJpYnV0ZXMiLCJvbGRmaWQiLCJjbGllbnRpZCIsImZpZCIsImdldEVkaXRWZWN0b3JMYXllciIsInNldEZlYXR1cmVEYXRhIiwiY29tbWl0IiwiX3VuZG9FZGl0cyIsImN1cnJlbnRFZGl0aW5nTGF5ZXJDb2RlIiwiX3VwZGF0ZVRvb2xTdGVwc1N0YXRlIiwidG9vbEluc3RhbmNlIiwic3RlcHMiLCJfc2V0VG9vbFN0ZXBTdGF0ZSIsInN0ZXAiLCJpc1VuZGVmaW5lZCIsIm1lc3NhZ2VzIiwidG9vbFN0ZXBzTWVzc2FnZXMiLCJjdXJyZW50U3RlcEluZGV4IiwidG90YWxTdGVwcyIsImFkZFRvTWFwIiwiX3Bvc3RCYXRjaERhdGEiLCJsYXllck5hbWUiLCJqc29uRGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwb3N0IiwidXJsIiwiY29udGVudFR5cGUiLCJtdWx0aUVkaXRzVG9QdXNoIiwiX3VubG9jayIsImxheWVyQ29uZmlnIiwiRzNXT2JqZWN0IiwiVmVjdG9yTGF5ZXIiLCJWZWN0b3JMYXllckxvYWRlciIsImN1dGxpbmUiLCIuL2VkaXRvcnMvYWNjZXNzaWVkaXRvciIsIi4vZWRpdG9ycy9hdHRyaWJ1dGVzZm9ybSIsIi4vZWRpdG9ycy9naXVuemlvbmllZGl0b3IiLCIuL2VkaXRvcnMvc3RyYWRlZWRpdG9yIl0sIm1hcHBpbmdzIjoiQ0FBQSxRQUFVQSxHQUFFQyxFQUFFQyxFQUFFQyxHQUFHLFFBQVNDLEdBQUVDLEVBQUVDLEdBQUcsSUFBSUosRUFBRUcsR0FBRyxDQUFDLElBQUlKLEVBQUVJLEdBQUcsQ0FBQyxHQUFJRSxHQUFrQixrQkFBVEMsVUFBcUJBLE9BQVEsS0FBSUYsR0FBR0MsRUFBRSxNQUFPQSxHQUFFRixHQUFFLEVBQUksSUFBR0ksRUFBRSxNQUFPQSxHQUFFSixHQUFFLEVBQUksSUFBSUssR0FBRSxHQUFJQyxPQUFNLHVCQUF1Qk4sRUFBRSxJQUFLLE1BQU1LLEdBQUVFLEtBQUssbUJBQW1CRixFQUFFLEdBQUlHLEdBQUVYLEVBQUVHLElBQUlTLFdBQVliLEdBQUVJLEdBQUcsR0FBR1UsS0FBS0YsRUFBRUMsUUFBUSxTQUFTZCxHQUFHLEdBQUlFLEdBQUVELEVBQUVJLEdBQUcsR0FBR0wsRUFBRyxPQUFPSSxHQUFFRixFQUFFQSxFQUFFRixJQUFJYSxFQUFFQSxFQUFFQyxRQUFRZCxFQUFFQyxFQUFFQyxFQUFFQyxHQUFHLE1BQU9ELEdBQUVHLEdBQUdTLFFBQWtELElBQUksR0FBMUNMLEdBQWtCLGtCQUFURCxVQUFxQkEsUUFBZ0JILEVBQUUsRUFBRUEsRUFBRUYsRUFBRWEsT0FBT1gsSUFBSUQsRUFBRUQsRUFBRUUsR0FBSSxPQUFPRCxLQUFLYSxHQUFHLFNBQVNULEVBQVFVLEVBQU9KLEdBS3ZkLFFBQVNLLEdBQWNDLEdBQ3JCQyxFQUFLQyxLQUFLRixHQUxaLEdBQUlHLEdBQVVDLE9BQU9DLEtBQUtDLE1BQU1ILFFB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ZSI6ImJ1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIEl0ZXJuZXRFZGl0b3IgPSByZXF1aXJlKCcuL2l0ZXJuZXRlZGl0b3InKTtcblxuZnVuY3Rpb24gQWNjZXNzaUVkaXRvcihvcHRpb25zKXtcbiAgYmFzZSh0aGlzLG9wdGlvbnMpO1xufVxuXG5pbmhlcml0KEFjY2Vzc2lFZGl0b3IsIEl0ZXJuZXRFZGl0b3IpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFjY2Vzc2lFZGl0b3I7XG5cbn0se1wiLi9pdGVybmV0ZWRpdG9yXCI6NH1dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIFByb2plY3RzUmVnaXN0cnkgPSBnM3dzZGsuY29yZS5Qcm9qZWN0c1JlZ2lzdHJ5O1xudmFyIEZvcm1QYW5lbCA9IGczd3Nkay5ndWkuRm9ybVBhbmVsO1xudmFyIEZvcm0gPSBnM3dzZGsuZ3VpLkZvcm07XG5cbnZhciBJdGVybmV0Rm9ybVBhbmVsID0gRm9ybVBhbmVsLmV4dGVuZCh7XG4gIC8vdGVtcGxhdGU6IHJlcXVpcmUoJy4vYXR0cmlidXRlc2Zvcm0uaHRtbCcpXG59KTtcblxuZnVuY3Rpb24gSXRlcm5ldEZvcm0ob3B0aW9ucyl7XG4gIGJhc2UodGhpcyxvcHRpb25zKTtcbiAgdGhpcy5fZm9ybVBhbmVsID0gSXRlcm5ldEZvcm1QYW5lbDtcbn1cbmluaGVyaXQoSXRlcm5ldEZvcm0sRm9ybSk7XG5cbnZhciBwcm90byA9IEl0ZXJuZXRGb3JtLnByb3RvdHlwZTtcblxucHJvdG8uX2lzVmlzaWJsZSA9IGZ1bmN0aW9uKGZpZWxkKXtcbiAgdmFyIHJldCA9IHRydWU7XG4gIHN3aXRjaCAoZmllbGQubmFtZSl7XG4gICAgY2FzZSBcImNvZF9hY2NfZXN0XCI6XG4gICAgICB2YXIgdGlwX2FjYyA9IHRoaXMuX2dldEZpZWxkKFwidGlwX2FjY1wiKTtcbiAgICAgIGlmICh0aXBfYWNjLnZhbHVlPT1cIjAxMDFcIil7XG4gICAgICAgIHJldCA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNvZF9hY2NfaW50XCI6XG4gICAgICB2YXIgdGlwX2FjYyA9IHRoaXMuX2dldEZpZWxkKFwidGlwX2FjY1wiKTtcbiAgICAgIGlmICh0aXBfYWNjLnZhbHVlPT1cIjAxMDFcIiB8fCB0aXBfYWNjLnZhbHVlPT1cIjA1MDFcIil7XG4gICAgICAgIHJldCA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn07XG5cbnByb3RvLl9pc0VkaXRhYmxlID0gZnVuY3Rpb24oZmllbGQpe1xuICBpZiAoZmllbGQubmFtZSA9PSBcInRpcF9hY2NcIiAmJiAhdGhpcy5faXNOZXcoKSl7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICByZXR1cm4gRm9ybS5wcm90b3R5cGUuX2lzRWRpdGFibGUuY2FsbCh0aGlzLGZpZWxkKTtcbn07XG5cbnByb3RvLl9zaG91bGRTaG93UmVsYXRpb24gPSBmdW5jdGlvbihyZWxhdGlvbil7XG4gIGlmIChyZWxhdGlvbi5uYW1lPT1cIm51bWVyb19jaXZpY29cIil7XG4gICAgdmFyIHRpcF9hY2MgPSB0aGlzLl9nZXRGaWVsZChcInRpcF9hY2NcIik7XG4gICAgaWYgKHRpcF9hY2MudmFsdWUgPT0gJzAxMDInKXtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5wcm90by5fcGlja0xheWVyID0gZnVuY3Rpb24oZmllbGQpe1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBsYXllcklkID0gZmllbGQuaW5wdXQub3B0aW9ucy5sYXllcmlkO1xuICBcbiAgRm9ybS5wcm90b3R5cGUuX3BpY2tMYXllci5jYWxsKHRoaXMsZmllbGQpXG4gIC50aGVuKGZ1bmN0aW9uKGF0dHJpYnV0ZXMpe1xuICAgIHZhciBsaW5rZWRGaWVsZDtcbiAgICB2YXIgbGlua2VkRmllbGRBdHRyaWJ1dGVOYW1lO1xuICAgIFxuICAgIHN3aXRjaCAoZmllbGQubmFtZSkge1xuICAgICAgY2FzZSAnY29kX2VsZSc6XG4gICAgICAgIGxpbmtlZEZpZWxkID0gc2VsZi5fZ2V0UmVsYXRpb25GaWVsZChcImNvZF90b3BcIixcIm51bWVyb19jaXZpY29cIik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnY29kX3RvcCc6XG4gICAgICAgIGxpbmtlZEZpZWxkID0gc2VsZi5fZ2V0RmllbGQoXCJjb2RfZWxlXCIpOztcbiAgICB9XG4gICAgXG4gICAgaWYgKGxpbmtlZEZpZWxkKSB7XG4gICAgICB2YXIgcHJvamVjdCA9IFByb2plY3RzUmVnaXN0cnkuZ2V0Q3VycmVudFByb2plY3QoKTtcbiAgICAgIGxpbmtlZEZpZWxkQXR0cmlidXRlTmFtZSA9IHByb2plY3QuZ2V0TGF5ZXJBdHRyaWJ1dGVMYWJlbChsYXllcklkLGxpbmtlZEZpZWxkLmlucHV0Lm9wdGlvbnMuZmllbGQpO1xuICAgICAgaWYgKGxpbmtlZEZpZWxkICYmIGF0dHJpYnV0ZXNbbGlua2VkRmllbGRBdHRyaWJ1dGVOYW1lXSl7XG4gICAgICAgIGxpbmtlZEZpZWxkLnZhbHVlID0gYXR0cmlidXRlc1tsaW5rZWRGaWVsZEF0dHJpYnV0ZU5hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfSlcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSXRlcm5ldEZvcm07XG5cbn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIGJhc2UgPSBnM3dzZGsuY29yZS51dGlscy5iYXNlO1xudmFyIEl0ZXJuZXRFZGl0b3IgPSByZXF1aXJlKCcuL2l0ZXJuZXRlZGl0b3InKTtcblxuZnVuY3Rpb24gR2l1bnppb25pRWRpdG9yKG9wdGlvbnMpe1xuICBiYXNlKHRoaXMsb3B0aW9ucyk7XG4gIFxuICB0aGlzLl9zZXJ2aWNlID0gbnVsbDtcbiAgdGhpcy5fc3RyYWRlRWRpdG9yID0gbnVsbDtcbiAgdGhpcy5fZ2l1bnppb25lR2VvbUxpc3RlbmVyID0gbnVsbDtcbiAgXG4gIC8qIElOSVpJTyBNT0RJRklDQSBUT1BPTE9HSUNBIERFTExFIEdJVU5aSU9OSSAqL1xuICBcbiAgdGhpcy5fc2V0dXBNb3ZlR2l1bnppb25pTGlzdGVuZXIgPSBmdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLm9uKCdtb3Zlc3RhcnQnLGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgICAgLy8gcmltdW92byBldmVudHVhbGkgcHJlY2VkZW50aSBsaXN0ZW5lcnNcbiAgICAgIHNlbGYuX3N0YXJ0TW92aW5nR2l1bnppb25lKGZlYXR1cmUpO1xuICAgIH0pO1xuICB9O1xuICBcbiAgdGhpcy5fc3RyYWRlVG9VcGRhdGUgPSBbXTtcbiAgXG4gIHRoaXMuX3N0YXJ0TW92aW5nR2l1bnppb25lID0gZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB2ZWN0b3JMYXllciA9IHRoaXMuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgICB2YXIgc3RyYWRlRWRpdG9yID0gdGhpcy5fc3RyYWRlRWRpdG9yO1xuICAgIHZhciBnaXVuemlvbmUgPSBmZWF0dXJlO1xuICAgIHZhciBjb2RfZ256ID0gZ2l1bnppb25lLmdldCgnY29kX2dueicpO1xuICAgIC8vIGRldm8gYXZ2aWFyZSBsJ2VkaXRvciBkZWxsZSBzdHJhZGVcbiAgICB0aGlzLl9zdHJhZGVUb1VwZGF0ZSA9IFtdO1xuICAgIHZhciBzdHJhZGUgPSBzdHJhZGVFZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKS5nZXRTb3VyY2UoKS5nZXRGZWF0dXJlcygpO1xuICAgIF8uZm9yRWFjaChzdHJhZGUsZnVuY3Rpb24oc3RyYWRhKXtcbiAgICAgIHZhciBub2RfaW5pID0gc3RyYWRhLmdldCgnbm9kX2luaScpO1xuICAgICAgdmFyIG5vZF9maW4gPSBzdHJhZGEuZ2V0KCdub2RfZmluJyk7XG4gICAgICB2YXIgaW5pID0gKG5vZF9pbmkgPT0gY29kX2dueik7XG4gICAgICB2YXIgZmluID0gKG5vZF9maW4gPT0gY29kX2dueik7XG4gICAgICBpZiAoaW5pIHx8IGZpbil7XG4gICAgICAgIHZhciBpbml0aWFsID0gaW5pID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICBzZWxmLl9zdHJhZGVUb1VwZGF0ZS5wdXNoKHN0cmFkYSk7XG4gICAgICAgIHNlbGYuX3N0YXJ0R2l1bnppb25pU3RyYWRlVG9wb2xvZ2ljYWxFZGl0aW5nKGdpdW56aW9uZSxzdHJhZGEsaW5pdGlhbClcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLm9uY2UoJ21vdmVlbmQnLGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgICAgaWYgKCBzZWxmLl9zdHJhZGVUb1VwZGF0ZS5sZW5ndGgpe1xuICAgICAgICBpZiAoIXN0cmFkZUVkaXRvci5pc1N0YXJ0ZWQoKSl7XG4gICAgICAgICAgc3RyYWRlRWRpdG9yLnN0YXJ0KHRoaXMuX3NlcnZpY2UpO1xuICAgICAgICB9XG4gICAgICAgIF8uZm9yRWFjaCggc2VsZi5fc3RyYWRlVG9VcGRhdGUsZnVuY3Rpb24oc3RyYWRhKXtcbiAgICAgICAgICBzdHJhZGVFZGl0b3IudXBkYXRlRmVhdHVyZShzdHJhZGEpO1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBcbiAgdGhpcy5fc3RhcnRHaXVuemlvbmlTdHJhZGVUb3BvbG9naWNhbEVkaXRpbmcgPSBmdW5jdGlvbihnaXVuemlvbmUsc3RyYWRhLGluaXRpYWwpe1xuICAgIHZhciBzdHJhZGFHZW9tID0gc3RyYWRhLmdldEdlb21ldHJ5KCk7XG4gICAgdmFyIHN0cmFkYUNvb3JkcyA9IHN0cmFkYS5nZXRHZW9tZXRyeSgpLmdldENvb3JkaW5hdGVzKCk7XG4gICAgdmFyIGNvb3JkSW5kZXggPSBpbml0aWFsID8gMCA6IHN0cmFkYUNvb3Jkcy5sZW5ndGgtMTtcbiAgICB2YXIgZ2l1bnppb25lR2VvbSA9IGdpdW56aW9uZS5nZXRHZW9tZXRyeSgpO1xuICAgIHZhciBsaXN0ZW5lcktleSA9IGdpdW56aW9uZUdlb20ub24oJ2NoYW5nZScsZnVuY3Rpb24oZSl7XG4gICAgICBzdHJhZGFDb29yZHNbY29vcmRJbmRleF0gPSBlLnRhcmdldC5nZXRDb29yZGluYXRlcygpO1xuICAgICAgc3RyYWRhR2VvbS5zZXRDb29yZGluYXRlcyhzdHJhZGFDb29yZHMpO1xuICAgIH0pO1xuICAgIHRoaXMuX2dpdW56aW9uZUdlb21MaXN0ZW5lciA9IGxpc3RlbmVyS2V5O1xuICB9O1xuICBcbiAgLyogRklORSBNT0RJRklDQSBUT1BPTE9HSUNBIEdJVU5aSU9OSSAqL1xuICBcbiAgLyogSU5JWklPIFJJTU9aSU9ORSBHSVVOWklPTkkgKi9cbiAgXG4gIHRoaXMuX3NldHVwRGVsZXRlR2l1bnppb25pTGlzdGVuZXIgPSBmdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgc3RyYWRlRWRpdG9yID0gdGhpcy5fc3RyYWRlRWRpdG9yO1xuICAgIHRoaXMub25iZWZvcmVhc3luYygnZGVsZXRlRmVhdHVyZScsZnVuY3Rpb24oZmVhdHVyZSxpc05ldyxuZXh0KXtcbiAgICAgIHZhciBzdG9wRGVsZXRpb24gPSBmYWxzZTtcbiAgICAgIHZhciBzdHJhZGVWZWN0b3JMYXllciA9IHN0cmFkZUVkaXRvci5nZXRWZWN0b3JMYXllcigpO1xuICAgICAgXy5mb3JFYWNoKHN0cmFkZVZlY3RvckxheWVyLmdldEZlYXR1cmVzKCksZnVuY3Rpb24oc3RyYWRhKXtcbiAgICAgICAgdmFyIGNvZF9nbnogPSBmZWF0dXJlLmdldCgnY29kX2dueicpO1xuICAgICAgICB2YXIgbm9kX2luaSA9IHN0cmFkYS5nZXQoJ25vZF9pbmknKTtcbiAgICAgICAgdmFyIG5vZF9maW4gPSBzdHJhZGEuZ2V0KCdub2RfZmluJyk7XG4gICAgICAgIHZhciBpbmkgPSAobm9kX2luaSA9PSBjb2RfZ256KTtcbiAgICAgICAgdmFyIGZpbiA9IChub2RfZmluID09IGNvZF9nbnopO1xuICAgICAgICBpZiAoaW5pIHx8IGZpbil7XG4gICAgICAgICAgc3RvcERlbGV0aW9uID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmIChzdG9wRGVsZXRpb24pe1xuICAgICAgICBHVUkubm90aWZ5LmVycm9yKFwiTm9uIMOoIHBvc3NpYmlsZSByaW11b3ZlcmUgbGEgZ2l1bnppb25pIHBlcmNow6kgcmlzdWx0YSBjb25uZXNzYSBhZCB1bmEgbyBwacO5IHN0cmFkZVwiKTtcbiAgICAgIH1cbiAgICAgIG5leHQoIXN0b3BEZWxldGlvbik7XG4gICAgfSk7XG4gIH07XG4gIFxuICAvKiBGSU5FICovXG59XG5pbmhlcml0KEdpdW56aW9uaUVkaXRvcixJdGVybmV0RWRpdG9yKTtcbm1vZHVsZS5leHBvcnRzID0gR2l1bnppb25pRWRpdG9yO1xuXG52YXIgcHJvdG8gPSBHaXVuemlvbmlFZGl0b3IucHJvdG90eXBlO1xuXG5wcm90by5zdGFydCA9IGZ1bmN0aW9uKGl0ZXJuZXRTZXJ2aWNlKSB7XG4gIHRoaXMuX3NlcnZpY2UgPSBpdGVybmV0U2VydmljZTtcbiAgdGhpcy5fc3RyYWRlRWRpdG9yID0gaXRlcm5ldFNlcnZpY2UuX2xheWVyc1tpdGVybmV0U2VydmljZS5sYXllckNvZGVzLlNUUkFERV0uZWRpdG9yO1xuICB0aGlzLl9zZXR1cE1vdmVHaXVuemlvbmlMaXN0ZW5lcigpO1xuICB0aGlzLl9zZXR1cERlbGV0ZUdpdW56aW9uaUxpc3RlbmVyKCk7XG4gIHJldHVybiBJdGVybmV0RWRpdG9yLnByb3RvdHlwZS5zdGFydC5jYWxsKHRoaXMpO1xufTtcblxucHJvdG8uc3RvcCA9IGZ1bmN0aW9uKCl7XG4gIHZhciByZXQgPSBmYWxzZTtcbiAgaWYgKEl0ZXJuZXRFZGl0b3IucHJvdG90eXBlLnN0b3AuY2FsbCh0aGlzKSl7XG4gICAgcmV0ID0gdHJ1ZTtcbiAgICBvbC5PYnNlcnZhYmxlLnVuQnlLZXkodGhpcy5fZ2l1bnppb25lR2VvbUxpc3RlbmVyKTtcbiAgfVxuICByZXR1cm4gcmV0O1xufTtcblxucHJvdG8uc2V0VG9vbCA9IGZ1bmN0aW9uKHRvb2xUeXBlKXtcbiAgdmFyIG9wdGlvbnM7XG4gIGlmICh0b29sVHlwZT09J2FkZGZlYXR1cmUnKXtcbiAgICBvcHRpb25zID0ge1xuICAgICAgc25hcDoge1xuICAgICAgICB2ZWN0b3JMYXllcjogdGhpcy5fc3RyYWRlRWRpdG9yLmdldFZlY3RvckxheWVyKClcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIEl0ZXJuZXRFZGl0b3IucHJvdG90eXBlLnNldFRvb2wuY2FsbCh0aGlzLHRvb2xUeXBlLG9wdGlvbnMpO1xufTtcblxufSx7XCIuL2l0ZXJuZXRlZGl0b3JcIjo0fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgRWRpdG9yID0gZzN3c2RrLmNvcmUuRWRpdG9yO1xudmFyIEdVSSA9IGczd3Nkay5ndWkuR1VJO1xuXG52YXIgRm9ybSA9IHJlcXVpcmUoJy4vYXR0cmlidXRlc2Zvcm0nKTtcbnZhciBmb3JtID0gbnVsbDsgLy8gYnJ1dHRvIG1hIGRldm8gdGVuZXJsbyBlc3Rlcm5vIHNlbm7DsiBzaSBjcmVhIHVuIGNsaWNvIGRpIHJpZmVyaW1lbnRpIGNoZSBtYW5kYSBpbiBwYWxsYSBWdWVcbiAgXG5mdW5jdGlvbiBJdGVybmV0RWRpdG9yKG9wdGlvbnMpIHtcblxuICAvLyBpbiBxdWVzdG8gbW9kbyBwYXNzaWFtbyBpbCBtYXBzZXJ2aWNlIGNvbWUgYXJnb21lbnRvIGFsIHN1cGVyY2xhc3MgKGVkaXRvcilcbiAgLy8gZGkgaXRlcm5ldGVkaXRvciBpbiBtb2RvIGRhIGFzc2VnbmFyYWUgYW5jaGUgYSBpdGVybmV0ZWRpdG9yIGlsIG1hcHNlcnZlaWNlIGNoZSB4c2Vydmlyw6AgYWQgZXNlbXBpbyBhZCBhZ2dpdW5nZXJlXG4gIC8vIGwnaW50ZXJhY3Rpb24gYWxsYSBtYXBwYSBxdWFuZG8gdmllbmUgY2xpY2NhdG8gc3UgdW4gdG9vbFxuICBiYXNlKHRoaXMsIG9wdGlvbnMpO1xuXG4gIC8vIGFwcmUgZm9ybSBhdHRyaWJ1dGkgcGVyIGluc2VyaW1lbnRvXG59XG5cbmluaGVyaXQoSXRlcm5ldEVkaXRvciwgRWRpdG9yKTtcblxubW9kdWxlLmV4cG9ydHMgPSBJdGVybmV0RWRpdG9yO1xuXG59LHtcIi4vYXR0cmlidXRlc2Zvcm1cIjoyfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgYmFzZSA9IGczd3Nkay5jb3JlLnV0aWxzLmJhc2U7XG52YXIgR1VJID0gZzN3c2RrLmd1aS5HVUk7XG52YXIgSXRlcm5ldEVkaXRvciA9IHJlcXVpcmUoJy4vaXRlcm5ldGVkaXRvcicpO1xuXG5cbmZ1bmN0aW9uIFN0cmFkZUVkaXRvcihvcHRpb25zKXtcbiAgYmFzZSh0aGlzLG9wdGlvbnMpO1xuICBcbiAgdGhpcy5fc2VydmljZSA9IG51bGw7XG4gIHRoaXMuX2dpdW56aW9uaUVkaXRvciA9IG51bGw7XG4gIFxuICB0aGlzLl9tYXBTZXJ2aWNlID0gR1VJLmdldENvbXBvbmVudCgnbWFwJykuZ2V0U2VydmljZSgpO1xuICBcbiAgdGhpcy5fc3RyYWRlU25hcHMgPSBudWxsO1xuICBcbiAgdGhpcy5fc3RyYWRlU25hcHNDb2xsZWN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc25hcHMgPSBbXTtcbiAgICB0aGlzLmxlbmd0aCA9IDA7XG4gICAgXG4gICAgdGhpcy5wdXNoID0gZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICB2YXIgcHVzaGVkID0gZmFsc2U7XG4gICAgICBpZiAodGhpcy5jYW5TbmFwKGZlYXR1cmUpKXtcbiAgICAgICAgc25hcHMucHVzaChmZWF0dXJlKTtcbiAgICAgICAgdGhpcy5sZW5ndGggKz0gMTtcbiAgICAgICAgcHVzaGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwdXNoZWQ7XG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmdldExhc3QgPSBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHNuYXBzW3NuYXBzLmxlbmd0aC0xXTtcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuZ2V0Rmlyc3QgPSBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHNuYXBzWzBdO1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKCl7XG4gICAgICBzbmFwcy5zcGxpY2UoMCxzbmFwcy5sZW5ndGgpO1xuICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5nZXRTbmFwcyA9IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gc25hcHM7XG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmNhblNuYXAgPSBmdW5jdGlvbihmZWF0dXJlKXtcbiAgICAgIGlmICh0aGlzLmlzQWxyZWFkeVNuYXBwZWQoZmVhdHVyZSkpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgY29kX2dueiA9IGZlYXR1cmUuZ2V0KCdjb2RfZ256Jyk7XG4gICAgICByZXR1cm4gKCFfLmlzTmlsKGNvZF9nbnopICYmIGNvZF9nbnogIT0gJycpO1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5pc0FscmVhZHlTbmFwcGVkID0gZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICByZXR1cm4gXy5pbmNsdWRlcyh0aGlzLnNuYXBzLGZlYXR1cmUpO1xuICAgIH1cbiAgfTtcbiAgXG4gIHRoaXMuX3VwZGF0ZVN0cmFkYUF0dHJpYnV0ZXMgPSBmdW5jdGlvbihmZWF0dXJlKXtcbiAgICB2YXIgc25hcHMgPSB0aGlzLl9zdHJhZGVTbmFwcztcbiAgICBmZWF0dXJlLnNldCgnbm9kX2luaScsc25hcHMuZ2V0U25hcHMoKVswXS5nZXQoJ2NvZF9nbnonKSk7XG4gICAgZmVhdHVyZS5zZXQoJ25vZF9maW4nLHNuYXBzLmdldFNuYXBzKClbMV0uZ2V0KCdjb2RfZ256JykpO1xuICB9O1xuICBcbiAgLyogQ09OVFJPTExPIEdJVU5aSU9OSSBQRVIgTEUgU1RSQURFIE5PTiBDT01QTEVUQU1FTlRFIENPTlRFTlVURSBORUxMQSBWSVNUQSAqL1xuICBcbiAgLy8gcGVyIGxlIHN0cmFkZSBwcmVzZW50aSBuZWxsYSB2aXN0YSBjYXJpY2EgbGUgZ2l1bnppb25pIGV2ZW50dWFsbWVudGUgbWFuY2FudGkgKGVzdGVybmUgYWxsYSB2aXN0YSlcbiAgdGhpcy5fbG9hZE1pc3NpbmdHaXVuemlvbmlJblZpZXcgPSBmdW5jdGlvbigpe1xuICAgIHZhciB2ZWN0b3JMYXllciA9IHRoaXMuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgICB2YXIgZ2l1bnppb25pVmVjdG9yTGF5ZXIgPSB0aGlzLl9naXVuemlvbmlFZGl0b3IuZ2V0VmVjdG9yTGF5ZXIoKTtcbiAgICBcbiAgICB2YXIgc3RyYWRlU291cmNlID0gdmVjdG9yTGF5ZXIuZ2V0U291cmNlKCk7XG4gICAgdmFyIGV4dGVudCA9IG9sLmV4dGVudC5idWZmZXIoc3RyYWRlU291cmNlLmdldEV4dGVudCgpLDEpO1xuICAgIHRoaXMuX3NlcnZpY2UuX2xvYWRWZWN0b3JEYXRhKGdpdW56aW9uaVZlY3RvckxheWVyLGV4dGVudCk7XG4gIH07XG4gIFxuICAvKiBGSU5FICovXG4gIFxuICAvKiBJTklaSU8gR0VTVElPTkUgVklOQ09MTyBTTkFQIFNVIEdJVU5aSU9OSSBEVVJBTlRFIElMIERJU0VHTk8gREVMTEUgU1RSQURFICovXG4gIFxuICB0aGlzLl9kcmF3UmVtb3ZlTGFzdFBvaW50ID0gXy5iaW5kKGZ1bmN0aW9uKGUpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdG9vbFR5cGUgPSB0aGlzLmdldEFjdGl2ZVRvb2woKS5nZXRUeXBlKCk7XG4gICAgLy8gaWwgbGlzdGVuZXIgdmllbmUgYXR0aXZhdG8gcGVyIHR1dHRpIGkgdG9vbCBkZWxsJ2VkaXRvciBzdHJhZGUsIHBlciBjdWkgZGV2byBjb250cm9sbGFyZSBjaGUgc2lhIHF1ZWxsbyBnaXVzdG9cbiAgICBpZiAodG9vbFR5cGUgPT0gJ2FkZGZlYXR1cmUnKXtcbiAgICAgIC8vIENBTkNcbiAgICAgIGlmKGUua2V5Q29kZT09NDYpe1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHNlbGYuZ2V0QWN0aXZlVG9vbCgpLmdldFRvb2woKS5yZW1vdmVMYXN0UG9pbnQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sdGhpcyk7XG4gIFxuICB0aGlzLl9zZXR1cERyYXdTdHJhZGVDb25zdHJhaW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBtYXBJZCA9IHRoaXMuX21hcFNlcnZpY2Uudmlld2VyLm1hcC5nZXRUYXJnZXRFbGVtZW50KCkuaWQ7XG4gICAgdmFyIG1hcCA9IHRoaXMuX21hcFNlcnZpY2Uudmlld2VyLm1hcDtcbiAgICBcbiAgICB2YXIgZHJhd2luZ0dlb21ldHJ5ID0gbnVsbDtcbiAgICBcbiAgICB0aGlzLm9uYmVmb3JlKCdhZGRGZWF0dXJlJyxmdW5jdGlvbihmZWF0dXJlKXtcbiAgICAgIHZhciBzbmFwcyA9IHNlbGYuX3N0cmFkZVNuYXBzO1xuICAgICAgaWYgKHNuYXBzLmxlbmd0aCA9PSAyKXtcbiAgICAgICAgc2VsZi5fdXBkYXRlU3RyYWRhQXR0cmlidXRlcyhmZWF0dXJlKTtcbiAgICAgICAgc25hcHMuY2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSwwKTtcbiAgfTtcbiAgXG4gIHRoaXMuX2dldENoZWNrU25hcHNDb25kaXRpb24gPSBmdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvLyBhZCBvZ25pIGNsaWNrIGNvbnRyb2xsbyBzZSBjaSBzb25vIGRlZ2xpIHNuYXAgY29uIGxlIGdpdW56aW9uaVxuICAgIHJldHVybiBmdW5jdGlvbihlKXtcbiAgICAgIHZhciBzbmFwcyA9IHNlbGYuX3N0cmFkZVNuYXBzO1xuICAgICAgaWYgKHNuYXBzLmxlbmd0aCA9PSAyKXtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBHVUkubm90aWZ5LmVycm9yKFwiTCd1bHRpbW8gdmVydGljZSBkZXZlIGNvcnJpc3BvbmRlcmUgY29uIHVuYSBnaXVuemlvbmVcIik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuICBcbiAgLy8gYWQgb2duaSBjbGljayBjb250cm9sbG8gc2UgY2kgc29ubyBkZWdsaSBzbmFwIGNvbiBsZSBnaXVuemlvbmlcbiAgdGhpcy5fZ2V0U3RyYWRhSXNCZWluZ1NuYXBwZWRDb25kaXRpb24gPSBmdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgbWFwID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwO1xuICAgIHZhciBnaXVuemlvbmlWZWN0b3JMYXllciA9IHRoaXMuX2dpdW56aW9uaUVkaXRvci5nZXRWZWN0b3JMYXllcigpO1xuICAgIFxuICAgIHJldHVybiBmdW5jdGlvbihlKXtcbiAgICAgIHZhciBzbmFwcyA9IHNlbGYuX3N0cmFkZVNuYXBzO1xuICAgICAgdmFyIGMgPSBtYXAuZ2V0Q29vcmRpbmF0ZUZyb21QaXhlbChlLnBpeGVsKTtcbiAgICAgIHZhciBnaXVuemlvbmlTb3VyY2UgPSBnaXVuemlvbmlWZWN0b3JMYXllci5nZXRTb3VyY2UoKTtcbiAgICAgIHZhciBleHRlbnQgPSBvbC5leHRlbnQuYnVmZmVyKFtjWzBdLGNbMV0sY1swXSxjWzFdXSwxKTtcbiAgICAgIHZhciBzbmFwcGVkRmVhdHVyZSA9IGdpdW56aW9uaVNvdXJjZS5nZXRGZWF0dXJlc0luRXh0ZW50KGV4dGVudClbMF07XG4gICAgICBcbiAgICAgIC8vIHNlIGhvIGdpw6AgZHVlIHNuYXAgZSBxdWVzdG8gY2xpY2sgbm9uIMOoIHN1IHVuJ2FsdHJhIGdpdW56aW9uZSwgb3BwdXJlIHNlIGhvIHBpw7kgZGkgMiBzbmFwLCBub24gcG9zc28gaW5zZXJpcmUgdW4gdWx0ZXJpb3JlIHZlcnRpY2VcbiAgICAgIGlmICgoc25hcHMubGVuZ3RoID09IDIgJiYgKCFzbmFwcGVkRmVhdHVyZSB8fCBzbmFwcGVkRmVhdHVyZSAhPSBzbmFwcy5nZXRTbmFwcygpWzFdKSkpe1xuICAgICAgICB2YXIgbGFzdFNuYXBwZWRcbiAgICAgICAgR1VJLm5vdGlmeS5lcnJvcihcIlVuYSBzdHJhZGEgbm9uIHB1w7IgYXZlcmUgdmVydGljaSBpbnRlcm1lZGkgaW4gY29ycmlzcG9uZGVuemEgZGkgZ2l1bnppb25pLjxicj4gUHJlbWVyZSA8Yj5DQU5DPC9iPiBwZXIgcmltdW92ZXJlIGwndWx0aW1vIHZlcnRpY2UuXCIpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChzbmFwcGVkRmVhdHVyZSAmJiBzbmFwcy5sZW5ndGggPCAyKXtcbiAgICAgICAgc25hcHMucHVzaChzbmFwcGVkRmVhdHVyZSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIHNlIG5vbiBjaSBzb25vIHNuYXAsIHZ1b2wgZGlyZSBjaGUgc29ubyBhbmNvcmEgYWwgcHJpbW8gY2xpY2sgZSBub24gaG8gc25hcHBhdG8gY29uIGxhIGdpdW56aW9uZSBpbml6aWFsZVxuICAgICAgaWYgKHNuYXBzLmxlbmd0aCA9PSAwKXtcbiAgICAgICAgR1VJLm5vdGlmeS5lcnJvcihcIklsIHByaW1vIHZlcnRpY2UgZGV2ZSBjb3JyaXNwb25kZXJlIGNvbiB1bmEgZ2l1bnppb25lXCIpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG4gIFxuICAvKiBGSU5FIERJU0VHTk8gKi9cbiAgXG4gIC8qIElOSVpJTyBDT05UUk9MTEkgU1UgTU9ESUZJQ0EgKi9cbiAgXG4gIHRoaXMuX21vZGlmeVJlbW92ZVBvaW50ID0gXy5iaW5kKGZ1bmN0aW9uKGUpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdG9vbFR5cGUgPSB0aGlzLmdldEFjdGl2ZVRvb2woKS5nZXRUeXBlKCk7XG4gICAgaWYgKHRvb2xUeXBlID09ICdtb2RpZnl2ZXJ0ZXgnKXtcbiAgICAgIGlmKGUua2V5Q29kZT09NDYpe1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHNlbGYuZ2V0QWN0aXZlVG9vbCgpLmdldFRvb2woKS5yZW1vdmVQb2ludCgpO1xuICAgICAgfVxuICAgIH1cbiAgfSx0aGlzKTtcbiAgXG4gIHRoaXMuX3NldHVwTW9kaWZ5VmVydGV4U3RyYWRlQ29uc3RyYWludHMgPSBmdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgbWFwID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwO1xuICAgIHRoaXMub25iZWZvcmUoJ21vZGlmeUZlYXR1cmUnLGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgICAgdmFyIHNuYXBzID0gc2VsZi5fc3RyYWRlU25hcHM7XG4gICAgICB2YXIgY29ycmVjdCA9IHNlbGYuX2NoZWNrU3RyYWRhSXNDb3JyZWN0bHlTbmFwcGVkKGZlYXR1cmUuZ2V0R2VvbWV0cnkoKSk7XG4gICAgICBpZiAoY29ycmVjdCl7XG4gICAgICAgIHNlbGYuX3VwZGF0ZVN0cmFkYUF0dHJpYnV0ZXMoZmVhdHVyZSk7XG4gICAgICAgIHNuYXBzLmNsZWFyKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY29ycmVjdDtcbiAgICB9KTtcbiAgfTtcbiAgXG4gIHRoaXMuX2NoZWNrU3RyYWRhSXNDb3JyZWN0bHlTbmFwcGVkID0gZnVuY3Rpb24oZ2VvbWV0cnkpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgcmV0ID0gdHJ1ZTtcbiAgICB2YXIgbWFwID0gdGhpcy5fbWFwU2VydmljZS52aWV3ZXIubWFwO1xuICAgIHZhciBnaXVuemlvbmlWZWN0b3JMYXllciA9IHRoaXMuX2dpdW56aW9uaUVkaXRvci5nZXRWZWN0b3JMYXllcigpO1xuICAgIHRoaXMuX3N0cmFkZVNuYXBzLmNsZWFyKCk7XG4gICAgdmFyIHNuYXBzID0gdGhpcy5fc3RyYWRlU25hcHM7XG4gICAgdmFyIGNvb3JkaW5hdGVzID0gZ2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICBcbiAgICB2YXIgZmlyc3RWZXJ0ZXhTbmFwcGVkID0gZmFsc2U7XG4gICAgdmFyIGxhc3RWZXJ0ZXhTbmFwcGVkID0gZmFsc2U7XG4gICAgXG4gICAgXy5mb3JFYWNoKGNvb3JkaW5hdGVzLGZ1bmN0aW9uKGMsaW5kZXgpeyAgICAgIFxuICAgICAgdmFyIGdpdW56aW9uaVNvdXJjZSA9IGdpdW56aW9uaVZlY3RvckxheWVyLmdldFNvdXJjZSgpO1xuICAgICAgXG4gICAgICB2YXIgZXh0ZW50ID0gb2wuZXh0ZW50LmJ1ZmZlcihbY1swXSxjWzFdLGNbMF0sY1sxXV0sMC4xKTtcbiAgICAgIFxuICAgICAgdmFyIHNuYXBwZWRGZWF0dXJlID0gZ2l1bnppb25pU291cmNlLmdldEZlYXR1cmVzSW5FeHRlbnQoZXh0ZW50KVswXTtcbiAgICAgIFxuICAgICAgaWYgKHNuYXBwZWRGZWF0dXJlKXtcbiAgICAgICAgaWYgKGluZGV4ID09IDAgJiYgc25hcHMucHVzaChzbmFwcGVkRmVhdHVyZSkpe1xuICAgICAgICAgIGZpcnN0VmVydGV4U25hcHBlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5kZXggPT0gKGNvb3JkaW5hdGVzLmxlbmd0aC0xKSAmJiBzbmFwcy5wdXNoKHNuYXBwZWRGZWF0dXJlKSl7XG4gICAgICAgICAgbGFzdFZlcnRleFNuYXBwZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIGlmIChzbmFwcy5sZW5ndGggPiAyKXtcbiAgICAgIEdVSS5ub3RpZnkuZXJyb3IoXCJVbmEgc3RyYWRhIG5vbiBwdcOyIGF2ZXJlIHZlcnRpY2kgaW50ZXJtZWRpIGluIGNvcnJpc3BvbmRlbnphIGRpIGdpdW56aW9uaVwiKTtcbiAgICAgIHJldCA9IGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIWZpcnN0VmVydGV4U25hcHBlZCl7XG4gICAgICBHVUkubm90aWZ5LmVycm9yKFwiSWwgcHJpbW8gdmVydGljZSBkZXZlIGNvcnJpc3BvbmRlcmUgY29uIHVuYSBnaXVuemlvbmVcIik7XG4gICAgICByZXQgPSBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgaWYgKCFsYXN0VmVydGV4U25hcHBlZCl7XG4gICAgICBHVUkubm90aWZ5LmVycm9yKFwiTCd1bHRpbW8gdmVydGljZSBkZXZlIGNvcnJpc3BvbmRlcmUgY29uIHVuYSBnaXVuemlvbmVcIik7XG4gICAgICByZXQgPSBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfTtcbiAgXG4gIC8qIEZJTkUgTU9ESUZJQ0EgKi9cbiAgXG4gIC8qIElOSVpJTyBUQUdMSU8gKi9cbiAgXG4gIHRoaXMuX3NldHVwU3RyYWRlQ3V0dGVyUG9zdFNlbGVjdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMub25iZWZvcmVhc3luYygnY3V0TGluZScsZnVuY3Rpb24oZGF0YSxtb2RUeXBlLG5leHQpe1xuICAgICAgaWYgKG1vZFR5cGUgPT0gJ01PRE9OQ1VUJyl7XG4gICAgICAgIC8vIGxhIHByaW1hIGZlYXR1cmUgaW4gZGF0YS5hZGQgw6ggcXVlbGxhIGRhIGFnZ2l1bmdlcmUgY29tZSBudW92YVxuICAgICAgICB2YXIgbmV3RmVhdHVyZSA9IGRhdGEuYWRkZWRbMF07XG4gICAgICAgIHZhciBuZXdGZWF0dXJlU25hcHMgPSBzZWxmLl9nZXRGaXJzdExhc3RTbmFwcGVkR2l1bnppb25pKG5ld0ZlYXR1cmUuZ2V0R2VvbWV0cnkoKSk7XG4gICAgICAgIG5ld0ZlYXR1cmUuc2V0KCdub2RfaW5pJyxuZXdGZWF0dXJlU25hcHNbMF0uZ2V0KCdjb2RfZ256JykpO1xuICAgICAgICBuZXdGZWF0dXJlLnNldCgnbm9kX2ZpbicsbmV3RmVhdHVyZVNuYXBzWzFdLmdldCgnY29kX2dueicpKTtcbiAgICAgICAgXG4gICAgICAgIHZhciB1cGRhdGVGZWF0dXJlID0gZGF0YS51cGRhdGVkO1xuICAgICAgICB2YXIgdXBkYXRlRmVhdHVyZVNuYXBzID0gc2VsZi5fZ2V0Rmlyc3RMYXN0U25hcHBlZEdpdW56aW9uaSh1cGRhdGVGZWF0dXJlLmdldEdlb21ldHJ5KCkpO1xuICAgICAgICB1cGRhdGVGZWF0dXJlLnNldCgnbm9kX2luaScsdXBkYXRlRmVhdHVyZVNuYXBzWzBdLmdldCgnY29kX2dueicpKTtcbiAgICAgICAgdXBkYXRlRmVhdHVyZS5zZXQoJ25vZF9maW4nLHVwZGF0ZUZlYXR1cmVTbmFwc1sxXS5nZXQoJ2NvZF9nbnonKSk7XG4gICAgICAgIFxuICAgICAgICBzZWxmLl9vcGVuRWRpdG9yRm9ybSgnbmV3JyxuZXdGZWF0dXJlLG5leHQpO1xuICAgICAgICBcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBuZXh0KHRydWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBcbiAgdGhpcy5fZ2V0Rmlyc3RMYXN0U25hcHBlZEdpdW56aW9uaSA9IGZ1bmN0aW9uKGdlb21ldHJ5KXtcbiAgICB2YXIgY29vcmRpbmF0ZXMgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuICAgIHZhciBnaXVuemlvbmlWZWN0b3JMYXllciA9IHRoaXMuX2dpdW56aW9uaUVkaXRvci5nZXRWZWN0b3JMYXllcigpO1xuICAgIHZhciBmaXJzdFZlcnRleFNuYXBwZWQgPSBudWxsO1xuICAgIHZhciBsYXN0VmVydGV4U25hcHBlZCA9IG51bGw7XG4gICAgXG4gICAgXy5mb3JFYWNoKGNvb3JkaW5hdGVzLGZ1bmN0aW9uKGMsaW5kZXgpeyAgICAgIFxuICAgICAgdmFyIGdpdW56aW9uaVNvdXJjZSA9IGdpdW56aW9uaVZlY3RvckxheWVyLmdldFNvdXJjZSgpO1xuICAgICAgXG4gICAgICB2YXIgZXh0ZW50ID0gb2wuZXh0ZW50LmJ1ZmZlcihbY1swXSxjWzFdLGNbMF0sY1sxXV0sMC4xKTtcbiAgICAgIFxuICAgICAgdmFyIHNuYXBwZWRGZWF0dXJlID0gZ2l1bnppb25pU291cmNlLmdldEZlYXR1cmVzSW5FeHRlbnQoZXh0ZW50KVswXTtcbiAgICAgIFxuICAgICAgaWYgKHNuYXBwZWRGZWF0dXJlKXtcbiAgICAgICAgaWYgKGluZGV4ID09IDApe1xuICAgICAgICAgIGZpcnN0VmVydGV4U25hcHBlZCA9IHNuYXBwZWRGZWF0dXJlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluZGV4ID09IChjb29yZGluYXRlcy5sZW5ndGgtMSkpe1xuICAgICAgICAgIGxhc3RWZXJ0ZXhTbmFwcGVkID0gc25hcHBlZEZlYXR1cmU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gW2ZpcnN0VmVydGV4U25hcHBlZCxsYXN0VmVydGV4U25hcHBlZF07XG4gIH1cbiAgXG4gIC8qIEZJTkUgVEFHTElPICovXG59O1xuaW5oZXJpdChTdHJhZGVFZGl0b3IsSXRlcm5ldEVkaXRvcik7XG5tb2R1bGUuZXhwb3J0cyA9IFN0cmFkZUVkaXRvcjtcblxudmFyIHByb3RvID0gU3RyYWRlRWRpdG9yLnByb3RvdHlwZTtcblxucHJvdG8uc3RhcnQgPSBmdW5jdGlvbihpdGVybmV0U2VydmljZSl7XG4gIHRoaXMuX3NlcnZpY2UgPSBpdGVybmV0U2VydmljZTtcbiAgdGhpcy5fZ2l1bnppb25pRWRpdG9yID0gaXRlcm5ldFNlcnZpY2UuX2xheWVyc1tpdGVybmV0U2VydmljZS5sYXllckNvZGVzLkdJVU5aSU9OSV0uZWRpdG9yO1xuICBcbiAgdGhpcy5fbG9hZE1pc3NpbmdHaXVuemlvbmlJblZpZXcoKTtcbiAgdGhpcy5fc2V0dXBEcmF3U3RyYWRlQ29uc3RyYWludHMoKTtcbiAgdGhpcy5fc2V0dXBNb2RpZnlWZXJ0ZXhTdHJhZGVDb25zdHJhaW50cygpO1xuICB0aGlzLl9zZXR1cFN0cmFkZUN1dHRlclBvc3RTZWxlY3Rpb24oKTtcbiAgICAgICAgXG4gIHJldHVybiBJdGVybmV0RWRpdG9yLnByb3RvdHlwZS5zdGFydC5jYWxsKHRoaXMpO1xufTtcblxucHJvdG8uc2V0VG9vbCA9IGZ1bmN0aW9uKHRvb2xUeXBlKXtcbiAgdmFyIGdpdW56aW9uaVZlY3RvckxheWVyID0gdGhpcy5fZ2l1bnppb25pRWRpdG9yLmdldFZlY3RvckxheWVyKCk7XG4gIHZhciBzdGVwc0luZm8gPSBbXTtcbiAgdmFyIG9wdGlvbnM7XG4gIGlmICh0b29sVHlwZT09J2FkZGZlYXR1cmUnKXtcbiAgICBvcHRpb25zID0ge1xuICAgICAgc25hcDoge1xuICAgICAgICB2ZWN0b3JMYXllcjogZ2l1bnppb25pVmVjdG9yTGF5ZXJcbiAgICAgIH0sXG4gICAgICBmaW5pc2hDb25kaXRpb246IHRoaXMuX2dldENoZWNrU25hcHNDb25kaXRpb24oKSxcbiAgICAgIGNvbmRpdGlvbjogdGhpcy5fZ2V0U3RyYWRhSXNCZWluZ1NuYXBwZWRDb25kaXRpb24oKVxuICAgIH1cbiAgfVxuICBpZiAodG9vbFR5cGU9PSdtb2RpZnl2ZXJ0ZXgnKXtcbiAgICBvcHRpb25zID0ge1xuICAgICAgc25hcDoge1xuICAgICAgICB2ZWN0b3JMYXllcjogZ2l1bnppb25pVmVjdG9yTGF5ZXJcbiAgICAgIH0sXG4gICAgICBkZWxldGVDb25kaXRpb246IF8uY29uc3RhbnQoZmFsc2UpXG4gICAgfVxuICB9XG4gIGlmICh0b29sVHlwZT09J2N1dGxpbmUnKXtcbiAgICBvcHRpb25zID0ge1xuICAgICAgcG9pbnRMYXllcjogZ2l1bnppb25pVmVjdG9yTGF5ZXIuZ2V0TWFwTGF5ZXIoKVxuICAgIH1cbiAgfVxuICBcbiAgdmFyIHN0YXJ0ID0gIEl0ZXJuZXRFZGl0b3IucHJvdG90eXBlLnNldFRvb2wuY2FsbCh0aGlzLHRvb2xUeXBlLG9wdGlvbnMpO1xuICBcbiAgaWYgKHN0YXJ0KXtcbiAgICAvL3RoaXMudG9vbFByb2dyZXNzLnNldFN0ZXBzSW5mbyhzdGVwc0luZm8pO1xuICAgIHRoaXMuX3N0cmFkZVNuYXBzID0gbmV3IHRoaXMuX3N0cmFkZVNuYXBzQ29sbGVjdGlvbjtcbiAgICAkKCdib2R5Jykua2V5dXAodGhpcy5fZHJhd1JlbW92ZUxhc3RQb2ludCk7XG4gICAgJCgnYm9keScpLmtleXVwKHRoaXMuX21vZGlmeVJlbW92ZVBvaW50KTtcbiAgfTtcbiAgXG4gIHJldHVybiBzdGFydDtcbn07XG5cbnByb3RvLnN0b3BUb29sID0gZnVuY3Rpb24oKXtcbiAgdmFyIHN0b3AgPSBmYWxzZTtcbiAgc3RvcCA9IEl0ZXJuZXRFZGl0b3IucHJvdG90eXBlLnN0b3BUb29sLmNhbGwodGhpcyk7XG4gIFxuICBpZiAoc3RvcCl7XG4gICAgdGhpcy5fc3RyYWRlU25hcHMgPSBudWxsO1xuICAgICQoJ2JvZHknKS5vZmYoJ2tleXVwJyx0aGlzLl9kcmF3UmVtb3ZlTGFzdFBvaW50KTtcbiAgICAkKCdib2R5Jykub2ZmKCdrZXl1cCcsdGhpcy5fbW9kaWZ5UmVtb3ZlUG9pbnQpO1xuICB9XG4gIFxuICByZXR1cm4gc3RvcDsgXG59O1xuXG59LHtcIi4vaXRlcm5ldGVkaXRvclwiOjR9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbnZhciBpbmhlcml0ID0gZzN3c2RrLmNvcmUudXRpbHMuaW5oZXJpdDtcbnZhciBiYXNlID0gZzN3c2RrLmNvcmUudXRpbHMuYmFzZTtcbnZhciBQbHVnaW4gPSBnM3dzZGsuY29yZS5QbHVnaW47XG52YXIgR1VJID0gZzN3c2RrLmd1aS5HVUk7XG5cbnZhciBTZXJ2aWNlID0gcmVxdWlyZSgnLi9wbHVnaW5zZXJ2aWNlJyk7XG52YXIgRWRpdGluZ1BhbmVsID0gcmVxdWlyZSgnLi9wYW5lbCcpO1xuXG4vKiAtLS0tIFBBUlRFIERJIENPTkZJR1VSQVpJT05FIERFTEwnSU5URVJPICBQTFVHSU5TXG4vIFNBUkVCQkUgSU5URVJTU0FOVEUgQ09ORklHVVJBUkUgSU4gTUFOSUVSQSBQVUxJVEEgTEFZRVJTIChTVFlMRVMsIEVUQy4uKSBQQU5ORUxMTyBJTiBVTlxuLyBVTklDTyBQVU5UTyBDSElBUk8gQ09Tw4wgREEgTEVHQVJFIFRPT0xTIEFJIExBWUVSXG4qL1xuXG5cbnZhciBfUGx1Z2luID0gZnVuY3Rpb24oKXtcbiAgYmFzZSh0aGlzKTtcbiAgdGhpcy5uYW1lID0gJ2l0ZXJuZXQnO1xuICB0aGlzLmNvbmZpZyA9IG51bGw7XG4gIHRoaXMuc2VydmljZSA9IG51bGw7XG4gIFxuICB0aGlzLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgLy9zZXR0byBpbCBzZXJ2aXppb1xuICAgIHRoaXMuc2V0UGx1Z2luU2VydmljZShTZXJ2aWNlKTtcbiAgICAvL3JlY3VwZXJvIGNvbmZpZ3VyYXppb25lIGRlbCBwbHVnaW5cbiAgICB0aGlzLmNvbmZpZyA9IHRoaXMuZ2V0UGx1Z2luQ29uZmlnKCk7XG4gICAgLy9yZWdpdHJvIGlsIHBsdWdpblxuICAgIGlmICh0aGlzLnJlZ2lzdGVyUGx1Z2luKHRoaXMuY29uZmlnLmdpZCkpIHtcbiAgICAgIGlmICghR1VJLnJlYWR5KSB7XG4gICAgICAgIEdVSS5vbigncmVhZHknLF8uYmluZCh0aGlzLnNldHVwR3VpLCB0aGlzKSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXR1cEd1aSgpO1xuICAgICAgfVxuICAgICAgLy9pbml6aWFsaXp6byBpbCBzZXJ2aXppby4gSWwgc2Vydml6aW8gw6ggbCdpc3RhbnphIGRlbGxhIGNsYXNzZSBzZXJ2aXppb1xuICAgICAgdGhpcy5zZXJ2aWNlLmluaXQodGhpcy5jb25maWcpO1xuICAgIH1cbiAgfTtcbiAgLy9tZXR0byBzdSBsJ2ludGVyZmFjY2lhIGRlbCBwbHVnaW5cbiAgdGhpcy5zZXR1cEd1aSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB0b29sc0NvbXBvbmVudCA9IEdVSS5nZXRDb21wb25lbnQoJ3Rvb2xzJyk7XG4gICAgdmFyIHRvb2xzU2VydmljZSA9IHRvb2xzQ29tcG9uZW50LmdldFNlcnZpY2UoKTtcbiAgICAvL2FkZCBUb29scyAob3JkaW5lLCBOb21lIGdydXBwbywgdG9vbHMpXG4gICAgdG9vbHNTZXJ2aWNlLmFkZFRvb2xzKDAsICdJVEVSTkVUJywgW1xuICAgICAge1xuICAgICAgICBuYW1lOiBcIkVkaXRpbmcgZGF0aVwiLFxuICAgICAgICBhY3Rpb246IF8uYmluZChzZWxmLnNob3dFZGl0aW5nUGFuZWwsIHRoaXMpXG4gICAgICB9XG4gICAgXSlcbiAgfTtcbiAgXG4gIHRoaXMuc2hvd0VkaXRpbmdQYW5lbCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYW5lbCA9IG5ldyBFZGl0aW5nUGFuZWwoKTtcbiAgICBHVUkuc2hvd1BhbmVsKHBhbmVsKTtcbiAgfVxufTtcblxuaW5oZXJpdChfUGx1Z2luLCBQbHVnaW4pO1xuXG4oZnVuY3Rpb24ocGx1Z2luKXtcbiAgcGx1Z2luLmluaXQoKTtcbn0pKG5ldyBfUGx1Z2luKTtcblxuXG59LHtcIi4vcGFuZWxcIjo4LFwiLi9wbHVnaW5zZXJ2aWNlXCI6OX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xubW9kdWxlLmV4cG9ydHMgPSBcIjxkaXYgY2xhc3M9XFxcImczdy1pdGVybmV0LWVkaXRpbmctcGFuZWxcXFwiPlxcbiAgPHRlbXBsYXRlIHYtZm9yPVxcXCJ0b29sYmFyIGluIGVkaXRvcnN0b29sYmFyc1xcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcInBhbmVsIHBhbmVsLXByaW1hcnlcXFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInBhbmVsLWhlYWRpbmdcXFwiPlxcbiAgICAgICAgPGgzIGNsYXNzPVxcXCJwYW5lbC10aXRsZVxcXCI+e3sgdG9vbGJhci5uYW1lIH19PC9oMz5cXG4gICAgICA8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJwYW5lbC1ib2R5XFxcIj5cXG4gICAgICAgIDx0ZW1wbGF0ZSB2LWZvcj1cXFwidG9vbCBpbiB0b29sYmFyLnRvb2xzXFxcIj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZWRpdGJ0blxcXCIgOmNsYXNzPVxcXCJ7J2VuYWJsZWQnIDogKHN0YXRlLmVkaXRpbmcub24gJiYgZWRpdGluZ3Rvb2xidG5FbmFibGVkKHRvb2wpKSwgJ3RvZ2dsZWQnIDogZWRpdGluZ3Rvb2xidG5Ub2dnbGVkKHRvb2xiYXIubGF5ZXJjb2RlLHRvb2wudG9vbHR5cGUpfVxcXCI+XFxuICAgICAgICAgICAgPGltZyBoZWlnaHQ9XFxcIjMwcHhcXFwiIHdpZHRoPVxcXCIzMHB4XFxcIiBAY2xpY2s9XFxcInRvZ2dsZUVkaXRUb29sKHRvb2xiYXIubGF5ZXJjb2RlLHRvb2wudG9vbHR5cGUpXFxcIiA6YWx0Lm9uY2U9XFxcInRvb2wudGl0bGVcXFwiIDp0aXRsZS5vbmNlPVxcXCJ0b29sLnRpdGxlXFxcIiA6c3JjLm9uY2U9XFxcInJlc291cmNlc3VybCsnaW1hZ2VzLycrdG9vbC5pY29uXFxcIi8+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC90ZW1wbGF0ZT5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICA8L3RlbXBsYXRlPlxcbiAgPGRpdj5cXG4gICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1wcmltYXJ5XFxcIiB2LWRpc2FibGVkPVxcXCJlZGl0aW5nYnRuRW5hYmxlZFxcXCIgOmNsYXNzPVxcXCJ7J2J0bi1zdWNjZXNzJyA6IHN0YXRlLmVkaXRpbmdPbn1cXFwiIEBjbGljaz1cXFwidG9nZ2xlRWRpdGluZ1xcXCI+e3sgZWRpdGluZ2J0bmxhYmVsIH19PC9idXR0b24+XFxuICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGFuZ2VyXFxcIiB2LWRpc2FibGVkPVxcXCIhc3RhdGUuaGFzRWRpdHNcXFwiIEBjbGljaz1cXFwic2F2ZUVkaXRzXFxcIj57eyBzYXZlYnRubGFiZWwgfX08L2J1dHRvbj5cXG4gICAgPGltZyB2LXNob3c9XFxcInN0YXRlLnJldHJpZXZpbmdEYXRhXFxcIiA6c3JjPVxcXCJyZXNvdXJjZXN1cmwgKydpbWFnZXMvbG9hZGVyLnN2ZydcXFwiPlxcbiAgPC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJtZXNzYWdlXFxcIj5cXG4gICAge3t7IG1lc3NhZ2UgfX19XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG5cIjtcblxufSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG52YXIgcmVzb2x2ZWRWYWx1ZSA9IGczd3Nkay5jb3JlLnV0aWxzLnJlc29sdmU7XG52YXIgaW5oZXJpdCA9IGczd3Nkay5jb3JlLnV0aWxzLmluaGVyaXQ7XG52YXIgR1VJID0gZzN3c2RrLmd1aS5HVUk7XG52YXIgUGFuZWwgPSAgZzN3c2RrLmd1aS5QYW5lbDtcblxudmFyIFNlcnZpY2UgPSByZXF1aXJlKCcuL3BsdWdpbnNlcnZpY2UnKTtcblxudmFyIFBhbmVsQ29tcG9uZW50ID0gVnVlLmV4dGVuZCh7XG4gIHRlbXBsYXRlOiByZXF1aXJlKCcuL3BhbmVsLmh0bWwnKSxcbiAgZGF0YTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vbG8gc3RhdGUgw6ggcXVlbGxvIGRlbCBzZXJ2aXppbyBpbiBxdWFudG8gw6ggbHVpIGNoZSB2YSBhIG1vZGlmaWNhcmUgb3BlcmFyZSBzdWkgZGF0aVxuICAgICAgc3RhdGU6IFNlcnZpY2Uuc3RhdGUsXG4gICAgICByZXNvdXJjZXN1cmw6IEdVSS5nZXRSZXNvdXJjZXNVcmwoKSxcbiAgICAgIGVkaXRvcnN0b29sYmFyczogW1xuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogXCJBY2Nlc3NpXCIsXG4gICAgICAgICAgbGF5ZXJjb2RlOiBTZXJ2aWNlLmxheWVyQ29kZXMuQUNDRVNTSSxcbiAgICAgICAgICB0b29sczpbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkFnZ2l1bmdpIGFjY2Vzc29cIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdhZGRmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRBZGRQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJTcG9zdGEgYWNjZXNzb1wiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ21vdmVmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRNb3ZlUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiUmltdW92aSBhY2Nlc3NvXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnZGVsZXRlZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0RGVsZXRlUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiRWRpdGEgYXR0cmlidXRpXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnZWRpdGF0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICBpY29uOiAnZWRpdEF0dHJpYnV0ZXMucG5nJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6IFwiR2l1bnppb25pIHN0cmFkYWxpXCIsXG4gICAgICAgICAgbGF5ZXJjb2RlOiBTZXJ2aWNlLmxheWVyQ29kZXMuR0lVTlpJT05JLFxuICAgICAgICAgIHRvb2xzOltcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiQWdnaXVuZ2kgZ2l1bnppb25lXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnYWRkZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0QWRkUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiU3Bvc3RhIGdpdW56aW9uZVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ21vdmVmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRNb3ZlUG9pbnQucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiUmltdW92aSBnaXVuemlvbmVcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdkZWxldGVmZWF0dXJlJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXREZWxldGVQb2ludC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJFZGl0YSBhdHRyaWJ1dGlcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdlZGl0YXR0cmlidXRlcycsXG4gICAgICAgICAgICAgIGljb246ICdlZGl0QXR0cmlidXRlcy5wbmcnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogXCJFbGVtZW50aSBzdHJhZGFsaVwiLFxuICAgICAgICAgIGxheWVyY29kZTogU2VydmljZS5sYXllckNvZGVzLlNUUkFERSxcbiAgICAgICAgICB0b29sczpbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkFnZ2l1bmdpIHN0cmFkYVwiLFxuICAgICAgICAgICAgICB0b29sdHlwZTogJ2FkZGZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldEFkZExpbmUucG5nJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdGl0bGU6IFwiU3Bvc3RhIHZlcnRpY2Ugc3RyYWRhXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnbW9kaWZ5dmVydGV4JyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRNb3ZlVmVydGV4LnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIlRhZ2xpYSBzdSBnaXVuemlvbmVcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdjdXRsaW5lJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2l0ZXJuZXRDdXRPblZlcnRleC5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJTcG9zdGEgc3RyYWRhXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnbW92ZWZlYXR1cmUnLFxuICAgICAgICAgICAgICBpY29uOiAnaXRlcm5ldE1vdmVMaW5lLnBuZydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIlJpbXVvdmkgc3RyYWRhXCIsXG4gICAgICAgICAgICAgIHRvb2x0eXBlOiAnZGVsZXRlZmVhdHVyZScsXG4gICAgICAgICAgICAgIGljb246ICdpdGVybmV0RGVsZXRlTGluZS5wbmcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogXCJFZGl0YSBhdHRyaWJ1dGlcIixcbiAgICAgICAgICAgICAgdG9vbHR5cGU6ICdlZGl0YXR0cmlidXRlcycsXG4gICAgICAgICAgICAgIGljb246ICdlZGl0QXR0cmlidXRlcy5wbmcnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgc2F2ZWJ0bmxhYmVsOiBcIlNhbHZhXCJcbiAgICB9XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICB0b2dnbGVFZGl0aW5nOiBmdW5jdGlvbigpIHtcbiAgICAgIC8vc2kgaGEgcXVhbmRvIHZpZW5lIGF2dmlhdGEgbyB0ZXJtaW5hdGEgdW5hIHNlc3Npb25lIGRpIGVkaXRpbmdcbiAgICAgIFNlcnZpY2UudG9nZ2xlRWRpdGluZygpO1xuICAgIH0sXG4gICAgc2F2ZUVkaXRzOiBmdW5jdGlvbigpIHtcbiAgICAgIC8vY2hhaWFtYXRhIHF1YW5kbyBzaSBwcmVtZSBzdSBzYWx2YSBlZGl0c1xuICAgICAgU2VydmljZS5zYXZlRWRpdHMoKTtcbiAgICB9LFxuICAgIHRvZ2dsZUVkaXRUb29sOiBmdW5jdGlvbihsYXllckNvZGUsIHRvb2xUeXBlKSB7XG4gICAgICAvL2NoaWFtYXRvIHF1YW5kbyBzaSBjbGljY2Egc3UgdW4gdG9vbCBkZWxsJ2VkaXRvclxuICAgICAgaWYgKHRvb2xUeXBlID09ICcnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnN0YXRlLmVkaXRpbmcub24pIHtcbiAgICAgICAgU2VydmljZS50b2dnbGVFZGl0VG9vbChsYXllckNvZGUsIHRvb2xUeXBlKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGVkaXRpbmd0b29sYnRuVG9nZ2xlZDogZnVuY3Rpb24obGF5ZXJDb2RlLCB0b29sVHlwZSkge1xuICAgICAgcmV0dXJuICh0aGlzLnN0YXRlLmVkaXRpbmcubGF5ZXJDb2RlID09IGxheWVyQ29kZSAmJiB0aGlzLnN0YXRlLmVkaXRpbmcudG9vbFR5cGUgPT0gdG9vbFR5cGUpO1xuICAgIH0sXG4gICAgZWRpdGluZ3Rvb2xidG5FbmFibGVkOiBmdW5jdGlvbih0b29sKSB7XG4gICAgICByZXR1cm4gdG9vbC50b29sdHlwZSAhPSAnJztcbiAgICB9XG4gIH0sXG4gIGNvbXB1dGVkOiB7XG4gICAgZWRpdGluZ2J0bmxhYmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlLmVkaXRpbmcub24gPyBcIlRlcm1pbmEgZWRpdGluZ1wiIDogXCJBdnZpYSBlZGl0aW5nXCI7XG4gICAgfSxcbiAgICBlZGl0aW5nYnRuRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gKHRoaXMuc3RhdGUuZWRpdGluZy5lbmFibGVkIHx8IHRoaXMuc3RhdGUuZWRpdGluZy5vbikgPyBcIlwiIDogXCJkaXNhYmxlZFwiO1xuICAgIH0sXG4gICAgbWVzc2FnZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XG4gICAgICBpZiAoIXRoaXMuc3RhdGUuZWRpdGluZy5lbmFibGVkKSB7XG4gICAgICAgIG1lc3NhZ2UgPSAnPHNwYW4gc3R5bGU9XCJjb2xvcjogcmVkXCI+QXVtZW50YXJlIGlsIGxpdmVsbG8gZGkgem9vbSBwZXIgYWJpbGl0YXJlIGxcXCdlZGl0aW5nJztcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5tZXNzYWdlKSB7XG4gICAgICAgIHZhciBuID0gdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm47XG4gICAgICAgIHZhciB0b3RhbCA9IHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC50b3RhbDtcbiAgICAgICAgdmFyIHN0ZXBtZXNzYWdlID0gdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xzdGVwLm1lc3NhZ2U7XG4gICAgICAgIG1lc3NhZ2UgPSAnPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6MjBweFwiPkdVSURBIFNUUlVNRU5UTzo8L2Rpdj4nICtcbiAgICAgICAgICAnPGRpdj48c3Bhbj5bJytuKycvJyt0b3RhbCsnXSA8L3NwYW4+PHNwYW4gc3R5bGU9XCJjb2xvcjogeWVsbG93XCI+JytzdGVwbWVzc2FnZSsnPC9zcGFuPjwvZGl2Pic7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBFZGl0b3JQYW5lbCgpIHtcbiAgLy8gcHJvcHJpZXTDoCBuZWNlc3NhcmllLiBJbiBmdXR1cm8gbGUgbWV0dGVybW8gaW4gdW5hIGNsYXNzZSBQYW5lbCBkYSBjdWkgZGVyaXZlcmFubm8gdHV0dGkgaSBwYW5uZWxsaSBjaGUgdm9nbGlvbm8gZXNzZXJlIG1vc3RyYXRpIG5lbGxhIHNpZGViYXJcbiAgdGhpcy5pZCA9IFwiaXRlcm5ldC1lZGl0aW5nLXBhbmVsXCI7XG4gIHRoaXMubmFtZSA9IFwiR2VzdGlvbmUgZGF0aSBJVEVSTkVUXCI7XG4gIHRoaXMuaW50ZXJuYWxQYW5lbCA9IG5ldyBQYW5lbENvbXBvbmVudCgpO1xufVxuXG5pbmhlcml0KEVkaXRvclBhbmVsLCBQYW5lbCk7XG5cbnZhciBwcm90byA9IFBhbmVsLnByb3RvdHlwZTtcblxuLy8gdmllbmUgcmljaGlhbWF0byBkYWxsYSB0b29sYmFyIHF1YW5kbyBpbCBwbHVnaW4gY2hpZWRlIGRpIG1vc3RyYXJlXG4vLyB1biBwcm9wcmlvIHBhbm5lbGxvIG5lbGxhIEdVSSAoR1VJLnNob3dQYW5lbClcbnByb3RvLm9uU2hvdyA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xuICBjb25zb2xlLmxvZygnY2lhbycpO1xuICB2YXIgcGFuZWwgPSB0aGlzLmludGVybmFsUGFuZWw7XG4gIHBhbmVsLiRtb3VudCgpLiRhcHBlbmRUbyhjb250YWluZXIpO1xuICByZXR1cm4gcmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbn07XG5cbi8vIHJpY2hpYW1hdG8gcXVhbmRvIGxhIEdVSSBjaGllZGUgZGkgY2hpdWRlcmUgaWwgcGFubmVsbG8uIFNlIHJpdG9ybmEgZmFsc2UgaWwgcGFubmVsbG8gbm9uIHZpZW5lIGNoaXVzb1xucHJvdG8ub25DbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgU2VydmljZS5zdG9wKClcbiAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgc2VsZi5pbnRlcm5hbFBhbmVsLiRkZXN0cm95KHRydWUpO1xuICAgIHNlbGYuaW50ZXJuYWxQYW5lbCA9IG51bGw7XG4gICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICB9KVxuICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgfSk7XG4gIFxuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBFZGl0b3JQYW5lbDtcblxufSx7XCIuL3BhbmVsLmh0bWxcIjo3LFwiLi9wbHVnaW5zZXJ2aWNlXCI6OX1dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xudmFyIGluaGVyaXQgPSBnM3dzZGsuY29yZS51dGlscy5pbmhlcml0O1xudmFyIHJlc29sdmVkVmFsdWUgPSBnM3dzZGsuY29yZS51dGlscy5yZXNvbHZlO1xudmFyIHJlamVjdGVkVmFsdWUgPSBnM3dzZGsuY29yZS51dGlscy5yZWplY3Q7XG52YXIgRzNXT2JqZWN0ID0gZzN3c2RrLmNvcmUuRzNXT2JqZWN0O1xudmFyIEdVSSA9IGczd3Nkay5ndWkuR1VJO1xudmFyIFZlY3RvckxheWVyID0gZzN3c2RrLmNvcmUuVmVjdG9yTGF5ZXI7XG52YXIgVmVjdG9yTG9hZGVyTGF5ZXIgPSBnM3dzZGsuY29yZS5WZWN0b3JMYXllckxvYWRlcjtcblxudmFyIEZvcm1DbGFzcyA9IHJlcXVpcmUoJy4vZWRpdG9ycy9hdHRyaWJ1dGVzZm9ybScpO1xuXG4vL1F1aSBjaSBzb25vIGdsaSBlZGl0b3IgKGNsYXNzaSkgdXNhdGkgZGFpIHZhcmkgbGF5ZXJcbnZhciBBY2Nlc3NpRWRpdG9yID0gcmVxdWlyZSgnLi9lZGl0b3JzL2FjY2Vzc2llZGl0b3InKTtcbnZhciBHaXVuemlvbmlFZGl0b3IgPSByZXF1aXJlKCcuL2VkaXRvcnMvZ2l1bnppb25pZWRpdG9yJyk7XG52YXIgU3RyYWRlRWRpdG9yID0gcmVxdWlyZSgnLi9lZGl0b3JzL3N0cmFkZWVkaXRvcicpO1xuXG4vL29nZ2V0dG8gY2hlIGRlZmluaXNjZSBnbGkgc3RlcHMgbWVzc2FnZXMgY2hlIHVuIHRvb2wgZGV2ZSBmYXJlXG52YXIgdG9vbFN0ZXBzTWVzc2FnZXMgPSB7XG4gICdjdXRsaW5lJzogW1xuICAgIFwiU2VsZXppb25hIGxhIHN0cmFkYSBkYSB0YWdsaWFyZVwiLFxuICAgIFwiU2VsZXppb25hIGxhIGdpdW56aW9uZSBkaSB0YWdsaW9cIixcbiAgICBcIlNlbGV6aW9uYSBsYSBwb3JpemlvbmUgZGkgc3RyYWRhIG9yaWdpbmFsZSBkYSBtYW50ZW5lcmVcIlxuICBdXG59O1xuXG5mdW5jdGlvbiBJdGVybmV0U2VydmljZSgpe1xuXG4gIHZhciBzZWxmID0gdGhpcztcbiAgLy9xdWkgdmFkbyAgYSBzZXR0YXJlIGlsIG1hcHNlcnZpY2VcbiAgdGhpcy5fbWFwU2VydmljZSA9IG51bGw7XG4gIHRoaXMuX3J1bm5pbmdFZGl0b3IgPSBudWxsO1xuXG4gIC8vZGVmaW5pc2NvIGkgY29kaWNpIGxheWVyXG4gIHZhciBsYXllckNvZGVzID0gdGhpcy5sYXllckNvZGVzID0ge1xuICAgIFNUUkFERTogJ3N0cmFkZScsXG4gICAgR0lVTlpJT05JOiAnZ2l1bnppb25pJyxcbiAgICBBQ0NFU1NJOiAnYWNjZXNzaSdcbiAgfTtcbiAgLy8gY2xhc3NpIGVkaXRvclxuICB0aGlzLl9lZGl0b3JDbGFzcyA9IHt9O1xuICB0aGlzLl9lZGl0b3JDbGFzc1tsYXllckNvZGVzLkFDQ0VTU0ldID0gQWNjZXNzaUVkaXRvcjtcbiAgdGhpcy5fZWRpdG9yQ2xhc3NbbGF5ZXJDb2Rlcy5HSVVOWklPTkldID0gR2l1bnppb25pRWRpdG9yO1xuICB0aGlzLl9lZGl0b3JDbGFzc1tsYXllckNvZGVzLlNUUkFERV0gPSBTdHJhZGVFZGl0b3I7XG4gIC8vZGZpbmlzY28gbGF5ZXIgZGVsIHBsdWdpbiBjb21lIG9nZ2V0dG9cbiAgdGhpcy5fbGF5ZXJzID0ge307XG4gIHRoaXMuX2xheWVyc1tsYXllckNvZGVzLkFDQ0VTU0ldID0ge1xuICAgIGxheWVyQ29kZTogbGF5ZXJDb2Rlcy5BQ0NFU1NJLFxuICAgIHZlY3RvcjogbnVsbCxcbiAgICBlZGl0b3I6IG51bGwsXG4gICAgLy9kZWZpbmlzY28gbG8gc3RpbGVcbiAgICBzdHlsZTogZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgICB2YXIgY29sb3IgPSAnI2Q5YjU4MSc7XG4gICAgICBzd2l0Y2ggKGZlYXR1cmUuZ2V0KCd0aXBfYWNjJykpe1xuICAgICAgICBjYXNlIFwiMDEwMVwiOlxuICAgICAgICAgIGNvbG9yID0gJyNkOWI1ODEnO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiMDEwMlwiOlxuICAgICAgICAgIGNvbG9yID0gJyNkOWJjMjknO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiMDUwMVwiOlxuICAgICAgICAgIGNvbG9yID0gJyM2OGFhZDknO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvbG9yID0gJyNkOWI1ODEnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtcbiAgICAgICAgbmV3IG9sLnN0eWxlLlN0eWxlKHtcbiAgICAgICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XG4gICAgICAgICAgICByYWRpdXM6IDUsXG4gICAgICAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XG4gICAgICAgICAgICAgIGNvbG9yOiBjb2xvclxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgXVxuICAgIH1cbiAgfTtcbiAgdGhpcy5fbGF5ZXJzW2xheWVyQ29kZXMuR0lVTlpJT05JXSA9IHtcbiAgICBsYXllckNvZGU6IGxheWVyQ29kZXMuR0lVTlpJT05JLFxuICAgIHZlY3RvcjogbnVsbCxcbiAgICBlZGl0b3I6IG51bGwsXG4gICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XG4gICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XG4gICAgICAgIHJhZGl1czogNSxcbiAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xuICAgICAgICAgIGNvbG9yOiAnIzAwMDBmZidcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfTtcbiAgdGhpcy5fbGF5ZXJzW2xheWVyQ29kZXMuU1RSQURFXSA9IHtcbiAgICBsYXllckNvZGU6IGxheWVyQ29kZXMuU1RSQURFLFxuICAgIHZlY3RvcjogbnVsbCxcbiAgICBlZGl0b3I6IG51bGwsXG4gICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XG4gICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xuICAgICAgICB3aWR0aDogMyxcbiAgICAgICAgY29sb3I6ICcjZmY3ZDJkJ1xuICAgICAgfSlcbiAgICB9KVxuICB9O1xuXG4gIHRoaXMuX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuXG4gIHRoaXMuX2N1cnJlbnRFZGl0aW5nTGF5ZXIgPSBudWxsO1xuXG4gIHRoaXMuX2xvYWRlZEV4dGVudCA9IG51bGw7XG5cbiAgdGhpcy5zdGF0ZSA9IHtcbiAgICBlZGl0aW5nOiB7XG4gICAgICBvbjogZmFsc2UsXG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIGxheWVyQ29kZTogbnVsbCxcbiAgICAgIHRvb2xUeXBlOiBudWxsLFxuICAgICAgc3RhcnRpbmdFZGl0aW5nVG9vbDogZmFsc2UsXG4gICAgICB0b29sc3RlcDoge1xuICAgICAgICBuOiBudWxsLFxuICAgICAgICB0b3RhbDogbnVsbCxcbiAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgfVxuICAgIH0sXG4gICAgcmV0cmlldmluZ0RhdGE6IGZhbHNlLFxuICAgIGhhc0VkaXRzOiBmYWxzZVxuICB9O1xuXG4gIC8vZGVmaW5pc2NvIGlsIGxvYWRlciBkZWwgcGx1Z2luXG4gIHRoaXMuX2xvYWRlciA9IG5ldyBWZWN0b3JMb2FkZXJMYXllcjtcbiAgLy8gaW5pemlhbGl6emF6aW9uZSBkZWwgcGx1Z2luXG4gIC8vIGNoaWFtdG8gZGFsbCAkc2NyaXB0KHVybCkgZGVsIHBsdWdpbiByZWdpc3RyeVxuICAvLyBpbml6aWFsaXp6YXppb25lIGRlbCBwbHVnaW5cbiAgLy8gY2hpYW10byBkYWxsICRzY3JpcHQodXJsKSBkZWwgcGx1Z2luIHJlZ2lzdHJ5XG4gIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKGNvbmZpZykge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIC8vIHNldHRvIGlsIG1hcHNlcnZpY2UgY2hlIG1pIHBlcm1ldHRlIGRpIGluZXJhZ2lyZSBjb24gbGEgbWFwcGFcbiAgICB0aGlzLl9tYXBTZXJ2aWNlID0gR1VJLmdldENvbXBvbmVudCgnbWFwJykuZ2V0U2VydmljZSgpO1xuICAgIC8vaW5pemlhbGl6em8gaWwgbG9hZGVyXG4gICAgdmFyIG9wdGlvbnNfbG9hZGVyID0ge1xuICAgICAgJ2xheWVycyc6IHRoaXMuX2xheWVycyxcbiAgICAgICdiYXNldXJsJzogdGhpcy5jb25maWcuYmFzZXVybCxcbiAgICAgICdtYXBTZXJ2aWNlJzogdGhpcy5fbWFwU2VydmljZVxuICAgIH07XG4gICAgLy9pbml6aWFsaXp6byBpbCBsb2FkZXJcbiAgICB0aGlzLl9sb2FkZXIuaW5pdChvcHRpb25zX2xvYWRlcik7XG4gICAgLy9jYXNvIGRpIHJldHJpZXcgZGF0YVxuICAgIHRoaXMuX2xvYWRlci5vbigncmV0cmlld3ZlY3RvcmxheWVycycsIGZ1bmN0aW9uKGJvb2wsIHZlY3RvckxheWVycykge1xuICAgICAgXy5mb3JFYWNoKHZlY3RvckxheWVycywgZnVuY3Rpb24gKHZlY3RvckxheWVyLCBsYXllckNvZGUpIHtcbiAgICAgICAgaWYgKGJvb2wpIHtcbiAgICAgICAgICBzZWxmLl9zZXRVcFZlY3RvckxheWVyKGxheWVyQ29kZSwgdmVjdG9yTGF5ZXIpO1xuICAgICAgICAgIHNlbGYuX3NldFVwRWRpdG9yKGxheWVyQ29kZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2V0dG8gYSB0cnVlIGluIHF1ZXN0byBtb2RvIGNhcGlzY28gY2hlIGkgbGF5ZXJ2ZXR0b3JpYWxpIHNvbm8gc3RhdGkgcmVjdXBlcmF0aVxuICAgICAgICAvLyBkYWwgc2VydmVyIGUgY2hlIHF1aW5kaSBpbml6byBhIGZhcmUgaWwgbG9hZGluZyBkZWkgZGF0aSB2ZXJpIGUgcHJvcHJpXG4gICAgICAgIHNlbGYuc3RhdGUucmV0cmlldmluZ0RhdGEgPSBib29sO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5fbG9hZGVyLm9uKCdyZXRyaWV3dmVjdG9sYXllcnNkYXRhJywgZnVuY3Rpb24oYm9vbCkge1xuICAgICAgLy8gcXVlc3RhIG1pIHNlcnZlciBwZXIgc3BlbmdlcmUgYWxsYSBmaW5lICBpbCBsb2FkaW5nIGdpZlxuICAgICAgc2VsZi5zdGF0ZS5yZXRyaWV2aW5nRGF0YSA9IGJvb2w7XG4gICAgfSk7XG4gICAgLy9ldmVudG8gcXVhbmRvIHJpY2V2byBkYWwgbG9hZGVyIGwnYXJyYXkgZGkgZmVhdHVyZXMgbG9ja2VkXG4gICAgdGhpcy5fbG9hZGVyLm9uKCdmZWF0dXJlbG9ja3MnLCBmdW5jdGlvbihsYXllckNvZGUsIGZlYXR1cmVsb2Nrcykge1xuICAgICAgLy9hc3NlZ25vIGFsbCdlZGl0b3IgbCdhcnJheSBkZWxsZSBmZWF0dXJlIGxvY2tlZFxuICAgICAgc2VsZi5fbGF5ZXJzW2xheWVyQ29kZV0uZWRpdG9yLnNldEZlYXR1cmVMb2NrcyhmZWF0dXJlbG9ja3MpO1xuICAgIH0pO1xuXG4gICAgLy8gZGlzYWJpbGl0byBsJ2V2ZW50dWFsZSB0b29sIGF0dGl2byBzZSB2aWVuZSBhdHRpdmF0YVxuICAgIC8vIHVuJ2ludGVyYXppb25lIGRpIHRpcG8gcG9pbnRlckludGVyYWN0aW9uU2V0IHN1bGxhIG1hcHBhXG4gICAgdGhpcy5fbWFwU2VydmljZS5vbigncG9pbnRlckludGVyYWN0aW9uU2V0JywgZnVuY3Rpb24oaW50ZXJhY3Rpb24pIHtcbiAgICAgIHZhciBjdXJyZW50RWRpdGluZ0xheWVyID0gc2VsZi5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIpIHtcbiAgICAgICAgdmFyIGFjdGl2ZVRvb2wgPSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuaW5zdGFuY2U7XG4gICAgICAgIC8vIGRldm8gdmVyaWZpY2FyZSBjaGUgbm9uIHNpYSB1bidpbnRlcmF6aW9uZSBhdHRpdmF0YSBkYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyBkZWwgcGx1Z2luXG4gICAgICAgIGlmIChhY3RpdmVUb29sICYmICFhY3RpdmVUb29sLm93bnNJbnRlcmFjdGlvbihpbnRlcmFjdGlvbikpIHtcbiAgICAgICAgICBzZWxmLl9zdG9wRWRpdGluZ1Rvb2woKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIC8vICBzZXR0byBlZGl0aW5nIGRlbGxvZ2V0dG8gc3RhdGUgb24gYSB0cnVlXG4gICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgPSAgdHJ1ZTtcbiAgICAvLyBwZXIgb2duaSBsYXllciBkZWZpbml0aSBuZWwgcGx1Z2luIHNldHRvIG5hbWUgZSBpZFxuICAgIC8vIHJlY3VwZXJhdGkgZ3JhemllIGFsIG1hcHNlcnZpY2VcbiAgICBfLmZvckVhY2godGhpcy5fbGF5ZXJzLCBmdW5jdGlvbihMYXllciwgbGF5ZXJDb2RlKSB7XG4gICAgICAvL3JlY3VwZXJvIGwnaWQgZGFsbGEgY29uZmlndXJhemlvbmUgZGVsIHBsdWdpblxuICAgICAgdmFyIGxheWVySWQgPSBjb25maWcubGF5ZXJzW2xheWVyQ29kZV0uaWQ7XG4gICAgICAvLyByZWN1cGVyYSBpbCBsYXllciBkYWwgbWFwc2VydmljZVxuICAgICAgdmFyIGxheWVyID0gc2VsZi5fbWFwU2VydmljZS5nZXRQcm9qZWN0KCkuZ2V0TGF5ZXJCeUlkKGxheWVySWQpO1xuICAgICAgTGF5ZXIubmFtZSA9IGxheWVyLmdldE9yaWdOYW1lKCk7XG4gICAgICBMYXllci5pZCA9IGxheWVySWQ7XG4gICAgfSk7XG5cbiAgfTtcbiAgLy8gZmluZSBkZWwgbWV0b2RvIElOSVRcblxuICAvL3N0b3BcbiAgdGhpcy5zdG9wID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgaWYgKHRoaXMuc3RhdGUuZWRpdGluZy5vbikge1xuICAgICAgdGhpcy5fY2FuY2VsT3JTYXZlKClcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2VsZi5fc3RvcEVkaXRpbmcoKTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICB9KVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcblxuICAvLyBhdnZpbyBvIHRlcm1pbm8gbGEgc2Vzc2lvbmUgZGkgZWRpdGluZyBnZW5lcmFsZVxuICB0aGlzLnRvZ2dsZUVkaXRpbmcgPSBmdW5jdGlvbigpe1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLmVuYWJsZWQgJiYgIXRoaXMuc3RhdGUuZWRpdGluZy5vbil7XG4gICAgICB0aGlzLl9zdGFydEVkaXRpbmcoKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGhpcy5zdGF0ZS5lZGl0aW5nLm9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdG9wKCk7XG4gICAgfVxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG5cbiAgdGhpcy5zYXZlRWRpdHMgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuX2NhbmNlbE9yU2F2ZSgyKTtcbiAgfTtcblxuICAvLyBhdnZpYSB1bm8gZGVpIHRvb2wgZGkgZWRpdGluZyB0cmEgcXVlbGxpIHN1cHBvcnRhdGkgZGEgRWRpdG9yIChhZGRmZWF0dXJlLCBlY2MuKVxuICAvLyBmdW56aW9uZSBkZWxsJ2VsZW1lbnRvIHBhbmVsIHZ1ZVxuICB0aGlzLnRvZ2dsZUVkaXRUb29sID0gZnVuY3Rpb24obGF5ZXJDb2RlLCB0b29sVHlwZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAvL3ByZW5kbyBpbCBsYXllciBpbiBiYXNlIGFsIGNvZGljZSBwYXNzYXRvIGRhbGwgY29tcG9uZW50ZSB2dWVcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXTtcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIC8vcmVjdXByZXJvIGlsIGN1cnJlbnQgbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgdmFyIGN1cnJlbnRFZGl0aW5nTGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgICAvLyBzZSBzaSBzdGEgdXNhbmRvIHVuIHRvb2wgY2hlIHByZXZlZGUgbG8gc3Rlc3NvIGxheWVyIGluIGVkaXRhemlvbmVcbiAgICAgIGlmIChjdXJyZW50RWRpdGluZ0xheWVyICYmIGxheWVyQ29kZSA9PSBjdXJyZW50RWRpdGluZ0xheWVyLmxheWVyQ29kZSkge1xuICAgICAgICAvLyBlIGxvIHN0ZXNzbyB0b29sIGFsbG9yYSBkaXNhdHRpdm8gaWwgdG9vbCAoaW4gcXVhbnRvIMOoXG4gICAgICAgIC8vIHByZW11dG8gc3VsbG8gc3Rlc3NvIGJvdHRvbmUpXG4gICAgICAgIGlmICh0b29sVHlwZSA9PSBjdXJyZW50RWRpdGluZ0xheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuZ2V0VHlwZSgpKSB7XG4gICAgICAgICAgLy8gc3Rlc3NvIHRpcG8gZGkgdG9vbCBxdWluZGkgc2kgw6ggdmVyaWZpY2F0byB1biB0b2dnbGUgbmVsIGJvdHRvbmVcbiAgICAgICAgICAvLyBhbGxvcmEgc3RpcHBvIGwnZWRpdGluZyBUb29sXG4gICAgICAgICAgdGhpcy5fc3RvcEVkaXRpbmdUb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWx0cmltZW50aSBhdHRpdm8gaWwgdG9vbCByaWNoaWVzdG9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy9zdG9wcG8gcHJldmVudGl2YW1lbnRlIGwnZWRpdGluZyB0b29sIGF0dGl2b1xuICAgICAgICAgIHRoaXMuX3N0b3BFZGl0aW5nVG9vbCgpO1xuICAgICAgICAgIC8vZmFjY2lvIHBhcnRpcmUgbCdlZGl0bmcgdG9vbCBwYXNzYW5kbyBjdXJyZW50IEVkaXRpbmcgTGF5ZXIgZSBpbCB0aXBvIGRpIHRvb2xcbiAgICAgICAgICB0aGlzLl9zdGFydEVkaXRpbmdUb29sKGN1cnJlbnRFZGl0aW5nTGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gYWx0cmltZW50aSBjYXNvIGluIGN1aSBub24gw6ggc3RhdG8gc2V0dGF0byBpbCBjdXJyZW50IGVkaXRpbmcgbGF5ZXIgb1xuICAgICAgICAvLyBpbCBsYXllciBjaGUgc2kgc3RhIGNlcmNhbmRvIGRpIGVkaXRhcmUgw6ggZGl2ZXJzbyBkYSBxdWVsbG8gaW4gZWRpdGluZyBpbiBwcmVjZWRlbnphXG4gICAgICAgIC8vIG5lbCBjYXNvIHNpYSBnacOgICBhdHRpdm8gdW4gZWRpdG9yIHZlcmlmaWNvIGRpIHBvdGVybG8gc3RvcHBhcmVcbiAgICAgICAgaWYgKGN1cnJlbnRFZGl0aW5nTGF5ZXIgJiYgY3VycmVudEVkaXRpbmdMYXllci5lZGl0b3IuaXNTdGFydGVkKCkpIHtcbiAgICAgICAgICAvLyBzZSBsYSB0ZXJtaW5hemlvbmUgZGVsbCdlZGl0aW5nIHNhcsOgICBhbmRhdGEgYSBidW9uIGZpbmUsIHNldHRvIGlsIHRvb2xcbiAgICAgICAgICAvLyBwcm92byBhIHN0b3BwYXJlXG4gICAgICAgICAgdGhpcy5fY2FuY2VsT3JTYXZlKDIpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX3N0b3BFZGl0b3IoKSkge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Nvbm8gcXVpIGRvcG8gaW52aW8gZGVpIGRhdGknKTtcbiAgICAgICAgICAgICAgICAgIHNlbGYuX3N0YXJ0RWRpdGluZ1Rvb2wobGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvL25lbCBjYXNvIHNpYSBsYSBwcmltYSB2b2x0YSBjaGUgaW50ZXJhZ2lzY28gY29uIHVuIHRvb2xcbiAgICAgICAgICAvLyBlIHF1aW5kaSBub24gw6ggc3RhdG8gc2V0dGF0byBuZXNzdW4gbGF5ZXIgaW4gZWRpdGluZ1xuICAgICAgICAgIHRoaXMuX3N0YXJ0RWRpdGluZ1Rvb2wobGF5ZXIsIHRvb2xUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvL2Z1bnppb25lIGNoZSByZXN0aXR1aXNjZSBsJ2FycmF5IGRlaSBjb2RpY2kgZGVpIGxheWVyc1xuICB0aGlzLmdldExheWVyQ29kZXMgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiBfLnZhbHVlcyh0aGlzLmxheWVyQ29kZXMpO1xuICB9O1xuXG4gIC8qIE1FVE9ESSBQUklWQVRJICovXG4gIC8vIGZ1bnppb25lIHBlciBzZXR0YXJlIGlsIHZlY3RvcmxheWVyIGFsbGEgcHJvcmlldMOgIHZlY3RvciBkZWwgbGF5ZXJcbiAgdGhpcy5fc2V0VXBWZWN0b3JMYXllciA9IGZ1bmN0aW9uKGxheWVyQ29kZSwgdmVjdG9yTGF5ZXIpIHtcbiAgICB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXS52ZWN0b3IgPSB2ZWN0b3JMYXllcjtcbiAgfTtcbiAgLy9mdW56aW9uZSBjaGUgcGVybWV0dGUgZGkgZmFyZSBpbCBzZXR1cCBkZWxsJ2VkaXRvciBlIGFzc2VnYW5ybG8gYWwgbGF5ZXJcbiAgdGhpcy5fc2V0VXBFZGl0b3IgPSBmdW5jdGlvbihsYXllckNvZGUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgLy9vcHRpb24gZWRpdG9yXG4gICAgdmFyIG9wdGlvbnNfZWRpdG9yID0ge1xuICAgICAgJ21hcFNlcnZpY2UnOiBzZWxmLl9tYXBTZXJ2aWNlLFxuICAgICAgJ2Zvcm1DbGFzcyc6IEZvcm1DbGFzc1xuICAgIH07XG5cbiAgICAvLyBwcmVuZG8gaWwgdmVjdG9yIGxheWVyIGRlbCBsYXllclxuICAgIHZhciB2ZWN0b3JMYXllciA9IHRoaXMuX2xheWVyc1tsYXllckNvZGVdLnZlY3RvcjtcbiAgICAvL0dFU1RJT05FIEUgSU5JWklBTElaWkFaSU9ORSBERUxMJ0VESVRPUiBSRUxBVElWTyBBTCBMQVlFUiBWRVRUT1JJQUxFXG4gICAgLy9jcmVvIGwnaXN0YW56YSBkZWxsJ2VkaXRvciBjaGUgZ2VzdGlyw6AgaWwgbGF5ZXJcbiAgICB2YXIgZWRpdG9yID0gbmV3IHNlbGYuX2VkaXRvckNsYXNzW2xheWVyQ29kZV0ob3B0aW9uc19lZGl0b3IpO1xuICAgIC8vc2V0dG8gaWwgbGF5ZXIgdmV0dG9yaWFsZSBhc3NvY2lhdG8gYWxsJ2VkaXRvclxuICAgIC8vIGUgaSB0aXBpIGRpIHRvb2xzIGFzc29jaWF0aSBhZCBlc3NvXG4gICAgZWRpdG9yLnNldFZlY3RvckxheWVyKHZlY3RvckxheWVyKTtcbiAgICAvL2VtZXR0ZSBldmVudG8gY2hlIMOoIHN0YXRhIGdlbmVyYXRhIHVuYSBtb2RpZmljYSBsYSBsYXllclxuICAgIGVkaXRvci5vbihcImRpcnR5XCIsIGZ1bmN0aW9uIChkaXJ0eSkge1xuICAgICAgc2VsZi5zdGF0ZS5oYXNFZGl0cyA9IGRpcnR5O1xuICAgIH0pO1xuICAgIC8vYXNzZWdubyBsJ2lzdGFuemEgZWRpdG9yIGFsIGxheWVyIHRyYW1pdGUgbGEgcHJvcHJpZXTDoCBlZGl0b3JcbiAgICB0aGlzLl9sYXllcnNbbGF5ZXJDb2RlXS5lZGl0b3IgPSBlZGl0b3I7XG4gICAgLy8vLyBGSU5FIEdFU1RJT05FIEVESVRPUlxuICB9O1xuICAvL2ZhIHBhcnRpcmUgbCdlZGl0aW5nXG4gIHRoaXMuX3N0YXJ0RWRpdGluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLl9sb2FkZXIubG9hZExheWVycygpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAvLyBzZSB0dXR0byAgw6ggYW5kYXRvIGEgYnVvbiBmaW5lIGFnZ2l1bmdvIGkgVmVjdG9yTGF5ZXIgYWxsYSBtYXBwYVxuICAgICAgICAgIGNvbnNvbGUubG9nKCdhbmRhdG8gdHV0dG8gYmVuZS4gU2V0dG8gYSBzdGF0ZS5lZGl0aW5nLm9uPVRydWUnKTtcbiAgICAgICAgICBzZWxmLl9hZGRUb01hcCgpO1xuICAgICAgICAgIHNlbGYuc3RhdGUuZWRpdGluZy5vbiA9IHRydWU7XG4gICAgICAgICAgc2VsZi5lbWl0KFwiZWRpdGluZ3N0YXJ0ZWRcIik7XG4gICAgICAgICAgaWYgKCFzZWxmLl9sb2FkRGF0YU9uTWFwVmlld0NoYW5nZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAvL3ZpZW5lIHJpdG9ybmF0YSBsYSBsaXN0ZW5lciBrZXlcbiAgICAgICAgICAgIHNlbGYuX2xvYWREYXRhT25NYXBWaWV3Q2hhbmdlTGlzdGVuZXIgPSBzZWxmLl9tYXBTZXJ2aWNlLm9uYWZ0ZXIoJ3NldE1hcFZpZXcnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgaWYgKHNlbGYuc3RhdGUuZWRpdGluZy5vbiAmJiBzZWxmLnN0YXRlLmVkaXRpbmcuZW5hYmxlZCl7XG4gICAgICAgICAgICAgICAgc2VsZi5fbG9hZGVyLmxvYWRBbGxWZWN0b3JzRGF0YSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICB9O1xuXG4gIHRoaXMuX3N0b3BFZGl0aW5nID0gZnVuY3Rpb24ocmVzZXQpe1xuICAgIC8vIHNlIHBvc3NvIHN0b3BwYXJlIHR1dHRpIGdsaSBlZGl0b3IuLi5cbiAgICBpZiAodGhpcy5fc3RvcEVkaXRvcihyZXNldCkpe1xuICAgICAgXy5mb3JFYWNoKHRoaXMuX2xheWVycywgZnVuY3Rpb24obGF5ZXIsIGxheWVyQ29kZSl7XG4gICAgICAgIHZhciB2ZWN0b3IgPSBsYXllci52ZWN0b3I7XG4gICAgICAgIHNlbGYuX21hcFNlcnZpY2Uudmlld2VyLnJlbW92ZUxheWVyQnlOYW1lKHZlY3Rvci5uYW1lKTtcbiAgICAgICAgbGF5ZXIudmVjdG9yPSBudWxsO1xuICAgICAgICBsYXllci5lZGl0b3I9IG51bGw7XG4gICAgICAgIHNlbGYuX3VubG9ja0xheWVyKHNlbGYuX2xheWVyc1tsYXllckNvZGVdKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5fdXBkYXRlRWRpdGluZ1N0YXRlKCk7XG4gICAgICBzZWxmLnN0YXRlLmVkaXRpbmcub24gPSBmYWxzZTtcbiAgICAgIHNlbGYuX2NsZWFuVXAoKTtcbiAgICAgIHNlbGYuZW1pdChcImVkaXRpbmdzdG9wcGVkXCIpO1xuICAgIH1cbiAgfTtcblxuICB0aGlzLl9jbGVhblVwID0gZnVuY3Rpb24oKSB7XG4gICAgLy92YWRvIGFkIGFubnVsYXJlIGwnZXN0ZW56aW9uZSBkZWwgbG9hZGVyIHBlciBwb3RlciByaWNhcmljYXJlIGkgZGF0aSB2ZXR0dG9yaWFsaVxuICAgIC8vZGEgcml2ZWRlcmU7XG4gICAgdGhpcy5fbG9hZGVyLmNsZWFuVXBMYXllcnMoKTtcblxuICB9O1xuICAvL3NlIG5vbiDDqCBhbmNvcmEgcGFydGl0byBmYWNjaW8gcGFydGlyZSBsbyBzdGFydCBlZGl0b3JcbiAgdGhpcy5fc3RhcnRFZGl0b3IgPSBmdW5jdGlvbihsYXllcil7XG4gICAgLy8gYXZ2aW8gbCdlZGl0b3JcbiAgICAvLyBwYXNzYW5kb2xpIGlsIHNlcnZpY2UgY2hlIGxvIGFjY2V0dGFcbiAgICBpZiAobGF5ZXIuZWRpdG9yLnN0YXJ0KHRoaXMpKSB7XG4gICAgICAvLyByZWdpc3RybyBpbCBjdXJyZW50IGxheWVyIGluIGVkaXRpbmdcbiAgICAgIHRoaXMuX3NldEN1cnJlbnRFZGl0aW5nTGF5ZXIobGF5ZXIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgLy9mdW56aW9uZSBjaGUgdmllbmUgY2hpYW1hdGEgYWwgY2xpY2sgc3UgdW4gdG9vbCBkZWxsJ2VkaXRpbmcgZSBzZVxuICAvL25vbiDDqCBzdGF0byBhc3NlZ25hdG8gYW5jb3JhIG5lc3N1biBsYXllciBjb21lIGN1cnJlbnQgbGF5ZXIgZWRpdGluZ1xuICB0aGlzLl9zdGFydEVkaXRpbmdUb29sID0gZnVuY3Rpb24obGF5ZXIsIHRvb2xUeXBlLCBvcHRpb25zKSB7XG4gICAgLy9hc3NlZ25vIHRydWUgYWxsbyBzdGFydEVkaXRpbmdUb29sIGF0dHJpYnV0byBkZWxsbG8gc3RhdGVcbiAgICB0aGlzLnN0YXRlLnN0YXJ0aW5nRWRpdGluZ1Rvb2wgPSB0cnVlO1xuICAgIHZhciBjYW5TdGFydFRvb2wgPSB0cnVlO1xuICAgIC8vdmVyaWZpY28gc2UgbCdlZGl0b3Igw6ggcGFydGl0byBvIG1lbm9cbiAgICBpZiAoIWxheWVyLmVkaXRvci5pc1N0YXJ0ZWQoKSkge1xuICAgICAgLy9zZSBub24gw6ggYW5jb3JhIHBhcnRpdG8gbG8gZmFjY2lvIHBhcnRpcmUgZSBuZSBwcmVuZG8gaWwgcmlzdWx0YXRvXG4gICAgICAvLyB0cnVlIG8gZmFsc2VcbiAgICAgIGNhblN0YXJ0VG9vbCA9IHRoaXMuX3N0YXJ0RWRpdG9yKGxheWVyKTtcbiAgICB9XG4gICAgLy8gdmVyaWZpY2Egc2UgaWwgdG9vbCBwdcOyIGVzc2VyZSBhdHRpdmF0b1xuICAgIC8vIGwnZWRpdG9yIHZlcmlmaWNhIHNlIGlsIHRvb2wgcmljaGllc3RvIMOoIGNvbXBhdGliaWxlXG4gICAgLy8gY29uIGkgdG9vbHMgcHJldmlzdGkgZGFsbCdlZGl0b3IuIENyZWEgaXN0YW56YSBkaSB0b29sIGUgYXZ2aWEgaWwgdG9vbFxuICAgIC8vIGF0dHJhdmVyc28gaWwgbWV0b2RvIHJ1blxuICAgIGlmIChjYW5TdGFydFRvb2wgJiYgbGF5ZXIuZWRpdG9yLnNldFRvb2wodG9vbFR5cGUsIG9wdGlvbnMpKSB7XG4gICAgICB0aGlzLl91cGRhdGVFZGl0aW5nU3RhdGUoKTtcbiAgICAgIHRoaXMuc3RhdGUuc3RhcnRpbmdFZGl0aW5nVG9vbCA9IGZhbHNlO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHRoaXMuc3RhdGUuc3RhcnRpbmdFZGl0aW5nVG9vbCA9IGZhbHNlO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB0aGlzLl9zdG9wRWRpdG9yID0gZnVuY3Rpb24ocmVzZXQpe1xuICAgIHZhciByZXQgPSB0cnVlO1xuICAgIHZhciBsYXllciA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIHJldCA9IGxheWVyLmVkaXRvci5zdG9wKHJlc2V0KTtcbiAgICAgIGlmIChyZXQpe1xuICAgICAgICB0aGlzLl9zZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBzaSBvY2N1cGEgZGkgaW50ZXJyb21lcGVyZSBsJ2VkdGluZyB0b29sXG4gIHRoaXMuX3N0b3BFZGl0aW5nVG9vbCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXQgPSB0cnVlO1xuICAgIC8vIHJlY3VwZXJlIGlsIGxheWVyIGluIGN1cnJlbnQgZWRpdGluZ1xuICAgIHZhciBsYXllciA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKTtcbiAgICAvLyBzZSBlc2lzdGUgZWQgZXJhIHN0YXRvIHNldHRhdG9cbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIC8vIHNlIGFuZGF0byBiZW5lIHJpdG9ybmEgdHJ1ZVxuICAgICAgcmV0ID0gbGF5ZXIuZWRpdG9yLnN0b3BUb29sKCk7XG4gICAgICBpZiAocmV0KSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUVkaXRpbmdTdGF0ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9O1xuICAvLyBmdW56aW9uZSBjaGUgYWNjZXR0YSBjb21lIHBhcmFtZXRybyBpbCB0aXBvIGRpXG4gIC8vIG9wZXJhemlvbmUgZGEgZmFyZSBhIHNlY29uZGEgZGljb3NhIMOoIGF2dmVudXRvXG4gIHRoaXMuX2NhbmNlbE9yU2F2ZSA9IGZ1bmN0aW9uKHR5cGUpe1xuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICAvLyBwZXIgc2ljdXJlenphIHRlbmdvIHR1dHRvIGRlbnRybyB1biBncm9zc28gdHJ5L2NhdGNoLFxuICAgIC8vIHBlciBub24gcmlzY2hpYXJlIGRpIHByb3ZvY2FyZSBpbmNvbnNpc3RlbnplIG5laSBkYXRpIGR1cmFudGUgaWwgc2FsdmF0YWdnaW9cbiAgICB0cnkge1xuICAgICAgdmFyIF9hc2tUeXBlID0gMTtcbiAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgIF9hc2tUeXBlID0gdHlwZVxuICAgICAgfVxuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdmFyIGNob2ljZSA9IFwiY2FuY2VsXCI7XG4gICAgICB2YXIgZGlydHlFZGl0b3JzID0ge307XG4gICAgICAvLyB2ZXJpZmljbyBwZXIgb2duaSBsYXllciBzZSBsJ2VkaXRvIGFzc29jaWF0byDDqCBEaXJ0eVxuICAgICAgXy5mb3JFYWNoKHRoaXMuX2xheWVycywgZnVuY3Rpb24obGF5ZXIsIGxheWVyQ29kZSkge1xuICAgICAgICBpZiAobGF5ZXIuZWRpdG9yLmlzRGlydHkoKSkge1xuICAgICAgICAgIGRpcnR5RWRpdG9yc1tsYXllckNvZGVdID0gbGF5ZXIuZWRpdG9yO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIC8vIHZlcmlmaWNvIHNlIGNpIHNvbm8gbyBtZW5vIGVkaXRvciBzcG9yY2hpXG4gICAgICBpZihfLmtleXMoZGlydHlFZGl0b3JzKS5sZW5ndGgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2Fza1R5cGU6ICcsX2Fza1R5cGUpO1xuICAgICAgICB0aGlzLl9hc2tDYW5jZWxPclNhdmUoX2Fza1R5cGUpLlxuICAgICAgICB0aGVuKGZ1bmN0aW9uKGFjdGlvbikge1xuICAgICAgICAgIC8vIHJpdG9ybmEgaWwgdGlwbyBkaSBhemlvbmUgZGEgZmFyZVxuICAgICAgICAgIC8vIHNhdmUsIGNhbmNlbCwgbm9zYXZlXG4gICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3NhdmUnKSB7XG4gICAgICAgICAgICAvLyBwYXNzbyBnbGkgZWRpdG9yIHNwb2NoaSBhbGxhIGZ1bnppb25lIF9zYXZlRWRpdHNcbiAgICAgICAgICAgIHNlbGYuX3NhdmVFZGl0cyhkaXJ0eUVkaXRvcnMpLlxuICAgICAgICAgICAgdGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09ICdub3NhdmUnKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT0gJ2NhbmNlbCcpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcbiAgLy8gZnVuemlvbmUgY2hlIGluIGJhc2UgYWwgdGlwbyBkaSBhc2tUeXBlXG4gIC8vIHZpc3VhbGl6emEgaWwgbW9kYWxlIGEgY3VpIHJpc3BvbmRlcmUsIHNhbHZhIGV0YyAuLlxuICB0aGlzLl9hc2tDYW5jZWxPclNhdmUgPSBmdW5jdGlvbih0eXBlKXtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgdmFyIGJ1dHRvblR5cGVzID0ge1xuICAgICAgU0FWRToge1xuICAgICAgICBsYWJlbDogXCJTYWx2YVwiLFxuICAgICAgICBjbGFzc05hbWU6IFwiYnRuLXN1Y2Nlc3NcIixcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnc2F2ZScpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgTk9TQVZFOiB7XG4gICAgICAgIGxhYmVsOiBcIlRlcm1pbmEgc2VuemEgc2FsdmFyZVwiLFxuICAgICAgICBjbGFzc05hbWU6IFwiYnRuLWRhbmdlclwiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdub3NhdmUnKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIENBTkNFTDoge1xuICAgICAgICBsYWJlbDogXCJBbm51bGxhXCIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJidG4tcHJpbWFyeVwiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdjYW5jZWwnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgc3dpdGNoICh0eXBlKXtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgYnV0dG9ucyA9IHtcbiAgICAgICAgICBzYXZlOiBidXR0b25UeXBlcy5TQVZFLFxuICAgICAgICAgIG5vc2F2ZTogYnV0dG9uVHlwZXMuTk9TQVZFLFxuICAgICAgICAgIGNhbmNlbDogYnV0dG9uVHlwZXMuQ0FOQ0VMXG4gICAgICAgIH07XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBidXR0b25zID0ge1xuICAgICAgICAgIHNhdmU6IGJ1dHRvblR5cGVzLlNBVkUsXG4gICAgICAgICAgY2FuY2VsOiBidXR0b25UeXBlcy5DQU5DRUxcbiAgICAgICAgfTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIEdVSS5kaWFsb2cuZGlhbG9nKHtcbiAgICAgIG1lc3NhZ2U6IFwiVnVvaSBzYWx2YXJlIGRlZmluaXRpdmFtZW50ZSBsZSBtb2RpZmljaGU/XCIsXG4gICAgICB0aXRsZTogXCJTYWx2YXRhZ2dpbyBtb2RpZmljYVwiLFxuICAgICAgYnV0dG9uczogYnV0dG9uc1xuICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBzYWx2YSBpIGRhdGkgcmVsYXRpdmkgYWwgbGF5ZXIgdmV0dG9yaWFsZVxuICAvLyBkZWwgZGlydHlFZGl0b3JcbiAgdGhpcy5fc2F2ZUVkaXRzID0gZnVuY3Rpb24oZGlydHlFZGl0b3JzKXtcbiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG4gICAgdGhpcy5fc2VuZEVkaXRzKGRpcnR5RWRpdG9ycylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgIEdVSS5ub3RpZnkuc3VjY2VzcyhcIkkgZGF0aSBzb25vIHN0YXRpIHNhbHZhdGkgY29ycmV0dGFtZW50ZVwiKTtcbiAgICAgICAgICBzZWxmLl9jb21taXRFZGl0cyhkaXJ0eUVkaXRvcnMsIHJlc3BvbnNlKTtcbiAgICAgICAgICBzZWxmLl9tYXBTZXJ2aWNlLnJlZnJlc2hNYXAoKTtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9ycyl7XG4gICAgICAgICAgR1VJLm5vdGlmeS5lcnJvcihcIkVycm9yZSBuZWwgc2FsdmF0YWdnaW8gc3VsIHNlcnZlclwiKTtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gIH07XG4gIC8vIGZ1bnppb25lIGNoZSBwcmVuZGUgY29tZSBpbmdyZXNzbyBnbGkgZWRpdG9yIHNwb3JjaGlcbiAgdGhpcy5fc2VuZEVkaXRzID0gZnVuY3Rpb24oZGlydHlFZGl0b3JzKSB7XG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIHZhciBlZGl0c1RvUHVzaCA9IF8ubWFwKGRpcnR5RWRpdG9ycywgZnVuY3Rpb24oZWRpdG9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBsYXllcm5hbWU6IGVkaXRvci5nZXRWZWN0b3JMYXllcigpLm5hbWUsXG4gICAgICAgIGVkaXRzOiBlZGl0b3IuZ2V0RWRpdGVkRmVhdHVyZXMoKVxuICAgICAgfVxuICAgIH0pO1xuICAgIC8vIGVzZWd1ZSBpbCBwb3N0IGRlaSBkYXRpXG4gICAgdGhpcy5fcG9zdERhdGEoZWRpdHNUb1B1c2gpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJldHVybmVkKXtcbiAgICAgICAgICBpZiAocmV0dXJuZWQucmVzdWx0KXtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmV0dXJuZWQucmVzcG9uc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXR1cm5lZC5yZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihyZXR1cm5lZCl7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJldHVybmVkLnJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgfTtcblxuICB0aGlzLl9jb21taXRFZGl0cyA9IGZ1bmN0aW9uKGVkaXRvcnMscmVzcG9uc2Upe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBfLmZvckVhY2goZWRpdG9ycyxmdW5jdGlvbihlZGl0b3Ipe1xuICAgICAgdmFyIG5ld0F0dHJpYnV0ZXNGcm9tU2VydmVyID0gbnVsbDtcbiAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5uZXcpe1xuICAgICAgICBfLmZvckVhY2gocmVzcG9uc2UubmV3LGZ1bmN0aW9uKHVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcyl7XG4gICAgICAgICAgdmFyIG9sZGZpZCA9IHVwZGF0ZWRGZWF0dXJlQXR0cmlidXRlcy5jbGllbnRpZDtcbiAgICAgICAgICB2YXIgZmlkID0gdXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzLmlkO1xuICAgICAgICAgIGVkaXRvci5nZXRFZGl0VmVjdG9yTGF5ZXIoKS5zZXRGZWF0dXJlRGF0YShvbGRmaWQsZmlkLG51bGwsdXBkYXRlZEZlYXR1cmVBdHRyaWJ1dGVzKTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIGVkaXRvci5jb21taXQoKTtcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLl91bmRvRWRpdHMgPSBmdW5jdGlvbihkaXJ0eUVkaXRvcnMpe1xuICAgIHZhciBjdXJyZW50RWRpdGluZ0xheWVyQ29kZSA9IHRoaXMuX2dldEN1cnJlbnRFZGl0aW5nTGF5ZXIoKS5sYXllckNvZGU7XG4gICAgdmFyIGVkaXRvciA9IGRpcnR5RWRpdG9yc1tjdXJyZW50RWRpdGluZ0xheWVyQ29kZV07XG4gICAgdGhpcy5fc3RvcEVkaXRpbmcodHJ1ZSk7XG4gIH07XG4gIC8vIGVzZWd1ZSBsJ3VwZGF0ZSBkZWxsbyBzdGF0ZSBuZWwgY2FzbyBhZCBlc2VtcGlvIGRpIHVuIHRvZ2dsZSBkZWwgYm90dG9uZSB0b29sXG4gIHRoaXMuX3VwZGF0ZUVkaXRpbmdTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIHByZW5kZSBpbCBsYXllciBpbiBFZGl0aW5nXG4gICAgdmFyIGxheWVyID0gdGhpcy5fZ2V0Q3VycmVudEVkaXRpbmdMYXllcigpO1xuICAgIGlmIChsYXllcikge1xuICAgICAgdGhpcy5zdGF0ZS5lZGl0aW5nLmxheWVyQ29kZSA9IGxheWVyLmxheWVyQ29kZTtcbiAgICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sVHlwZSA9IGxheWVyLmVkaXRvci5nZXRBY3RpdmVUb29sKCkuZ2V0VHlwZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdGUuZWRpdGluZy5sYXllckNvZGUgPSBudWxsO1xuICAgICAgdGhpcy5zdGF0ZS5lZGl0aW5nLnRvb2xUeXBlID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5fdXBkYXRlVG9vbFN0ZXBzU3RhdGUoKTtcbiAgfTtcblxuICB0aGlzLl91cGRhdGVUb29sU3RlcHNTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyKCk7XG4gICAgdmFyIGFjdGl2ZVRvb2w7XG4gICAgaWYgKGxheWVyKSB7XG4gICAgICBhY3RpdmVUb29sID0gbGF5ZXIuZWRpdG9yLmdldEFjdGl2ZVRvb2woKTtcbiAgICB9XG4gICAgaWYgKGFjdGl2ZVRvb2wgJiYgYWN0aXZlVG9vbC5nZXRUb29sKCkpIHtcbiAgICAgIHZhciB0b29sSW5zdGFuY2UgPSBhY3RpdmVUb29sLmdldFRvb2woKTtcbiAgICAgIGlmICh0b29sSW5zdGFuY2Uuc3RlcHMpe1xuICAgICAgICB0aGlzLl9zZXRUb29sU3RlcFN0YXRlKGFjdGl2ZVRvb2wpO1xuICAgICAgICB0b29sSW5zdGFuY2Uuc3RlcHMub24oJ3N0ZXAnLCBmdW5jdGlvbihpbmRleCxzdGVwKSB7XG4gICAgICAgICAgc2VsZi5fc2V0VG9vbFN0ZXBTdGF0ZShhY3RpdmVUb29sKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRvb2xJbnN0YW5jZS5zdGVwcy5vbignY29tcGxldGUnLCBmdW5jdGlvbigpe1xuICAgICAgICAgIHNlbGYuX3NldFRvb2xTdGVwU3RhdGUoKTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBzZWxmLl9zZXRUb29sU3RlcFN0YXRlKCk7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuX3NldFRvb2xTdGVwU3RhdGUgPSBmdW5jdGlvbihhY3RpdmVUb29sKXtcbiAgICB2YXIgaW5kZXgsIHRvdGFsLCBtZXNzYWdlO1xuICAgIGlmIChfLmlzVW5kZWZpbmVkKGFjdGl2ZVRvb2wpKXtcbiAgICAgIGluZGV4ID0gbnVsbDtcbiAgICAgIHRvdGFsID0gbnVsbDtcbiAgICAgIG1lc3NhZ2UgPSBudWxsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHZhciB0b29sID0gYWN0aXZlVG9vbC5nZXRUb29sKCk7XG4gICAgICB2YXIgbWVzc2FnZXMgPSB0b29sU3RlcHNNZXNzYWdlc1thY3RpdmVUb29sLmdldFR5cGUoKV07XG4gICAgICBpbmRleCA9IHRvb2wuc3RlcHMuY3VycmVudFN0ZXBJbmRleCgpO1xuICAgICAgdG90YWwgPSB0b29sLnN0ZXBzLnRvdGFsU3RlcHMoKTtcbiAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlc1tpbmRleF07XG4gICAgICBpZiAoXy5pc1VuZGVmaW5lZChtZXNzYWdlKSkge1xuICAgICAgICBpbmRleCA9IG51bGw7XG4gICAgICAgIHRvdGFsID0gbnVsbDtcbiAgICAgICAgbWVzc2FnZSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5uID0gaW5kZXggKyAxO1xuICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC50b3RhbCA9IHRvdGFsO1xuICAgIHRoaXMuc3RhdGUuZWRpdGluZy50b29sc3RlcC5tZXNzYWdlID0gbWVzc2FnZTtcbiAgfTtcblxuICB0aGlzLl9nZXRDdXJyZW50RWRpdGluZ0xheWVyID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5fY3VycmVudEVkaXRpbmdMYXllcjtcbiAgfTtcblxuICB0aGlzLl9zZXRDdXJyZW50RWRpdGluZ0xheWVyID0gZnVuY3Rpb24obGF5ZXIpe1xuICAgIGlmICghbGF5ZXIpe1xuICAgICAgdGhpcy5fY3VycmVudEVkaXRpbmdMYXllciA9IG51bGw7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5fY3VycmVudEVkaXRpbmdMYXllciA9IGxheWVyO1xuICAgIH1cbiAgfTtcblxuICB0aGlzLl9hZGRUb01hcCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vcmVjdXBlcm8gbCdlbGVtZW50byBtYXAgb2wzXG4gICAgdmFyIG1hcCA9IHRoaXMuX21hcFNlcnZpY2Uudmlld2VyLm1hcDtcbiAgICB2YXIgbGF5ZXJDb2RlcyA9IHRoaXMuZ2V0TGF5ZXJDb2RlcygpO1xuICAgIC8vb2duaSBsYXllciBsbyBhZ2dpdW5nbyBhbGxhIG1hcHBhXG4gICAgLy9jb24gaWwgbWV0b2RvIGFkZFRvTWFwIGRpIHZlY3RvckxheWVyXG4gICAgXy5mb3JFYWNoKGxheWVyQ29kZXMsIGZ1bmN0aW9uKGxheWVyQ29kZSkge1xuICAgICAgc2VsZi5fbGF5ZXJzW2xheWVyQ29kZV0udmVjdG9yLmFkZFRvTWFwKG1hcCk7XG4gICAgfSlcbiAgfTtcblxuICB0aGlzLl9wb3N0RGF0YSA9IGZ1bmN0aW9uKGVkaXRzVG9QdXNoKXtcbiAgICAvLyBtYW5kbyB1biBvZ2dldHRvIGNvbWUgbmVsIGNhc28gZGVsIGJhdGNoLCBtYSBpbiBxdWVzdG8gY2FzbyBkZXZvIHByZW5kZXJlIHNvbG8gaWwgcHJpbW8sIGUgdW5pY28sIGVsZW1lbnRvXG4gICAgaWYgKGVkaXRzVG9QdXNoLmxlbmd0aD4xKXtcbiAgICAgIHJldHVybiB0aGlzLl9wb3N0QmF0Y2hEYXRhKGVkaXRzVG9QdXNoKTtcbiAgICB9XG4gICAgdmFyIGxheWVyTmFtZSA9IGVkaXRzVG9QdXNoWzBdLmxheWVybmFtZTtcbiAgICB2YXIgZWRpdHMgPSBlZGl0c1RvUHVzaFswXS5lZGl0cztcbiAgICB2YXIganNvbkRhdGEgPSBKU09OLnN0cmluZ2lmeShlZGl0cyk7XG4gICAgcmV0dXJuICQucG9zdCh7XG4gICAgICB1cmw6IHRoaXMuY29uZmlnLmJhc2V1cmwrbGF5ZXJOYW1lK1wiL1wiLFxuICAgICAgZGF0YToganNvbkRhdGEsXG4gICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLl9wb3N0QmF0Y2hEYXRhID0gZnVuY3Rpb24obXVsdGlFZGl0c1RvUHVzaCl7XG4gICAgdmFyIGVkaXRzID0ge307XG4gICAgXy5mb3JFYWNoKG11bHRpRWRpdHNUb1B1c2gsZnVuY3Rpb24oZWRpdHNUb1B1c2gpe1xuICAgICAgZWRpdHNbZWRpdHNUb1B1c2gubGF5ZXJuYW1lXSA9IGVkaXRzVG9QdXNoLmVkaXRzO1xuICAgIH0pO1xuICAgIHZhciBqc29uRGF0YSA9IEpTT04uc3RyaW5naWZ5KGVkaXRzKTtcbiAgICByZXR1cm4gJC5wb3N0KHtcbiAgICAgIHVybDogdGhpcy5jb25maWcuYmFzZXVybCxcbiAgICAgIGRhdGE6IGpzb25EYXRhLFxuICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fdW5sb2NrID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgbGF5ZXJDb2RlcyA9IHRoaXMuZ2V0TGF5ZXJDb2RlcygpO1xuICAgIC8vIGVzZWd1byBsZSByaWNoaWVzdGUgZGVsbGUgY29uZmlndXJhemlvbmkgZSBtaSB0ZW5nbyBsZSBwcm9tZXNzZVxuICAgIHZhciB1bmxvY2tSZXF1ZXN0cyA9IF8ubWFwKGxheWVyQ29kZXMsZnVuY3Rpb24obGF5ZXJDb2RlKXtcbiAgICAgIHJldHVybiBzZWxmLl91bmxvY2tMYXllcihzZWxmLl9sYXllcnNbbGF5ZXJDb2RlXSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5fdW5sb2NrTGF5ZXIgPSBmdW5jdGlvbihsYXllckNvbmZpZyl7XG4gICAgJC5nZXQodGhpcy5jb25maWcuYmFzZXVybCtsYXllckNvbmZpZy5uYW1lK1wiLz91bmxvY2tcIik7XG4gIH07XG59XG5pbmhlcml0KEl0ZXJuZXRTZXJ2aWNlLEczV09iamVjdCk7XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEl0ZXJuZXRTZXJ2aWNlO1xufSx7XCIuL2VkaXRvcnMvYWNjZXNzaWVkaXRvclwiOjEsXCIuL2VkaXRvcnMvYXR0cmlidXRlc2Zvcm1cIjoyLFwiLi9lZGl0b3JzL2dpdW56aW9uaWVkaXRvclwiOjMsXCIuL2VkaXRvcnMvc3RyYWRlZWRpdG9yXCI6NX1dfSx7fSxbNl0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
