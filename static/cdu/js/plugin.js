!function t(e,i,n){function r(a,c){if(!i[a]){if(!e[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[a]={exports:{}};e[a][0].call(u.exports,function(t){var i=e[a][1][t];return r(i?i:t)},u,u.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e,i){function n(){this.cleanAll=function(){r.cleanAll()},this.calcola=function(t){r.calcola(t).then(function(){a.pushContent({content:new o({}),backonclose:!0,closable:!1})})}}var r=t("../pluginservice"),o=t("./vue/calcolo"),a=g3wsdk.gui.GUI;e.exports=n},{"../pluginservice":7,"./vue/calcolo":3}],2:[function(t,e,i){e.exports="<div>\n  Calcola\n</div>"},{}],3:[function(t,e,i){function n(t){t=t||{},o(this,t),this.setInternalComponent(new c)}var r=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,a=g3wsdk.gui.vue.Component,c=Vue.extend({template:t("./calcolo.html"),data:function(){return{state:null}},methods:{}});r(n,a),e.exports=n},{"./calcolo.html":2}],4:[function(t,e,i){e.exports='<div id="cdu">\n  <div id="cdu-tools" style="background:#ffffff; padding: 10px;">\n    <button @click="calcola()" type="button" class="btn btn-default btn-lg ">\n      <i class="fa fa-calculator" aria-hidden="true"></i> Calcola\n    </button>\n    <button type="button" class="btn btn-default btn-lg pull-right">\n      <span @click="activeInteraction(\'rotate\')" class="glyphicon glyphicon-repeat" aria-hidden="true"></span>\n    </button>\n    <button type="button" class="btn btn-default btn-lg pull-right">\n      <span @click="activeInteraction(\'move\')" class="glyphicon glyphicon-move" aria-hidden="true"></span>\n    </button>\n  </div>\n  <div v-for="particella in particelle">\n    <div>particella</div>\n  </div>\n</div>'},{}],5:[function(t,e,i){function n(t){t=t||{},o(this,t);var e=t.particelle||[],i=t.api_url;console.log(i);var n=new c;this.setService(n),o(this,t),this.setInternalComponent(new l({particelle:e,api_url:i,service:n})),this.setService(new c),this.unmount=function(){var t=o(this,"unmount");return n.cleanAll(),t}}var r=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,a=g3wsdk.gui.vue.Component,c=t("../cduservice"),s=t("../../pluginservice"),l=Vue.extend({template:t("./cdu.html"),data:function(){return{particelle:this.$options.particelle}},methods:{calcola:function(){this.$options.service.calcola(this.$options.api_url)},deleteParticella:function(){console.log("cancella particella")},muoviParticelle:function(){console.log("muovi particelle")},ruotaParticella:function(){console.log("ruota particella")},activeInteraction:function(t){s.activeInteraction(t)}}});r(n,a),e.exports=n},{"../../pluginservice":7,"../cduservice":1,"./cdu.html":4}],6:[function(t,e,i){var n=g3wsdk.core.utils.inherit,r=g3wsdk.core.utils.base,o=g3wsdk.core.Plugin,a=g3wsdk.gui.GUI,c=t("./pluginservice"),s=t("./search/vue/panel"),l=function(){r(this),this.name="cdu",this.config=null,this.init=function(){this.setPluginService(c),this.config=this.getPluginConfig(),console.log(this.config),this.registerPlugin(this.config.gid)&&(a.ready?this.setupGui():a.on("ready",_.bind(this.setupGui,this)),this.service.init(this.config))},this.setupGui=function(){var t=this,e=a.getComponent("tools"),i=e.getService();_.forEach(this.config.configs,function(e){i.addTools(1,"CDU",[{name:e.name,action:_.bind(t.showSearchPanel,this,e)}])})},this.showSearchPanel=function(t){var e=new s(t);a.showPanel(e)}};n(l,o),function(t){t.init()}(new l)},{"./pluginservice":7,"./search/vue/panel":10}],7:[function(t,e,i){function n(){this._mapService=null,this._interactions={},this._layer={},this._map=null,this.init=function(t){var e=this;this.config=t,this._mapService=a.getComponent("map").getService();var i=this._mapService.getProjectLayer(t.configs[0].layerCatasto).state.crs;this._map=this._mapService.getMap(),this._layer=new ol.layer.Vector({title:"CDUCatasto",source:new ol.source.Vector({projection:"EPSG:"+i,format:new ol.format.GeoJSON})}),this._map.addLayer(this._layer),this._selectInteraction=new ol.interaction.Select({layers:[this._layer]}),this._interactions={rotate:new ol.interaction.RotateFeature({features:e._selectInteraction.getFeatures(),angle:0}),move:new ol.interaction.Translate({layers:[this._layer]})},this._map.addInteraction(this._selectInteraction),this._selectInteraction.setActive(!1),_.forEach(this._interactions,function(t){e._map.addInteraction(t),t.setActive(!1)})},this.addParticella=function(t){this._layer.getSource().addFeature(t)},this.addParticelle=function(t){var e=[];_.forEach(t,function(t){if(t.attributes.tipo="T"){var i=new ol.Feature({geometry:t.geometry});_.forEach(t.attributes,function(t,e){i.set(e,t)}),e.push(i)}}),this._layer.getSource().addFeatures(e)},this.cleanAll=function(){this._layer.getSource().getFeatures().clear(),_.forEach(this._interactions,function(t){t.setActive(!1)}),this._selectInteraction.setActive(!1)},this._getInteraction=function(t){return this._interactions[t]},this.activeInteraction=function(t){this._selectInteraction.getFeatures().clear(),_.forEach(this._interactions,function(t){t.setActive(!1)});var e=this._getInteraction(t);this._selectInteraction.setActive(!0),e.setActive(!0)},this.disableInteractions=function(){_.forEach(this._interactions,function(t){t.setActive(!1)})},this.calcola=function(t){var e=new ol.format.GeoJSON({geometryName:"geometry"}),i=e.writeFeatures(this._layer.getSource().getFeatures());return $.post(t,i)}}var r=g3wsdk.core.utils.inherit,o=g3wsdk.core.G3WObject,a=g3wsdk.gui.GUI;r(n,o),e.exports=new n},{}],8:[function(t,e,i){function n(t){t=t||{};var e=t.api_url;this.addParticelle=function(t){c.addParticelle(t)},this.parseQueryResults=function(t){if(t){var i=a.getComponent("queryresults").getService(),n=i._digestFeaturesForLayers(t.data),r=n.length?n[0].features:n;this.addParticelle(r),a.setContent({content:new s({particelle:r,api_url:e}),title:"CDU"})}}}var r=g3wsdk.core.utils.inherit,o=g3wsdk.core.G3WObject,a=g3wsdk.gui.GUI,c=t("../pluginservice"),s=t("../cdu/vue/cdu");r(n,o),e.exports=n},{"../cdu/vue/cdu":5,"../pluginservice":7}],9:[function(t,e,i){e.exports='<div class="cdu-search-panel form-group">\n  <h4>{{title}}</h4>\n  <form id="cdu-search-form">\n    <template v-for="(forminput, index) in forminputs">\n      <div v-if="forminput.input.type == \'numberfield\'" class="form-group numeric">\n        <label :for="forminput.id + \' \'">{{ forminput.label }}</label>\n        <input type="number" v-model="formInputValues[index].value" class="form-control" :id="forminput.id">\n      </div>\n      <div v-if="forminput.input.type == \'textfield\' || forminput.input.type == \'textField\'" class="form-group text">\n        <label :for="forminput.id">{{ forminput.label }}</label>\n        <input type="text" v-model="formInputValues[index].value" class="form-control" :id="forminput.id">\n      </div>\n    </template>\n    <div class="form-group">\n      <button style="width:100%" class="btn btn-primary pull-right" @click="add($event)">Aggiungi</button>\n    </div>\n  </form>\n</div>\n\n'},{}],10:[function(t,e,i){function n(t){var e={};e.id="cdu-search-panel",e.name=t.name;var i=t.api,n=e.service||new s({api_url:i});e.internalPanel=new l({service:n}),o(this,e),this.init(t.search)}var r=g3wsdk.core.utils.inherit,o=g3wsdk.core.utils.base,a=g3wsdk.gui.vue.SearchPanel,c=g3wsdk.core.QueryService,s=t("../panelservice"),l=Vue.extend({template:t("./panel.html"),data:function(){return{title:"",forminputs:[],filterObject:{},formInputValues:[]}},methods:{add:function(t){var e=this;t.preventDefault(),this.filterObject=this.fillFilterInputsWithValues(this.filterObject,this.formInputValues),c.queryByFilter([this.filterObject]).then(function(t){e.$options.service.parseQueryResults(t)}).fail(function(){queryResultsPanel.setQueryResponse({})})}}});r(n,a),e.exports=n},{"../panelservice":8,"./panel.html":9}]},{},[6]);